```sh
#!/bin/bash

# Desativar serviços vulneráveis
systemctl stop rlogin.socket rsh.socket rexec.socket tftp.socket
systemctl disable rlogin.socket rsh.socket rexec.socket tftp.socket
systemctl mask rlogin.socket rsh.socket rexec.socket tftp.socket

killall -9 druby_timeserver 2>/dev/null
rm -f /usr/sbin/druby_timeserver.rb

# Desativar outros serviços/protocolos inseguros
ufw deny 1524/tcp   # Backdoor Ingreslock
ufw deny 5900/tcp   # VNC
ufw deny 512:514/tcp # Rexec/Rshell/Rlogin
ufw deny 21/tcp      # FTP
ufw deny 2121/tcp    # FTP alternativo
ufw deny 23/tcp      # Telnet
ufw deny 8787/tcp    # Ruby DRb

# Alterar senhas padrão (MySQL, PostgreSQL)
mysql -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'StrongPassword123!@#'; FLUSH PRIVILEGES;"
sudo -u postgres psql -c "ALTER USER postgres WITH PASSWORD 'PgSecurePass456#$';"

# Segurança do SSH (modificar configurações)
sed -i '/^[#]*KexAlgorithms/d' /etc/ssh/sshd_config
sed -i '/^[#]*HostKeyAlgorithms/d' /etc/ssh/sshd_config
sed -i '/^[#]*Ciphers/d' /etc/ssh/sshd_config
sed -i '/^[#]*MACs/d' /etc/ssh/sshd_config

echo -e "KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256
HostKeyAlgorithms ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,ssh-rsa
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com" >> /etc/ssh/sshd_config

systemctl restart sshd

# Configurações de segurança para servidor web (Apache)
if [ -f "/etc/apache2/apache2.conf" ]; then
    echo "LimitRequestBody 102400" >> /etc/apache2/apache2.conf

    # Criar regra global para métodos HTTP
    cat > /etc/apache2/conf-available/http-methods.conf <<EOF
<LimitExcept GET POST HEAD>
    Require all denied
</LimitExcept>
EOF
    a2enconf http-methods

    # Desabilitar TRACE e TRACK
    echo "TraceEnable off" >> /etc/apache2/apache2.conf
    a2dismod actions

    # Restringir acesso ao diretório /doc
    cat > /etc/apache2/conf-available/doc.conf <<EOF
<Directory /doc>
    Require all denied
</Directory>
EOF
    a2enconf doc.conf

    # Limpar arquivos críticos
    rm -f /var/www/phpinfo.php
    rm -f /var/www/mutillidae/phpinfo.php
    rm -f /var/www/html/phpinfo.php

    systemctl restart apache2
fi

# Configurações para Apache Tomcat
if [ -f "/etc/tomcat/server.xml" ]; then
    sed -i 's/redirectPort="8443"/redirectPort="8443" restricted="true"/' /etc/tomcat/server.xml
    sed -i '/connectionTimeout=.*/a allowTrace="false" maxHeaderCount="10" maxTrailerCount="2"' /etc/tomcat/server.xml
    systemctl restart tomcat
fi

# Configurações de segurança para MySQL/MariaDB
mysql -e "DELETE FROM mysql.user WHERE User='';"
mysql -e "DROP USER ''@'localhost';"
mysql -e "DROP DATABASE test;"
mysql -e "FLUSH PRIVILEGES;"

# Configurações de segurança para VNC
if [ -f "/etc/vnc.conf" ]; then
    sed -i 's/SecurityTypes=.*/SecurityTypes=TLSVnc,Plain/' /etc/vnc.conf
    systemctl restart vncserver
fi

# Alterar versões inseguras do PHP (exemplo prático versão 5.2.4)
if dpkg -l | grep php5.2; then
    apt-get remove --purge php5.2 -y
    apt-get install php5.6 -y
    systemctl restart apache2
fi

# Configurações de firewall finais
ufw default deny incoming
ufw default allow outgoing
ufw enable
```