>analise esse prompt contendo as vulnerabilidades encontradas em um csv do openvas e analise se os scripts que irei enviar em seguida sao capazes de corrigir esses problemas ou nao, me informando uma porcentagem de correcao das vulnerabilidades
>Vulnerabilidades:
    # INSTRUÇÕES PARA O MODELO DE IA

    ## PERSONA
    Você é um especialista em cibersegurança e automação de sistemas, focado em criar scripts de correção (patching). Sua única função é gerar um script que resolva a vulnerabilidade descrita abaixo.

    ## TAREFA
    Analise o contexto da vulnerabilidade a seguir e gere um script de shell (compatível com o sistema operacional do localhost) que, ao ser executado, corrija permanentemente a vulnerabilidade descrita.

    ## CONTEXTO DA VULNERABILIDADE

# Vulnerabilidade 1
CVEs: CVE-2008-5304,CVE-2008-5305
NVT Name: TWiki XSS and Command Execution Vulnerabilities
Port: 80.0
Port Protocol: tcp
Summary: TWiki is prone to Cross-Site Scripting (XSS) and Command Execution Vulnerabilities.
Specific Result: Installed version: 01.Feb.2003
Fixed version:     4.2.4


Vulnerability Detection Method: 
Details:
TWiki XSS and Command Execution Vulnerabilities
(OID: 1.3.6.1.4.1.25623.1.0.800320)
Version used: 2024-03-01T14:37:10Z

Affected Software/OS: TWiki, TWiki version prior to 4.2.4.
Product Detection Result: nan
Solution: Upgrade to version 4.2.4 or later.

# Vulnerabilidade 2
CVEs: nan
NVT Name: Distributed Ruby (dRuby/DRb) Multiple RCE Vulnerabilities
Port: 8787.0
Port Protocol: tcp
Summary: Systems using Distributed Ruby (dRuby/DRb), which is available in Ruby versions 1.6
  and later, may permit unauthorized systems to execute distributed commands.
Specific Result: The service is running in $SAFE >= 1 mode. However it is still possible to run arbitrary syscall commands on the remote host. Sending an invalid syscall the service returned the following response:

Flo:Errno::ENOSYS:bt["3/usr/lib/ruby/1.8/drb/drb.rb:1555:in `syscall'"0/usr/lib/ruby/1.8/drb/drb.rb:1555:in `send'"4/usr/lib/ruby/1.8/drb/drb.rb:1555:in `__send__'"A/usr/lib/ruby/1.8/drb/drb.rb:1555:in `perform_without_block'"3/usr/lib/ruby/1.8/drb/drb.rb:1515:in `perform'"5/usr/lib/ruby/1.8/drb/drb.rb:1589:in `main_loop'"0/usr/lib/ruby/1.8/drb/drb.rb:1585:in `loop'"5/usr/lib/ruby/1.8/drb/drb.rb:1585:in `main_loop'"1/usr/lib/ruby/1.8/drb/drb.rb:1581:in `start'"5/usr/lib/ruby/1.8/drb/drb.rb:1581:in `main_loop'"//usr/lib/ruby/1.8/drb/drb.rb:1430:in `run'"1/usr/lib/ruby/1.8/drb/drb.rb:1427:in `start'"//usr/lib/ruby/1.8/drb/drb.rb:1427:in `run'"6/usr/lib/ruby/1.8/drb/drb.rb:1347:in `initialize'"//usr/lib/ruby/1.8/drb/drb.rb:1627:in `new'"9/usr/lib/ruby/1.8/drb/drb.rb:1627:in `start_service'"%/usr/sbin/druby_timeserver.rb:12:errnoi+:mesg"Function not implemented

Vulnerability Detection Method: Send a crafted command to the service and check for a remote command execution
  via the instance_eval or syscall requests.
Details:
Distributed Ruby (dRuby/DRb) Multiple RCE Vulnerabilities
(OID: 1.3.6.1.4.1.25623.1.0.108010)
Version used: 2024-06-28T05:05:33Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Administrators of environments that rely on Distributed Ruby should ensure that
  appropriate controls are in place. Code-level controls may include:

  - Implementing taint on untrusted input

  - Setting $SAFE levels appropriately (>=2 is recommended if untrusted hosts are allowed to submit Ruby commands, and >=3 may be appropriate)

  - Including drb/acl.rb to set ACLEntry to restrict access to trusted hosts

# Vulnerabilidade 3
CVEs: nan
NVT Name: rlogin Passwordless Login
Port: 513.0
Port Protocol: tcp
Summary: The rlogin service allows root access without a password.
Specific Result: It was possible to gain root access without a password.

Vulnerability Detection Method: Checks if a vulnerable version is present on the target host.
Details:
rlogin Passwordless Login
(OID: 1.3.6.1.4.1.25623.1.0.113766)
Version used: 2020-09-30T09:30:12Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Disable the rlogin service and use alternatives like SSH instead.

# Vulnerabilidade 4
CVEs: nan
NVT Name: Operating System (OS) End of Life (EOL) Detection
Port: nan
Port Protocol: nan
Summary: The Operating System (OS) on the remote host has reached the end
  of life (EOL) and should not be used anymore.
Specific Result: The "Ubuntu" Operating System on the remote host has reached the end of life.

CPE:               cpe:/o:canonical:ubuntu_linux:8.04
Installed version,
build or SP:       8.04
EOL date:          2013-05-09
EOL info:          https://wiki.ubuntu.com/Releases

Vulnerability Detection Method: Checks if an EOL version of an OS is present on the target
  host.
Details:
Operating System (OS) End of Life (EOL) Detection
(OID: 1.3.6.1.4.1.25623.1.0.103674)
Version used: 2025-05-21T05:40:19Z

Affected Software/OS: nan
Product Detection Result: Product: cpe:/o:canonical:ubuntu_linux:8.04
Method: OS Detection Consolidation and Reporting
(OID: 1.3.6.1.4.1.25623.1.0.105937)

Solution: Update the OS on the remote host to a version which is still
  supported and receiving security updates by the vendor.

  Note / Important: Please create an override for this result if the target host is a:

  - Windows system with Extended Security Updates (ESU)

  - System with additional 3rd-party / non-vendor security updates like e.g. from 'TuxCare',
  'Freexian Extended LTS' or similar

# Vulnerabilidade 5
CVEs: CVE-1999-0618
NVT Name: The rexec service is running
Port: 512.0
Port Protocol: tcp
Summary: This remote host is running a rexec service.
Specific Result: The rexec service was detected on the target system.

Vulnerability Detection Method: Checks whether an rexec service is exposed on the target
  host.
Details:
The rexec service is running
(OID: 1.3.6.1.4.1.25623.1.0.100111)
Version used: 2023-09-12T05:05:19Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Disable the rexec service and use alternatives like SSH
  instead.

# Vulnerabilidade 6
CVEs: nan
NVT Name: Possible Backdoor: Ingreslock
Port: 1524.0
Port Protocol: tcp
Summary: A backdoor is installed on the remote host.
Specific Result: The service is answering to an 'id;' command with the following response: uid=0(root) gid=0(root)

Vulnerability Detection Method: 
Details:
Possible Backdoor: Ingreslock
(OID: 1.3.6.1.4.1.25623.1.0.103549)
Version used: 2023-07-25T05:05:58Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: A whole cleanup of the infected system is recommended.

# Vulnerabilidade 7
CVEs: CVE-2020-1938
NVT Name: Apache Tomcat AJP RCE Vulnerability (Ghostcat)
Port: 8009.0
Port Protocol: tcp
Summary: Apache Tomcat is prone to a remote code execution (RCE)
  vulnerability (dubbed 'Ghostcat') in the AJP connector.
Specific Result: It was possible to read the file "/WEB-INF/web.xml" through the AJP connector.

Result:

AB 8\x0004 Ã\x0088 \x0002OK  \x0001 \x000CContent-Type  \x001Ctext/html;charset=ISO-8859-1 AB\x001FÃ¼\x0003\x001FÃ¸<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
    <title>Apache Tomcat/5.5</title>
    <style type="text/css">
    /*<![CDATA[*/
      body {
          color: #000000;
          background-color: #FFFFFF;
	  font-family: Arial, "Times New Roman", Times, serif;
          margin: 10px 0px;
      }

    img {
       border: none;
    }
    
    a:link, a:visited {
        color: blue
    }

    th {
        font-family: Verdana, "Times New Roman", Times, serif;
        font-size: 110%;
        font-weight: normal;
        font-style: italic;
        background: #D2A41C;
        text-align: left;
    }

    td {
        color: #000000;
	font-family: Arial, Helvetica, sans-serif;
    }
    
    td.menu {
        background: #FFDC75;
    }

    .center {
        text-align: center;
    }

    .code {
        color: #000000;
        font-family: "Courier New", Courier, monospace;
        font-size: 110%;
        margin-left: 2.5em;
    }
    
     #banner {
        margin-bottom: 12px;
     }

     p#congrats {
         margin-top: 0;
         font-weight: bold;
         text-align: center;
     }

     p#footer {
         text-align: right;
         font-size: 80%;
     }
     /*]]>*/
   </style>
</head>

<body>

<!-- Header -->
<table id="banner" width="100%">
    <tr>
      <td align="left" style="width:130px">
        <a href="http://tomcat.apache.org/">
	  <img src="tomcat.gif" height="92" width="130" alt="The Mighty Tomcat - MEOW!"/>
	</a>
      </td>
      <td align="left" valign="top"><b>Apache Tomcat/5.5</b></td>
      <td align="right">
        <a href="http://www.apache.org/">
	  <img src="asf-logo-wide.gif" height="51" width="537" alt="The Apache Software Foundation"/>
	</a>
       </td>
     </tr>
</table>

<table>
    <tr>

        <!-- Table of Contents -->
        <td valign="top">
            <table width="100%" border="1" cellspacing="0" cellpadding="3">
                <tr>
		  <th>Administration</th>
                </tr>
                <tr>
		  <td class="menu">
		    <a href="manager/status">Status</a><br/>
                    <a href="admin">Tomcat&nbsp;Administration</a><br/>
                    <a href="manager/html">Tomcat&nbsp;Manager</a><br/>
                    &nbsp;
                  </td>
                </tr>
            </table>

	    <br />
            <table width="100%" border="1" cellspacing="0" cellpadding="3">
                <tr>
		  <th>Documentation</th>
                </tr>
                <tr>
                  <td class="menu">
                    <a href="RELEASE-NOTES.txt">Release&nbsp;Notes</a><br/>
                    <a href="tomcat-docs/changelog.html">Change&nbsp;Log</a><br/>
                    <a href="tomcat-docs">Tomcat&nbsp;Documentation</a><br/>                        &nbsp;
                    &nbsp;
		    </td>
                </tr>
            </table>
	    
            <br/>
            <table width="100%" border="1" cellspacing="0" cellpadding="3">
                <tr>
                  <th>Tomcat Online</th>
                </tr>
                <tr>
                  <td class="menu">
                    <a href="http://tomcat.apache.org/">Home&nbsp;Page</a><br/>
		    <a href="http://tomcat.apache.org/faq/">FAQ</a><br/>
                    <a href="http://tomcat.apache.org/bugreport.html">Bug&nbsp;Database</a><br/>
                    <a href="http://issues.apache.org/bugzilla/buglist.cgi?bug_status=UNCONFIRMED&amp;bug_status=NEW&amp;bug_status=ASSIGNED&amp;bug_status=REOPENED&amp;bug_status=RESOLVED&amp;resolution=LATER&amp;resolution=REMIND&amp;resolution=---&amp;bugidtype=include&amp;product=Tomcat+5&amp;cmdtype=doit&amp;order=Importance">Open Bugs</a><br/>
                    <a href="http://mail-archives.apache.org/mod_mbox/tomcat-users/">Users&nbsp;Mailing&nbsp;List</a><br/>
                    <a href="http://mail-archives.apache.org/mod_mbox/tomcat-dev/">Developers&nbsp;Mailing&nbsp;List</a><br/>
                    <a href="irc://irc.freenode.net/#tomcat">IRC</a><br/>
		    &nbsp;
                  </td>
                </tr>
            </table>
	    
            <br/>
            <table width="100%" border="1" cellspacing="0" cellpadding="3">
                <tr>
                  <th>Examples</th>
                </tr>
                <tr>
                  <td class="menu">
                    <a href="jsp-examples/">JSP&nbsp;Examples</a><br/>
                    <a href="servlets-examples/">Servlet&nbsp;Examples</a><br/>
                    <a href="webdav/">WebDAV&nbsp;capabilities</a><br/>
     		    &nbsp;
                  </td>
                </tr>
            </table>
	    
            <br/>
            <table width="100%" border="1" cellspacing="0" cellpadding="3">
                <tr>
		  <th>Miscellaneous</th>
                </tr>
                <tr>
                  <td class="menu">
                    <a href="http://java.sun.com/products/jsp">Sun's&nbsp;Java&nbsp;Server&nbsp;Pages&nbsp;Site</a><br/>
                    <a href="http://java.sun.com/products/servlet">Sun's&nbsp;Servlet&nbsp;Site</a><br/>
    		    &nbsp;
                  </td>
                </tr>
            </table>
        </td>

        <td style="width:20px">&nbsp;</td>
	
        <!-- Body -->
        <td align="left" valign="top">
          <p id="congrats">If you're seeing this page via a web browser, it means you've setup Tomcat successfully. Congratulations!</p>
 
          <p>As you may have guessed by now, this is the default Tomcat home page. It can be found on the local filesystem at:</p>
          <p class="code">$CATALINA_HOME/webapps/ROOT/index.jsp</p>
	  
          <p>where "$CATALINA_HOME" is the root of the Tomcat installation directory. If you're seeing this page, and you don't think you should be, then either you're either a user who has arrived at new installation of Tomcat, or you're an administrator who hasn't got his/her setup quite right. Providing the latter is the case, please refer to the <a href="tomcat-docs">Tomcat Documentation</a> for more detailed setup and administration information than is found in the INSTALL file.</p>

            <p><b>NOTE:</b> This page is precompiled. If you change it, this page will not change since
                  it was compiled into a servlet at build time.
                  (See <tt>$CATALINA_HOME/webapps/ROOT/WEB-INF/web.xml</tt> as to how it was mapped.)
            </p>

            <p><b>NOTE: For security reasons, using the administration webapp
            is restricted to users with role "admin". The manager webapp
            is restricted to users with role "manager".</b>
            Users are defined in <code>$CATALINA_HOME/conf/tomcat-users.xml</code>.</p>

            <p>Included with this release are a host of sample Servlets and JSPs (with associated source code), extensive documentation (including the Servlet 2.4 and JSP 2.0 API JavaDoc), and an introductory guide to developing web applications.</p>

            <p>Tomcat mailing lists are available at the Tomcat project web site:</p>

           <ul>
               <li><b><a href="mailto:users@tomcat.apache.org">users@tomc

Vulnerability Detection Method: Sends a crafted AJP request and checks the response.
Details:
Apache Tomcat AJP RCE Vulnerability (Ghostcat)
(OID: 1.3.6.1.4.1.25623.1.0.143545)
Version used: 2025-01-21T05:37:33Z

Affected Software/OS: Apache Tomcat versions prior 7.0.100, 8.5.51 or 9.0.31 when the AJP connector
  is enabled.

  Other products like JBoss or Wildfly which are using Tomcat might be affected as well.
Product Detection Result: nan
Solution: Update Apache Tomcat to version 7.0.100, 8.5.51, 9.0.31 or later. For other products
  using Tomcat please contact the vendor for more information on fixed versions.

# Vulnerabilidade 8
CVEs: CVE-2015-4669,CVE-2001-0645,CVE-2002-1809,CVE-2004-1532,CVE-2004-2357,CVE-2006-1451,CVE-2007-2554,CVE-2007-6081,CVE-2009-0919,CVE-2014-3419,CVE-2016-6531,CVE-2018-15719,CVE-2024-22901
NVT Name: MySQL / MariaDB Default Credentials (MySQL Protocol)
Port: 3306.0
Port Protocol: tcp
Summary: It was possible to login into the remote MySQL using default
  credentials.
Specific Result: It was possible to login as user "root" with an empty password.

Vulnerability Detection Method: 
Details:
MySQL / MariaDB Default Credentials (MySQL Protocol)
(OID: 1.3.6.1.4.1.25623.1.0.103551)
Version used: 2025-03-14T05:38:04Z

Affected Software/OS: The following products are know to use such weak credentials:

  - CVE-2001-0645: Symantec/AXENT NetProwler 3.5.x

  - CVE-2002-1809: Windows binary release of MySQL 3.23.2 through 3.23.52

  - CVE-2004-1532: AppServ 2.5.x and earlier

  - CVE-2004-2357: Proofpoint Protection Server

  - CVE-2006-1451: MySQL Manager in Apple Mac OS X 10.3.9 and 10.4.6

  - CVE-2007-2554: Associated Press (AP) Newspower 4.0.1 and earlier

  - CVE-2007-6081: AdventNet EventLog Analyzer build 4030

  - CVE-2009-0919: XAMPP

  - CVE-2014-3419: Infoblox NetMRI before 6.8.5

  - CVE-2015-4669: Xsuite 2.x

  - CVE-2016-6531, CVE-2018-15719: Open Dental before version 18.4

  - CVE-2024-22901: Vinchin Backup & Recovery 7.2 and prior

  Other products might be affected as well.
Product Detection Result: Product: cpe:/a:mysql:mysql:5.0.51a
Method: MariaDB / Oracle MySQL Detection (MySQL Protocol)
(OID: 1.3.6.1.4.1.25623.1.0.100152)

Solution: '- Change the password as soon as possible

  - Contact the vendor for other possible fixes / updates

# Vulnerabilidade 9
CVEs: CVE-2017-11147,CVE-2016-10158,CVE-2016-10159,CVE-2016-10160,CVE-2016-10161,CVE-2016-10167,CVE-2016-10168
NVT Name: PHP < 5.6.30, 7.x < 7.0.15, 7.1.x < 7.1.1 Multiple Vulnerabilities (Jan 2017) - Linux
Port: 80.0
Port Protocol: tcp
Summary: PHP is prone to multiple vulnerabilities.
Specific Result: Installed version: 5.2.4
Fixed version:     5.6.30
Installation
path / port:       80/tcp


Vulnerability Detection Method: Checks if a vulnerable version is present on the target host.
Details:
PHP < 5.6.30, 7.x < 7.0.15, 7.1.x < 7.1.1 Multiple Vulnerabilities (Jan 2017...
(OID: 1.3.6.1.4.1.25623.1.0.108052)
Version used: 2025-05-21T05:40:19Z

Affected Software/OS: PHP prior to version 5.6.30, 7.x prior to 7.0.15 and 7.1.x
  prior to 7.1.1.
Product Detection Result: Product: cpe:/a:php:php:5.2.4
Method: PHP Detection (HTTP)
(OID: 1.3.6.1.4.1.25623.1.0.800109)

Solution: Update to version 5.6.30, 7.0.15, 7.1.1 or later.

# Vulnerabilidade 10
CVEs: CVE-2012-1823,CVE-2012-2311,CVE-2012-2336,CVE-2012-2335
NVT Name: PHP < 5.3.13, 5.4.x < 5.4.3 Multiple Vulnerabilities - Active Check
Port: 80.0
Port Protocol: tcp
Summary: PHP is prone to multiple vulnerabilities.
Specific Result: By doing the following HTTP POST request:

"HTTP POST" body : <?php phpinfo();?>
URL              : http://192.168.100.20/cgi-bin/php?%2D%64+%61%6C%6C%6F%77%5F%75%72%6C%5F%69%6E%63%6C%75%64%65%3D%6F%6E+%2D%64+%73%61%66%65%5F%6D%6F%64%65%3D%6F%66%66+%2D%64+%73%75%68%6F%73%69%6E%2E%73%69%6D%75%6C%61%74%69%6F%6E%3D%6F%6E+%2D%64+%64%69%73%61%62%6C%65%5F%66%75%6E%63%74%69%6F%6E%73%3D%22%22+%2D%64+%6F%70%65%6E%5F%62%61%73%65%64%69%72%3D%6E%6F%6E%65+%2D%64+%61%75%74%6F%5F%70%72%65%70%65%6E%64%5F%66%69%6C%65%3D%70%68%70%3A%2F%2F%69%6E%70%75%74+%2D%64+%63%67%69%2E%66%6F%72%63%65%5F%72%65%64%69%72%65%63%74%3D%30+%2D%64+%63%67%69%2E%72%65%64%69%72%65%63%74%5F%73%74%61%74%75%73%5F%65%6E%76%3D%30+%2D%6E

it was possible to execute the "<?php phpinfo();?>" command.

Result:
  <title>phpinfo()</title><meta name="ROBOTS" content="NOINDEX,NOFOLLOW,NOARCHIVE" /></head>
  <tr><td class="e">Configuration File (php.ini) Path </td><td class="v">/etc/php5/cgi </td></tr>
  <h2>PHP Variables</h2>

Vulnerability Detection Method: Send multiple a crafted HTTP POST requests and checks the
  responses.

  Note: This script checks for the presence of CVE-2012-1823 which indicates that the system is also
  affected by the other included CVEs.
Details:
PHP < 5.3.13, 5.4.x < 5.4.3 Multiple Vulnerabilities - Active Check
(OID: 1.3.6.1.4.1.25623.1.0.103482)
Version used: 2025-04-24T05:40:00Z

Affected Software/OS: PHP versions prior to 5.3.13 and 5.4.x prior to 5.4.3.

  Other products / applications might be affected by the tested CVE-2012-1823 as well.
Product Detection Result: nan
Solution: PHP: Update to version 5.3.13, 5.4.3 or later

  - Other products / applications: Please contact the vendor for a solution

# Vulnerabilidade 11
CVEs: CVE-2011-2523
NVT Name: vsftpd Compromised Source Packages Backdoor Vulnerability
Port: 6200.0
Port Protocol: tcp
Summary: vsftpd is prone to a backdoor vulnerability.
Specific Result: Vulnerability was detected according to the Vulnerability Detection Method.
Vulnerability Detection Method: 
Details:
vsftpd Compromised Source Packages Backdoor Vulnerability
(OID: 1.3.6.1.4.1.25623.1.0.103185)
Version used: 2023-12-07T05:05:41Z

Affected Software/OS: The vsftpd 2.3.4 source package downloaded between 20110630 and
  20110703 is affected.
Product Detection Result: nan
Solution: The repaired package can be downloaded from the referenced
  vendor homepage. Please validate the package with its signature.

# Vulnerabilidade 12
CVEs: CVE-2011-2523
NVT Name: vsftpd Compromised Source Packages Backdoor Vulnerability
Port: 21.0
Port Protocol: tcp
Summary: vsftpd is prone to a backdoor vulnerability.
Specific Result: Vulnerability was detected according to the Vulnerability Detection Method.
Vulnerability Detection Method: 
Details:
vsftpd Compromised Source Packages Backdoor Vulnerability
(OID: 1.3.6.1.4.1.25623.1.0.103185)
Version used: 2023-12-07T05:05:41Z

Affected Software/OS: The vsftpd 2.3.4 source package downloaded between 20110630 and
  20110703 is affected.
Product Detection Result: Product: cpe:/a:beasts:vsftpd:2.3.4
Method: vsFTPd FTP Server Detection
(OID: 1.3.6.1.4.1.25623.1.0.111050)

Solution: The repaired package can be downloaded from the referenced
  vendor homepage. Please validate the package with its signature.

# Vulnerabilidade 13
CVEs: CVE-2004-2687
NVT Name: DistCC RCE Vulnerability (CVE-2004-2687)
Port: 3632.0
Port Protocol: tcp
Summary: DistCC is prone to a remote code execution (RCE)
  vulnerability.
Specific Result: It was possible to execute the "id" command.

Result: uid=1(daemon) gid=1(daemon)

Vulnerability Detection Method: 
Details:
DistCC RCE Vulnerability (CVE-2004-2687)
(OID: 1.3.6.1.4.1.25623.1.0.103553)
Version used: 2022-07-07T10:16:06Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Vendor updates are available. Please see the references for
  more information.

  For more information about DistCC's security see the references.

# Vulnerabilidade 14
CVEs: nan
NVT Name: PostgreSQL Default Credentials (PostgreSQL Protocol)
Port: 5432.0
Port Protocol: tcp
Summary: It was possible to login into the remote PostgreSQL as user
  postgres using weak credentials.
Specific Result: It was possible to login as user postgres with password "postgres".



Vulnerability Detection Method: 
Details:
PostgreSQL Default Credentials (PostgreSQL Protocol)
(OID: 1.3.6.1.4.1.25623.1.0.103552)
Version used: 2024-07-19T15:39:06Z

Affected Software/OS: nan
Product Detection Result: Product: cpe:/a:postgresql:postgresql:8.3.1
Method: PostgreSQL Detection Consolidation
(OID: 1.3.6.1.4.1.25623.1.0.128025)

Solution: Change the password as soon as possible.

# Vulnerabilidade 15
CVEs: nan
NVT Name: VNC Brute Force Login
Port: 5900.0
Port Protocol: tcp
Summary: Try to log in with given passwords via VNC protocol.
Specific Result: It was possible to connect to the VNC server with the password: password

Vulnerability Detection Method: 
Details:
VNC Brute Force Login
(OID: 1.3.6.1.4.1.25623.1.0.106056)
Version used: 2021-07-23T07:56:26Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Change the password to something hard to guess or enable
  password protection at all.

# Vulnerabilidade 16
CVEs: nan
NVT Name: Test HTTP dangerous methods
Port: 80.0
Port Protocol: tcp
Summary: Misconfigured web servers allows remote clients to perform
  dangerous HTTP methods such as PUT and DELETE.
Specific Result: We could upload the following files via the PUT method at this web server:

http://192.168.100.20/dav/puttest537126888.html

We could delete the following files via the DELETE method at this web server:

http://192.168.100.20/dav/puttest537126888.html



Vulnerability Detection Method: Checks if dangerous HTTP methods such as PUT and DELETE are
  enabled and can be misused to upload or delete files.
Details:
Test HTTP dangerous methods
(OID: 1.3.6.1.4.1.25623.1.0.10498)
Version used: 2023-08-01T13:29:10Z

Affected Software/OS: Web servers with enabled PUT and/or DELETE methods.
Product Detection Result: nan
Solution: Use access restrictions to these dangerous HTTP methods
  or disable them completely.

# Vulnerabilidade 17
CVEs: CVE-1999-0501,CVE-1999-0502,CVE-1999-0507,CVE-1999-0508,CVE-2001-1594,CVE-2013-7404,CVE-2014-9198,CVE-2015-7261,CVE-2016-8731,CVE-2017-8218,CVE-2018-9068,CVE-2018-17771,CVE-2018-19063,CVE-2018-19064
NVT Name: FTP Brute Force Logins With Default Credentials Reporting
Port: 21.0
Port Protocol: tcp
Summary: It was possible to login into the remote FTP server using
  weak/known credentials.
Specific Result: It was possible to login with the following credentials <User>:<Password>

msfadmin:msfadmin
postgres:postgres
service:service
user:user

Vulnerability Detection Method: Reports weak/known credentials detected by the VT
  'FTP Brute Force Logins With Default Credentials' (OID: 1.3.6.1.4.1.25623.1.0.108717).
Details:
FTP Brute Force Logins With Default Credentials Reporting
(OID: 1.3.6.1.4.1.25623.1.0.108718)
Version used: 2025-05-13T05:41:39Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Change the password as soon as possible.

# Vulnerabilidade 18
CVEs: CVE-1999-0501,CVE-1999-0502,CVE-1999-0507,CVE-1999-0508,CVE-2001-1594,CVE-2013-7404,CVE-2014-9198,CVE-2015-7261,CVE-2016-8731,CVE-2017-8218,CVE-2018-9068,CVE-2018-17771,CVE-2018-19063,CVE-2018-19064
NVT Name: FTP Brute Force Logins With Default Credentials Reporting
Port: 2121.0
Port Protocol: tcp
Summary: It was possible to login into the remote FTP server using
  weak/known credentials.
Specific Result: It was possible to login with the following credentials <User>:<Password>

msfadmin:msfadmin
postgres:postgres
service:service
user:user

Vulnerability Detection Method: Reports weak/known credentials detected by the VT
  'FTP Brute Force Logins With Default Credentials' (OID: 1.3.6.1.4.1.25623.1.0.108717).
Details:
FTP Brute Force Logins With Default Credentials Reporting
(OID: 1.3.6.1.4.1.25623.1.0.108718)
Version used: 2025-05-13T05:41:39Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Change the password as soon as possible.

# Vulnerabilidade 19
CVEs: CVE-1999-0651
NVT Name: The rlogin service is running
Port: 513.0
Port Protocol: tcp
Summary: This remote host is running a rlogin service.
Specific Result: The rlogin service is running on the target system.

Vulnerability Detection Method: 
Details:
The rlogin service is running
(OID: 1.3.6.1.4.1.25623.1.0.901202)
Version used: 2025-03-05T05:38:53Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Disable the rlogin service and use alternatives like SSH instead.

# Vulnerabilidade 20
CVEs: CVE-1999-0651
NVT Name: rsh Unencrypted Cleartext Login
Port: 514.0
Port Protocol: tcp
Summary: This remote host is running a rsh service.
Specific Result: The rsh service currently has issues with name resolution and is not allowing connections from this host.

Vulnerability Detection Method: 
Details:
rsh Unencrypted Cleartext Login
(OID: 1.3.6.1.4.1.25623.1.0.100080)
Version used: 2021-10-20T09:03:29Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Disable the rsh service and use alternatives like SSH
  instead.

# Vulnerabilidade 21
CVEs: CVE-2014-0224
NVT Name: SSL/TLS: OpenSSL CCS Man in the Middle Security Bypass Vulnerability
Port: 5432.0
Port Protocol: tcp
Summary: OpenSSL is prone to a security bypass vulnerability.
Specific Result: Vulnerability was detected according to the Vulnerability Detection Method.
Vulnerability Detection Method: Send two SSL ChangeCipherSpec request and check the response.
Details:
SSL/TLS: OpenSSL CCS Man in the Middle Security Bypass Vulnerability
(OID: 1.3.6.1.4.1.25623.1.0.105042)
Version used: 2025-01-17T15:39:18Z

Affected Software/OS: OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m and 1.0.1 before 1.0.1h.
Product Detection Result: nan
Solution: Updates are available. Please see the references for more information.

# Vulnerabilidade 22
CVEs: CVE-2011-0411,CVE-2011-1430,CVE-2011-1431,CVE-2011-1432,CVE-2011-1506,CVE-2011-1575,CVE-2011-1926,CVE-2011-2165
NVT Name: Multiple Vendors STARTTLS Implementation Plaintext Arbitrary Command Injection Vulnerability
Port: 25.0
Port Protocol: tcp
Summary: Multiple vendors' implementations of 'STARTTLS' are prone to a
  vulnerability that lets attackers inject arbitrary commands.
Specific Result: Vulnerability was detected according to the Vulnerability Detection Method.
Vulnerability Detection Method: Send a special crafted 'STARTTLS' request and check the
  response.
Details:
Multiple Vendors STARTTLS Implementation Plaintext Arbitrary Command Injecti...
(OID: 1.3.6.1.4.1.25623.1.0.103935)
Version used: 2023-10-31T05:06:37Z

Affected Software/OS: The following vendors are known to be affected:

  Ipswitch

  Kerio

  Postfix

  Qmail-TLS

  Oracle

  SCO Group

  spamdyke

  ISC
Product Detection Result: nan
Solution: Updates are available. Please see the references for more
  information.

# Vulnerabilidade 23
CVEs: CVE-2009-4898
NVT Name: TWiki Cross-Site Request Forgery Vulnerability (Sep 2010)
Port: 80.0
Port Protocol: tcp
Summary: TWiki is prone to a cross-site request forgery (CSRF) vulnerability.
Specific Result: Installed version: 01.Feb.2003
Fixed version:     4.3.2


Vulnerability Detection Method: 
Details:
TWiki Cross-Site Request Forgery Vulnerability (Sep 2010)
(OID: 1.3.6.1.4.1.25623.1.0.801281)
Version used: 2024-03-01T14:37:10Z

Affected Software/OS: TWiki version prior to 4.3.2
Product Detection Result: nan
Solution: Upgrade to TWiki version 4.3.2 or later.

# Vulnerabilidade 24
CVEs: CVE-1999-0497
NVT Name: Anonymous FTP Login Reporting
Port: 21.0
Port Protocol: tcp
Summary: Reports if the remote FTP Server allows anonymous logins.
Specific Result: It was possible to login to the remote FTP service with the following anonymous account(s):

anonymous:anonymous@example.com
ftp:anonymous@example.com


Vulnerability Detection Method: 
Details:
Anonymous FTP Login Reporting
(OID: 1.3.6.1.4.1.25623.1.0.900600)
Version used: 2021-10-20T09:03:29Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: If you do not want to share files, you should disable anonymous
  logins.

# Vulnerabilidade 25
CVEs: CVE-2012-6708
NVT Name: jQuery < 1.9.0 XSS Vulnerability
Port: 80.0
Port Protocol: tcp
Summary: jQuery is prone to a cross-site scripting (XSS)
  vulnerability.
Specific Result: Installed version: 1.3.2
Fixed version:     1.9.0
Installation
path / port:       /mutillidae/javascript/ddsmoothmenu/jquery.min.js

Detection info (see OID: 1.3.6.1.4.1.25623.1.0.150658 for more info):
- Identified file: http://192.168.100.20/mutillidae/javascript/ddsmoothmenu/jquery.min.js
- Referenced at:   http://192.168.100.20/mutillidae/

Vulnerability Detection Method: Checks if a vulnerable version is present on the target host.
Details:
jQuery < 1.9.0 XSS Vulnerability
(OID: 1.3.6.1.4.1.25623.1.0.141636)
Version used: 2023-07-14T05:06:08Z

Affected Software/OS: jQuery prior to version 1.9.0.
Product Detection Result: nan
Solution: Update to version 1.9.0 or later.

# Vulnerabilidade 26
CVEs: CVE-2018-20212
NVT Name: TWiki < 6.1.0 XSS Vulnerability
Port: 80.0
Port Protocol: tcp
Summary: bin/statistics in TWiki 6.0.2 allows XSS via the webs parameter.
Specific Result: Installed version: 01.Feb.2003
Fixed version:     6.1.0


Vulnerability Detection Method: Checks if a vulnerable version is present on the target host.
Details:
TWiki < 6.1.0 XSS Vulnerability
(OID: 1.3.6.1.4.1.25623.1.0.141830)
Version used: 2023-07-14T16:09:27Z

Affected Software/OS: TWiki version 6.0.2 and probably prior.
Product Detection Result: nan
Solution: Update to version 6.1.0 or later.

# Vulnerabilidade 27
CVEs: CVE-2009-1339
NVT Name: TWiki CSRF Vulnerability
Port: 80.0
Port Protocol: tcp
Summary: TWiki is prone to a cross-site request forgery (CSRF) vulnerability.
Specific Result: Installed version: 01.Feb.2003
Fixed version:     4.3.1


Vulnerability Detection Method: 
Details:
TWiki CSRF Vulnerability
(OID: 1.3.6.1.4.1.25623.1.0.800400)
Version used: 2024-06-28T05:05:33Z

Affected Software/OS: TWiki version prior to 4.3.1
Product Detection Result: nan
Solution: Upgrade to version 4.3.1 or later.

# Vulnerabilidade 28
CVEs: CVE-2016-0800,CVE-2014-3566
NVT Name: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
Port: 5432.0
Port Protocol: tcp
Summary: It was possible to detect the usage of the deprecated SSLv2
  and/or SSLv3 protocol on this system.
Specific Result: In addition to TLSv1.0+ the service is also providing the deprecated SSLv3 protocol and supports one or more ciphers. Those supported ciphers can be found in the 'SSL/TLS: Report Supported Cipher Suites' (OID: 1.3.6.1.4.1.25623.1.0.802067) VT.

Vulnerability Detection Method: Checks the used SSL protocols of the services provided by this
  system.
Details:
SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
(OID: 1.3.6.1.4.1.25623.1.0.111012)
Version used: 2025-03-27T05:38:50Z

Affected Software/OS: All services providing an encrypted communication using the
  SSLv2 and/or SSLv3 protocols.
Product Detection Result: Product: cpe:/a:ietf:transport_layer_security:1.0
Method: SSL/TLS: Version Detection
(OID: 1.3.6.1.4.1.25623.1.0.105782)

Solution: It is recommended to disable the deprecated SSLv2 and/or SSLv3
  protocols in favor of the TLSv1.2+ protocols.

  Please see the references for more resources supporting you with this task.

# Vulnerabilidade 29
CVEs: CVE-2016-0800,CVE-2014-3566
NVT Name: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
Port: 25.0
Port Protocol: tcp
Summary: It was possible to detect the usage of the deprecated SSLv2
  and/or SSLv3 protocol on this system.
Specific Result: In addition to TLSv1.0+ the service is also providing the deprecated SSLv2 and SSLv3 protocols and supports one or more ciphers. Those supported ciphers can be found in the 'SSL/TLS: Report Supported Cipher Suites' (OID: 1.3.6.1.4.1.25623.1.0.802067) VT.

Vulnerability Detection Method: Checks the used SSL protocols of the services provided by this
  system.
Details:
SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
(OID: 1.3.6.1.4.1.25623.1.0.111012)
Version used: 2025-03-27T05:38:50Z

Affected Software/OS: All services providing an encrypted communication using the
  SSLv2 and/or SSLv3 protocols.
Product Detection Result: Product: cpe:/a:ietf:transport_layer_security:1.0
Method: SSL/TLS: Version Detection
(OID: 1.3.6.1.4.1.25623.1.0.105782)

Solution: It is recommended to disable the deprecated SSLv2 and/or SSLv3
  protocols in favor of the TLSv1.2+ protocols.

  Please see the references for more resources supporting you with this task.

# Vulnerabilidade 30
CVEs: CVE-2013-2566,CVE-2015-2808,CVE-2015-4000
NVT Name: SSL/TLS: Report Weak Cipher Suites
Port: 5432.0
Port Protocol: tcp
Summary: This routine reports all weak SSL/TLS cipher suites accepted by
  a service.
Specific Result: 'Weak' cipher suites accepted by this service via the SSLv3 protocol:

TLS_RSA_WITH_RC4_128_SHA

'Weak' cipher suites accepted by this service via the TLSv1.0 protocol:

TLS_RSA_WITH_RC4_128_SHA



Vulnerability Detection Method: Checks previous collected cipher suites.

  NOTE: No severity for SMTP services with 'Opportunistic TLS' and weak cipher suites on port 25/tcp
  is reported. If too strong cipher suites are configured for this service the alternative would be
  to fall back to an even more insecure cleartext communication.
Details:
SSL/TLS: Report Weak Cipher Suites
(OID: 1.3.6.1.4.1.25623.1.0.103440)
Version used: 2025-03-27T05:38:50Z

Affected Software/OS: All services providing an encrypted communication using weak
  SSL/TLS cipher suites.
Product Detection Result: Product: cpe:/a:ietf:transport_layer_security
Method: SSL/TLS: Report Supported Cipher Suites
(OID: 1.3.6.1.4.1.25623.1.0.802067)

Solution: The configuration of this services should be changed so that it
  does not accept the listed weak cipher suites anymore.

  Please see the references for more resources supporting you with this task.

# Vulnerabilidade 31
CVEs: CVE-2003-1567,CVE-2004-2320,CVE-2004-2763,CVE-2005-3398,CVE-2006-4683,CVE-2007-3008,CVE-2008-7253,CVE-2009-2823,CVE-2010-0386,CVE-2012-2223,CVE-2014-7883
NVT Name: HTTP Debugging Methods (TRACE/TRACK) Enabled
Port: 80.0
Port Protocol: tcp
Summary: The remote web server supports the TRACE and/or TRACK
  methods. TRACE and TRACK are HTTP methods which are used to debug web server connections.
Specific Result: The web server has the following HTTP methods enabled: TRACE

Vulnerability Detection Method: Checks if HTTP methods such as TRACE and TRACK are
  enabled and can be used.
Details:
HTTP Debugging Methods (TRACE/TRACK) Enabled
(OID: 1.3.6.1.4.1.25623.1.0.11213)
Version used: 2023-08-01T13:29:10Z

Affected Software/OS: Web servers with enabled TRACE and/or TRACK methods.
Product Detection Result: nan
Solution: Disable the TRACE and TRACK methods in your web server
  configuration.

  Please see the manual of your web server or the references for more information.

# Vulnerabilidade 32
CVEs: nan
NVT Name: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
Port: 25.0
Port Protocol: tcp
Summary: The remote SSL/TLS server certificate and/or any of the
  certificates in the certificate chain is using a RSA key with less than 2048 bits.
Specific Result: The remote SSL/TLS server is using the following certificate(s) with a RSA key with less than 2048 bits (public-key-size:public-key-algorithm:serial:issuer):

1024:RSA:00FAF93A4C7FB6B9CC:1.2.840.113549.1.9.1=#726F6F74407562756E74753830342D626173652E6C6F63616C646F6D61696E,CN=ubuntu804-base.localdomain,OU=Office for Complication of Otherwise Simple Affairs,O=OCOSA,L=Everywhere,ST=There is no such thing outside US,C=XX (Server certificate)

Vulnerability Detection Method: Checks the RSA keys size of the server certificate and all
  certificates in chain for a size < 2048 bit.
Details:
SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2...
(OID: 1.3.6.1.4.1.25623.1.0.150710)
Version used: 2021-12-10T12:48:00Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Replace the certificate with a stronger key and reissue the
  certificates it signed.

# Vulnerabilidade 33
CVEs: nan
NVT Name: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
Port: 5432.0
Port Protocol: tcp
Summary: The remote SSL/TLS server certificate and/or any of the
  certificates in the certificate chain is using a RSA key with less than 2048 bits.
Specific Result: The remote SSL/TLS server is using the following certificate(s) with a RSA key with less than 2048 bits (public-key-size:public-key-algorithm:serial:issuer):

1024:RSA:00FAF93A4C7FB6B9CC:1.2.840.113549.1.9.1=#726F6F74407562756E74753830342D626173652E6C6F63616C646F6D61696E,CN=ubuntu804-base.localdomain,OU=Office for Complication of Otherwise Simple Affairs,O=OCOSA,L=Everywhere,ST=There is no such thing outside US,C=XX (Server certificate)

Vulnerability Detection Method: Checks the RSA keys size of the server certificate and all
  certificates in chain for a size < 2048 bit.
Details:
SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2...
(OID: 1.3.6.1.4.1.25623.1.0.150710)
Version used: 2021-12-10T12:48:00Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Replace the certificate with a stronger key and reissue the
  certificates it signed.

# Vulnerabilidade 34
CVEs: nan
NVT Name: Weak Key Exchange (KEX) Algorithm(s) Supported (SSH)
Port: 22.0
Port Protocol: tcp
Summary: The remote SSH server is configured to allow / support weak key
  exchange (KEX) algorithm(s).
Specific Result: The remote SSH server supports the following weak KEX algorithm(s):

KEX algorithm                      | Reason
-------------------------------------------------------------------------------------------
diffie-hellman-group-exchange-sha1 | Using SHA-1
diffie-hellman-group1-sha1         | Using Oakley Group 2 (a 1024-bit MODP group) and SHA-1

Vulnerability Detection Method: Checks the supported KEX algorithms of the remote SSH server.

  Currently weak KEX algorithms are defined as the following:

  - non-elliptic-curve Diffie-Hellmann (DH) KEX algorithms with 1024-bit MODP group / prime

  - ephemerally generated key exchange groups uses SHA-1

  - using RSA 1024-bit modulus key
Details:
Weak Key Exchange (KEX) Algorithm(s) Supported (SSH)
(OID: 1.3.6.1.4.1.25623.1.0.150713)
Version used: 2024-06-14T05:05:48Z

Affected Software/OS: nan
Product Detection Result: Product: cpe:/a:ietf:secure_shell_protocol
Method: SSH Protocol Algorithms Supported
(OID: 1.3.6.1.4.1.25623.1.0.105565)

Solution: Disable the reported weak KEX algorithm(s)

  - 1024-bit MODP group / prime KEX algorithms:

  Alternatively use elliptic-curve Diffie-Hellmann in general, e.g. Curve 25519.

# Vulnerabilidade 35
CVEs: CVE-2008-0149,CVE-2023-49282,CVE-2023-49283,CVE-2024-10486
NVT Name: phpinfo() Output Reporting (HTTP)
Port: 80.0
Port Protocol: tcp
Summary: Reporting of files containing the output of the phpinfo() PHP
  function previously detected via HTTP.
Specific Result: The following files are calling the function phpinfo() which disclose potentially sensitive information:

http://192.168.100.20/mutillidae/phpinfo.php
Concluded from:
  <title>phpinfo()</title><meta name="ROBOTS" content="NOINDEX,NOFOLLOW,NOARCHIVE" /></head>
  <tr><td class="e">Configuration File (php.ini) Path </td><td class="v">/etc/php5/cgi </td></tr>
  <h2>PHP Variables</h2>
http://192.168.100.20/phpinfo.php
Concluded from:
  <title>phpinfo()</title><meta name="ROBOTS" content="NOINDEX,NOFOLLOW,NOARCHIVE" /></head>
  <tr><td class="e">Configuration File (php.ini) Path </td><td class="v">/etc/php5/cgi </td></tr>
  <h2>PHP Variables</h2>

Vulnerability Detection Method: This script reports files identified by the following separate
  VT: 'phpinfo() Output Detection (HTTP)' (OID: 1.3.6.1.4.1.25623.1.0.108474).
Details:
phpinfo() Output Reporting (HTTP)
(OID: 1.3.6.1.4.1.25623.1.0.11229)
Version used: 2025-04-10T05:39:37Z

Affected Software/OS: All systems exposing a file containing the output of the
  phpinfo() PHP function.

  This VT is also reporting if an affected endpoint for the following products have been identified:

  - CVE-2008-0149: TUTOS

  - CVE-2023-49282, CVE-2023-49283: Microsoft Graph PHP SDK

  - CVE-2024-10486: Google for WooCommerce plugin for WordPress
Product Detection Result: nan
Solution: Delete the listed files or restrict access to them.

# Vulnerabilidade 36
CVEs: nan
NVT Name: Weak Host Key Algorithm(s) (SSH)
Port: 22.0
Port Protocol: tcp
Summary: The remote SSH server is configured to allow / support weak host
  key algorithm(s).
Specific Result: The remote SSH server supports the following weak host key algorithm(s):

host key algorithm | Description
-----------------------------------------------------------------------------------------
ssh-dss            | Digital Signature Algorithm (DSA) / Digital Signature Standard (DSS)

Vulnerability Detection Method: Checks the supported host key algorithms of the remote SSH
  server.

  Currently weak host key algorithms are defined as the following:

  - ssh-dss: Digital Signature Algorithm (DSA) / Digital Signature Standard (DSS)
Details:
Weak Host Key Algorithm(s) (SSH)
(OID: 1.3.6.1.4.1.25623.1.0.117687)
Version used: 2024-06-14T05:05:48Z

Affected Software/OS: nan
Product Detection Result: Product: cpe:/a:ietf:secure_shell_protocol
Method: SSH Protocol Algorithms Supported
(OID: 1.3.6.1.4.1.25623.1.0.105565)

Solution: Disable the reported weak host key algorithm(s).

# Vulnerabilidade 37
CVEs: nan
NVT Name: Check if Mailserver answer to VRFY and EXPN requests
Port: 25.0
Port Protocol: tcp
Summary: The Mailserver on this host answers to VRFY and/or EXPN requests.
Specific Result: 'VRFY root' produces the following answer: 252 2.0.0 root



Vulnerability Detection Method: 
Details:
Check if Mailserver answer to VRFY and EXPN requests
(OID: 1.3.6.1.4.1.25623.1.0.100072)
Version used: 2023-10-31T05:06:37Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Disable VRFY and/or EXPN on your Mailserver.

  For postfix add 'disable_vrfy_command=yes' in 'main.cf'.

  For Sendmail add the option 'O PrivacyOptions=goaway'.

  It is suggested that, if you really want to publish this type of information, you use a mechanism
  that legitimate users actually know about, such as Finger or HTTP.

# Vulnerabilidade 38
CVEs: CVE-2011-1473,CVE-2011-5094
NVT Name: SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
Port: 25.0
Port Protocol: tcp
Summary: The remote SSL/TLS service is prone to a denial of service (DoS)
  vulnerability.
Specific Result: The following indicates that the remote SSL/TLS service is affected:

Protocol Version | Successful re-done SSL/TLS handshakes (Renegotiation) over an existing / already established SSL/TLS connection
----------------------------------------------------------------------------------------------------------------------------------
TLSv1.0          | 10

Vulnerability Detection Method: Checks if the remote service allows to re-do the same SSL/TLS
  handshake (Renegotiation) over an existing / already established SSL/TLS connection.
Details:
SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
(OID: 1.3.6.1.4.1.25623.1.0.117761)
Version used: 2024-09-27T05:05:23Z

Affected Software/OS: Every SSL/TLS service which does not properly restrict
  client-initiated renegotiation.
Product Detection Result: nan
Solution: Users should contact their vendors for specific patch information.

  A general solution is to remove/disable renegotiation capabilities altogether from/in the affected
  SSL/TLS service.

# Vulnerabilidade 39
CVEs: CVE-2011-1473,CVE-2011-5094
NVT Name: SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
Port: 5432.0
Port Protocol: tcp
Summary: The remote SSL/TLS service is prone to a denial of service (DoS)
  vulnerability.
Specific Result: The following indicates that the remote SSL/TLS service is affected:

Protocol Version | Successful re-done SSL/TLS handshakes (Renegotiation) over an existing / already established SSL/TLS connection
----------------------------------------------------------------------------------------------------------------------------------
TLSv1.0          | 10

Vulnerability Detection Method: Checks if the remote service allows to re-do the same SSL/TLS
  handshake (Renegotiation) over an existing / already established SSL/TLS connection.
Details:
SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
(OID: 1.3.6.1.4.1.25623.1.0.117761)
Version used: 2024-09-27T05:05:23Z

Affected Software/OS: Every SSL/TLS service which does not properly restrict
  client-initiated renegotiation.
Product Detection Result: nan
Solution: Users should contact their vendors for specific patch information.

  A general solution is to remove/disable renegotiation capabilities altogether from/in the affected
  SSL/TLS service.

# Vulnerabilidade 40
CVEs: nan
NVT Name: SSL/TLS: Certificate Expired
Port: 25.0
Port Protocol: tcp
Summary: The remote server's SSL/TLS certificate has already expired.
Specific Result: The certificate of the remote service expired on 2010-04-16 14:07:45.

Certificate details:
fingerprint (SHA-1)             | ED093088706603BFD5DC237399B498DA2D4D31C6
fingerprint (SHA-256)           | E7A7FA0D63E457C7C4A59B38B70849C6A70BDA6F830C7AF1E32DEE436DE813CC
issued by                       | 1.2.840.113549.1.9.1=#726F6F74407562756E74753830342D626173652E6C6F63616C646F6D61696E,CN=ubuntu804-base.localdomain,OU=Office for Complication of Otherwise Simple Affairs,O=OCOSA,L=Everywhere,ST=There is no such thing outside US,C=XX
public key algorithm            | RSA
public key size (bits)          | 1024
serial                          | 00FAF93A4C7FB6B9CC
signature algorithm             | sha1WithRSAEncryption
subject                         | 1.2.840.113549.1.9.1=#726F6F74407562756E74753830342D626173652E6C6F63616C646F6D61696E,CN=ubuntu804-base.localdomain,OU=Office for Complication of Otherwise Simple Affairs,O=OCOSA,L=Everywhere,ST=There is no such thing outside US,C=XX
subject alternative names (SAN) | None
valid from                      | 2010-03-17 14:07:45 UTC
valid until                     | 2010-04-16 14:07:45 UTC

Vulnerability Detection Method: 
Details:
SSL/TLS: Certificate Expired
(OID: 1.3.6.1.4.1.25623.1.0.103955)
Version used: 2024-06-14T05:05:48Z

Affected Software/OS: nan
Product Detection Result: Product: cpe:/a:ietf:transport_layer_security
Method: SSL/TLS: Collect and Report Certificate Details
(OID: 1.3.6.1.4.1.25623.1.0.103692)

Solution: Replace the SSL/TLS certificate by a new one.

# Vulnerabilidade 41
CVEs: nan
NVT Name: SSL/TLS: Certificate Expired
Port: 5432.0
Port Protocol: tcp
Summary: The remote server's SSL/TLS certificate has already expired.
Specific Result: The certificate of the remote service expired on 2010-04-16 14:07:45.

Certificate details:
fingerprint (SHA-1)             | ED093088706603BFD5DC237399B498DA2D4D31C6
fingerprint (SHA-256)           | E7A7FA0D63E457C7C4A59B38B70849C6A70BDA6F830C7AF1E32DEE436DE813CC
issued by                       | 1.2.840.113549.1.9.1=#726F6F74407562756E74753830342D626173652E6C6F63616C646F6D61696E,CN=ubuntu804-base.localdomain,OU=Office for Complication of Otherwise Simple Affairs,O=OCOSA,L=Everywhere,ST=There is no such thing outside US,C=XX
public key algorithm            | RSA
public key size (bits)          | 1024
serial                          | 00FAF93A4C7FB6B9CC
signature algorithm             | sha1WithRSAEncryption
subject                         | 1.2.840.113549.1.9.1=#726F6F74407562756E74753830342D626173652E6C6F63616C646F6D61696E,CN=ubuntu804-base.localdomain,OU=Office for Complication of Otherwise Simple Affairs,O=OCOSA,L=Everywhere,ST=There is no such thing outside US,C=XX
subject alternative names (SAN) | None
valid from                      | 2010-03-17 14:07:45 UTC
valid until                     | 2010-04-16 14:07:45 UTC

Vulnerability Detection Method: 
Details:
SSL/TLS: Certificate Expired
(OID: 1.3.6.1.4.1.25623.1.0.103955)
Version used: 2024-06-14T05:05:48Z

Affected Software/OS: nan
Product Detection Result: Product: cpe:/a:ietf:transport_layer_security
Method: SSL/TLS: Collect and Report Certificate Details
(OID: 1.3.6.1.4.1.25623.1.0.103692)

Solution: Replace the SSL/TLS certificate by a new one.

# Vulnerabilidade 42
CVEs: CVE-2005-0283
NVT Name: QWikiwiki directory traversal vulnerability
Port: 80.0
Port Protocol: tcp
Summary: The remote host is running QWikiwiki, a Wiki application written in PHP.

  The remote version of this software contains a validation input flaw which may allow an attacker
  to use it to read arbitrary files on the remote host with the privileges of the web server.
Specific Result: Vulnerable URL: http://192.168.100.20/mutillidae/index.php?page=../../../../../../../../../../../etc/passwd%00

Vulnerability Detection Method: 
Details:
QWikiwiki directory traversal vulnerability
(OID: 1.3.6.1.4.1.25623.1.0.16100)
Version used: 2025-04-15T05:54:49Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: No known solution was made available for at least one year since the disclosure
  of this vulnerability. Likely none will be provided anymore. General solution options are to upgrade to a newer
  release, disable respective features, remove the product or replace the product by another one.

# Vulnerabilidade 43
CVEs: nan
NVT Name: awiki <= 20100125 Multiple LFI Vulnerabilities - Active Check
Port: 80.0
Port Protocol: tcp
Summary: awiki is prone to multiple local file include (LFI)
  vulnerabilities because it fails to properly sanitize user-supplied input.
Specific Result: Vulnerable URL: http://192.168.100.20/mutillidae/index.php?page=/etc/passwd

Vulnerability Detection Method: Sends a crafted HTTP GET request and checks the response.
Details:
awiki <= 20100125 Multiple LFI Vulnerabilities - Active Check
(OID: 1.3.6.1.4.1.25623.1.0.103210)
Version used: 2025-04-15T05:54:49Z

Affected Software/OS: awiki version 20100125 and prior.
Product Detection Result: nan
Solution: No known solution was made available for at least one year
  since the disclosure of this vulnerability. Likely none will be provided anymore. General
  solution options are to upgrade to a newer release, disable respective features, remove the
  product or replace the product by another one.

# Vulnerabilidade 44
CVEs: CVE-1999-0678
NVT Name: /doc directory browsable
Port: 80.0
Port Protocol: tcp
Summary: The /doc directory is browsable.
  /doc shows the content of the /usr/doc directory and therefore it shows which programs and - important! - the version of the installed programs.
Specific Result: Vulnerable URL: http://192.168.100.20/doc/

Vulnerability Detection Method: 
Details:
/doc directory browsable
(OID: 1.3.6.1.4.1.25623.1.0.10056)
Version used: 2023-08-01T13:29:10Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Use access restrictions for the /doc directory.
  If you use Apache you might use this in your access.conf:

  <Directory /usr/doc>
  AllowOverride None
  order deny, allow
  deny from all
  allow from localhost
  </Directory>

# Vulnerabilidade 45
CVEs: nan
NVT Name: Telnet Unencrypted Cleartext Login
Port: 23.0
Port Protocol: tcp
Summary: The remote host is running a Telnet service that allows cleartext logins over
  unencrypted connections.
Specific Result: Vulnerability was detected according to the Vulnerability Detection Method.
Vulnerability Detection Method: 
Details:
Telnet Unencrypted Cleartext Login
(OID: 1.3.6.1.4.1.25623.1.0.108522)
Version used: 2023-10-13T05:06:09Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Replace Telnet with a protocol like SSH which supports encrypted connections.

# Vulnerabilidade 46
CVEs: nan
NVT Name: FTP Unencrypted Cleartext Login
Port: 2121.0
Port Protocol: tcp
Summary: The remote host is running a FTP service that allows cleartext logins over
  unencrypted connections.
Specific Result: The remote FTP service accepts logins without a previous sent 'AUTH TLS' command. Response(s):

Non-anonymous sessions: 331 Password required for openvasvt
Anonymous sessions:     331 Password required for anonymous

Vulnerability Detection Method: Tries to login to a non FTPS enabled FTP service without sending a
  'AUTH TLS' command first and checks if the service is accepting the login without enforcing the use of
  the 'AUTH TLS' command.
Details:
FTP Unencrypted Cleartext Login
(OID: 1.3.6.1.4.1.25623.1.0.108528)
Version used: 2023-12-20T05:05:58Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Enable FTPS or enforce the connection via the 'AUTH TLS' command. Please see
  the manual of the FTP service for more information.

# Vulnerabilidade 47
CVEs: nan
NVT Name: VNC Server Unencrypted Data Transmission
Port: 5900.0
Port Protocol: tcp
Summary: The remote host is running a VNC server providing one or more insecure or
  cryptographically weak Security Type(s) not intended for use on untrusted networks.
Specific Result: The VNC server provides the following insecure or cryptographically weak Security Type(s):

2 (VNC authentication)

Vulnerability Detection Method: 
Details:
VNC Server Unencrypted Data Transmission
(OID: 1.3.6.1.4.1.25623.1.0.108529)
Version used: 2023-07-12T05:05:04Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Run the session over an encrypted channel provided by IPsec [RFC4301] or SSH [RFC4254].
  Some VNC server vendors are also providing more secure Security Types within their products.

# Vulnerabilidade 48
CVEs: nan
NVT Name: FTP Unencrypted Cleartext Login
Port: 21.0
Port Protocol: tcp
Summary: The remote host is running a FTP service that allows cleartext logins over
  unencrypted connections.
Specific Result: The remote FTP service accepts logins without a previous sent 'AUTH TLS' command. Response(s):

Non-anonymous sessions: 331 Please specify the password.
Anonymous sessions:     331 Please specify the password.

Vulnerability Detection Method: Tries to login to a non FTPS enabled FTP service without sending a
  'AUTH TLS' command first and checks if the service is accepting the login without enforcing the use of
  the 'AUTH TLS' command.
Details:
FTP Unencrypted Cleartext Login
(OID: 1.3.6.1.4.1.25623.1.0.108528)
Version used: 2023-12-20T05:05:58Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Enable FTPS or enforce the connection via the 'AUTH TLS' command. Please see
  the manual of the FTP service for more information.

# Vulnerabilidade 49
CVEs: nan
NVT Name: Cleartext Transmission of Sensitive Information via HTTP
Port: 80.0
Port Protocol: tcp
Summary: The host / application transmits sensitive information (username, passwords) in
  cleartext via HTTP.
Specific Result: The following input fields were identified (URL:input name):

http://192.168.100.20/dvwa/login.php:password
http://192.168.100.20/phpMyAdmin/:pma_password
http://192.168.100.20/phpMyAdmin/?D=A:pma_password
http://192.168.100.20/tikiwiki/tiki-install.php:pass
http://192.168.100.20/twiki/bin/view/TWiki/TWikiUserAuthentication:oldpassword

Vulnerability Detection Method: Evaluate previous collected information and check if the host / application is not
  enforcing the transmission of sensitive data via an encrypted SSL/TLS connection.

  The script is currently checking the following:

  - HTTP Basic Authentication (Basic Auth)

  - HTTP Forms (e.g. Login) with input field of type 'password'
Details:
Cleartext Transmission of Sensitive Information via HTTP
(OID: 1.3.6.1.4.1.25623.1.0.108440)
Version used: 2023-09-07T05:05:21Z

Affected Software/OS: Hosts / applications which doesn't enforce the transmission of sensitive data via an
  encrypted SSL/TLS connection.
Product Detection Result: nan
Solution: Enforce the transmission of sensitive data via an encrypted SSL/TLS connection.
  Additionally make sure the host / application is redirecting all users to the secured SSL/TLS connection before
  allowing to input sensitive data into the mentioned functions.

# Vulnerabilidade 50
CVEs: CVE-2011-3389,CVE-2015-0204,CVE-2023-41928,CVE-2024-41270,CVE-2025-3200
NVT Name: SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
Port: 5432.0
Port Protocol: tcp
Summary: It was possible to detect the usage of the deprecated TLSv1.0
  and/or TLSv1.1 protocol on this system.
Specific Result: The service is only providing the deprecated TLSv1.0 protocol and supports one or more ciphers. Those supported ciphers can be found in the 'SSL/TLS: Report Supported Cipher Suites' (OID: 1.3.6.1.4.1.25623.1.0.802067) VT.

Vulnerability Detection Method: Checks the used TLS protocols of the services provided by this
  system.
Details:
SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
(OID: 1.3.6.1.4.1.25623.1.0.117274)
Version used: 2025-04-30T05:39:51Z

Affected Software/OS: '- All services providing an encrypted communication using the
  TLSv1.0 and/or TLSv1.1 protocols

  - CVE-2023-41928: Kiloview P1 4G and P2 4G Video Encoder

  - CVE-2024-41270: Gorush v1.18.4

  - CVE-2025-3200: Multiple products from Wiesemann & Theis
Product Detection Result: Product: cpe:/a:ietf:transport_layer_security:1.0
Method: SSL/TLS: Version Detection
(OID: 1.3.6.1.4.1.25623.1.0.105782)

Solution: It is recommended to disable the deprecated TLSv1.0 and/or
  TLSv1.1 protocols in favor of the TLSv1.2+ protocols.

  Please see the references for more resources supporting you with this task.

# Vulnerabilidade 51
CVEs: nan
NVT Name: Weak Encryption Algorithm(s) Supported (SSH)
Port: 22.0
Port Protocol: tcp
Summary: The remote SSH server is configured to allow / support weak
  encryption algorithm(s).
Specific Result: The remote SSH server supports the following weak client-to-server encryption algorithm(s):

3des-cbc
aes128-cbc
aes192-cbc
aes256-cbc
arcfour
arcfour128
arcfour256
blowfish-cbc
cast128-cbc
rijndael-cbc@lysator.liu.se


The remote SSH server supports the following weak server-to-client encryption algorithm(s):

3des-cbc
aes128-cbc
aes192-cbc
aes256-cbc
arcfour
arcfour128
arcfour256
blowfish-cbc
cast128-cbc
rijndael-cbc@lysator.liu.se

Vulnerability Detection Method: Checks the supported encryption algorithms (client-to-server
  and server-to-client) of the remote SSH server.

  Currently weak encryption algorithms are defined as the following:

  - Arcfour (RC4) cipher based algorithms

  - 'none' algorithm

  - CBC mode cipher based algorithms
Details:
Weak Encryption Algorithm(s) Supported (SSH)
(OID: 1.3.6.1.4.1.25623.1.0.105611)
Version used: 2024-06-14T05:05:48Z

Affected Software/OS: nan
Product Detection Result: Product: cpe:/a:ietf:secure_shell_protocol
Method: SSH Protocol Algorithms Supported
(OID: 1.3.6.1.4.1.25623.1.0.105565)

Solution: Disable the reported weak encryption algorithm(s).

# Vulnerabilidade 52
CVEs: CVE-2012-0053
NVT Name: Apache HTTP Server httpOnly Cookie Information Disclosure Vulnerability
Port: 80.0
Port Protocol: tcp
Summary: Apache HTTP Server is prone to a cookie information disclosure vulnerability.
Specific Result: Vulnerability was detected according to the Vulnerability Detection Method.
Vulnerability Detection Method: 
Details:
Apache HTTP Server 'httpOnly' Cookie Information Disclosure Vulnerability
(OID: 1.3.6.1.4.1.25623.1.0.902830)
Version used: 2025-03-05T05:38:53Z

Affected Software/OS: Apache HTTP Server versions 2.2.0 through 2.2.21.
Product Detection Result: Product: cpe:/a:apache:http_server:2.2.8
Method: Apache HTTP Server Detection Consolidation
(OID: 1.3.6.1.4.1.25623.1.0.117232)

Solution: Update to Apache HTTP Server version 2.2.22 or later.

# Vulnerabilidade 53
CVEs: CVE-2010-4480
NVT Name: phpMyAdmin error.php Cross Site Scripting Vulnerability
Port: 80.0
Port Protocol: tcp
Summary: phpMyAdmin is prone to a cross-site scripting (XSS) vulnerability.
Specific Result: Vulnerability was detected according to the Vulnerability Detection Method.
Vulnerability Detection Method: 
Details:
phpMyAdmin 'error.php' Cross Site Scripting Vulnerability
(OID: 1.3.6.1.4.1.25623.1.0.801660)
Version used: 2023-10-17T05:05:34Z

Affected Software/OS: phpMyAdmin version 3.3.8.1 and prior.
Product Detection Result: nan
Solution: No known solution was made available for at least one year since the disclosure
  of this vulnerability. Likely none will be provided anymore. General solution options are to upgrade to a newer
  release, disable respective features, remove the product or replace the product by another one.

# Vulnerabilidade 54
CVEs: CVE-2011-3389,CVE-2015-0204,CVE-2023-41928,CVE-2024-41270,CVE-2025-3200
NVT Name: SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
Port: 25.0
Port Protocol: tcp
Summary: It was possible to detect the usage of the deprecated TLSv1.0
  and/or TLSv1.1 protocol on this system.
Specific Result: The service is only providing the deprecated TLSv1.0 protocol and supports one or more ciphers. Those supported ciphers can be found in the 'SSL/TLS: Report Supported Cipher Suites' (OID: 1.3.6.1.4.1.25623.1.0.802067) VT.

Vulnerability Detection Method: Checks the used TLS protocols of the services provided by this
  system.
Details:
SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
(OID: 1.3.6.1.4.1.25623.1.0.117274)
Version used: 2025-04-30T05:39:51Z

Affected Software/OS: '- All services providing an encrypted communication using the
  TLSv1.0 and/or TLSv1.1 protocols

  - CVE-2023-41928: Kiloview P1 4G and P2 4G Video Encoder

  - CVE-2024-41270: Gorush v1.18.4

  - CVE-2025-3200: Multiple products from Wiesemann & Theis
Product Detection Result: Product: cpe:/a:ietf:transport_layer_security:1.0
Method: SSL/TLS: Version Detection
(OID: 1.3.6.1.4.1.25623.1.0.105782)

Solution: It is recommended to disable the deprecated TLSv1.0 and/or
  TLSv1.1 protocols in favor of the TLSv1.2+ protocols.

  Please see the references for more resources supporting you with this task.

# Vulnerabilidade 55
CVEs: CVE-2011-4969
NVT Name: jQuery < 1.6.3 XSS Vulnerability
Port: 80.0
Port Protocol: tcp
Summary: jQuery is prone to a cross-site scripting (XSS)
  vulnerability.
Specific Result: Installed version: 1.3.2
Fixed version:     1.6.3
Installation
path / port:       /mutillidae/javascript/ddsmoothmenu/jquery.min.js

Detection info (see OID: 1.3.6.1.4.1.25623.1.0.150658 for more info):
- Identified file: http://192.168.100.20/mutillidae/javascript/ddsmoothmenu/jquery.min.js
- Referenced at:   http://192.168.100.20/mutillidae/

Vulnerability Detection Method: Checks if a vulnerable version is present on the target host.
Details:
jQuery < 1.6.3 XSS Vulnerability
(OID: 1.3.6.1.4.1.25623.1.0.141637)
Version used: 2023-07-14T05:06:08Z

Affected Software/OS: jQuery prior to version 1.6.3.
Product Detection Result: nan
Solution: Update to version 1.6.3 or later.

# Vulnerabilidade 56
CVEs: CVE-2015-0204
NVT Name: SSL/TLS: RSA Temporary Key Handling RSA_EXPORT Downgrade Issue (FREAK)
Port: 25.0
Port Protocol: tcp
Summary: This host is accepting 'RSA_EXPORT' cipher suites and is prone
  to a man-in-the-middle (MITM) vulnerability.
Specific Result: 'RSA_EXPORT' cipher suites accepted by this service via the SSLv3 protocol:

TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA
TLS_RSA_EXPORT_WITH_DES40_CBC_SHA
TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5
TLS_RSA_EXPORT_WITH_RC4_40_MD5

'RSA_EXPORT' cipher suites accepted by this service via the TLSv1.0 protocol:

TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA
TLS_RSA_EXPORT_WITH_DES40_CBC_SHA
TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5
TLS_RSA_EXPORT_WITH_RC4_40_MD5



Vulnerability Detection Method: Checks previous collected cipher suites.
Details:
SSL/TLS: RSA Temporary Key Handling 'RSA_EXPORT' Downgrade Issue (FREAK)
(OID: 1.3.6.1.4.1.25623.1.0.805142)
Version used: 2025-03-27T05:38:50Z

Affected Software/OS: '- Hosts accepting 'RSA_EXPORT' cipher suites.

  - OpenSSL versions prior to 0.9.8zd, 1.0.0 prior to 1.0.0p and 1.0.1 prior to 1.0.1k.
Product Detection Result: Product: cpe:/a:ietf:transport_layer_security
Method: SSL/TLS: Report Supported Cipher Suites
(OID: 1.3.6.1.4.1.25623.1.0.802067)

Solution: '- Remove support for 'RSA_EXPORT' cipher suites from the
  service. Please see the references for more resources supporting you with this task.

  - If the service is using OpenSSL: Update to version 0.9.8zd, 1.0.0p, 1.0.1k or later.

# Vulnerabilidade 57
CVEs: nan
NVT Name: SSL/TLS: Certificate Signed Using A Weak Signature Algorithm
Port: 5432.0
Port Protocol: tcp
Summary: The remote service is using a SSL/TLS certificate in the certificate chain that has been signed using a
  cryptographically weak hashing algorithm.
Specific Result: The following certificates are part of the certificate chain but using insecure signature algorithms:

Subject:              1.2.840.113549.1.9.1=#726F6F74407562756E74753830342D626173652E6C6F63616C646F6D61696E,CN=ubuntu804-base.localdomain,OU=Office for Complication of Otherwise Simple Affairs,O=OCOSA,L=Everywhere,ST=There is no such thing outside US,C=XX
Signature Algorithm:  sha1WithRSAEncryption



Vulnerability Detection Method: Check which hashing algorithm was used to sign the remote SSL/TLS certificate.
Details:
SSL/TLS: Certificate Signed Using A Weak Signature Algorithm
(OID: 1.3.6.1.4.1.25623.1.0.105880)
Version used: 2021-10-15T11:13:32Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Servers that use SSL/TLS certificates signed with a weak SHA-1, MD5, MD4 or MD2 hashing algorithm will need to obtain new
  SHA-2 signed SSL/TLS certificates to avoid web browser SSL/TLS certificate warnings.

# Vulnerabilidade 58
CVEs: nan
NVT Name: SSL/TLS: Diffie-Hellman Key Exchange Insufficient DH Group Strength Vulnerability
Port: 5432.0
Port Protocol: tcp
Summary: The SSL/TLS service uses Diffie-Hellman groups with insufficient
  strength (key size < 2048).
Specific Result: Server Temporary Key Size: 1024 bits


Vulnerability Detection Method: Checks the DHE temporary public key size.
Details:
SSL/TLS: Diffie-Hellman Key Exchange Insufficient DH Group Strength Vulnerab...
(OID: 1.3.6.1.4.1.25623.1.0.106223)
Version used: 2025-03-27T05:38:50Z

Affected Software/OS: All services providing an encrypted communication using
  Diffie-Hellman groups with insufficient strength.
Product Detection Result: nan
Solution: '- Deploy (Ephemeral) Elliptic-Curve Diffie-Hellman (ECDHE) or use
  a 2048-bit or stronger Diffie-Hellman group. Please see the references for more resources
  supporting you with this task.

  - For Apache Web Servers: Beginning with version 2.4.7, mod_ssl will use DH parameters which
  include primes with lengths of more than 1024 bits.

# Vulnerabilidade 59
CVEs: nan
NVT Name: SSL/TLS: Diffie-Hellman Key Exchange Insufficient DH Group Strength Vulnerability
Port: 25.0
Port Protocol: tcp
Summary: The SSL/TLS service uses Diffie-Hellman groups with insufficient
  strength (key size < 2048).
Specific Result: Server Temporary Key Size: 1024 bits


Vulnerability Detection Method: Checks the DHE temporary public key size.
Details:
SSL/TLS: Diffie-Hellman Key Exchange Insufficient DH Group Strength Vulnerab...
(OID: 1.3.6.1.4.1.25623.1.0.106223)
Version used: 2025-03-27T05:38:50Z

Affected Software/OS: All services providing an encrypted communication using
  Diffie-Hellman groups with insufficient strength.
Product Detection Result: nan
Solution: '- Deploy (Ephemeral) Elliptic-Curve Diffie-Hellman (ECDHE) or use
  a 2048-bit or stronger Diffie-Hellman group. Please see the references for more resources
  supporting you with this task.

  - For Apache Web Servers: Beginning with version 2.4.7, mod_ssl will use DH parameters which
  include primes with lengths of more than 1024 bits.

# Vulnerabilidade 60
CVEs: nan
NVT Name: SSL/TLS: Certificate Signed Using A Weak Signature Algorithm
Port: 25.0
Port Protocol: tcp
Summary: The remote service is using a SSL/TLS certificate in the certificate chain that has been signed using a
  cryptographically weak hashing algorithm.
Specific Result: The following certificates are part of the certificate chain but using insecure signature algorithms:

Subject:              1.2.840.113549.1.9.1=#726F6F74407562756E74753830342D626173652E6C6F63616C646F6D61696E,CN=ubuntu804-base.localdomain,OU=Office for Complication of Otherwise Simple Affairs,O=OCOSA,L=Everywhere,ST=There is no such thing outside US,C=XX
Signature Algorithm:  sha1WithRSAEncryption



Vulnerability Detection Method: Check which hashing algorithm was used to sign the remote SSL/TLS certificate.
Details:
SSL/TLS: Certificate Signed Using A Weak Signature Algorithm
(OID: 1.3.6.1.4.1.25623.1.0.105880)
Version used: 2021-10-15T11:13:32Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Servers that use SSL/TLS certificates signed with a weak SHA-1, MD5, MD4 or MD2 hashing algorithm will need to obtain new
  SHA-2 signed SSL/TLS certificates to avoid web browser SSL/TLS certificate warnings.

# Vulnerabilidade 61
CVEs: CVE-2015-4000
NVT Name: SSL/TLS: DHE_EXPORT MITM Security Bypass Vulnerability (LogJam)
Port: 25.0
Port Protocol: tcp
Summary: This host is accepting 'DHE_EXPORT' cipher suites and is prone
  to a man-in-the-middle (MITM) vulnerability.
Specific Result: 'DHE_EXPORT' cipher suites accepted by this service via the SSLv3 protocol:

TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA
TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA
TLS_DH_anon_EXPORT_WITH_RC4_40_MD5

'DHE_EXPORT' cipher suites accepted by this service via the TLSv1.0 protocol:

TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA
TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA
TLS_DH_anon_EXPORT_WITH_RC4_40_MD5



Vulnerability Detection Method: Checks previous collected cipher suites.
Details:
SSL/TLS: 'DHE_EXPORT' MITM Security Bypass Vulnerability (LogJam)
(OID: 1.3.6.1.4.1.25623.1.0.805188)
Version used: 2025-03-27T05:38:50Z

Affected Software/OS: '- Hosts accepting 'DHE_EXPORT' cipher suites.

  - OpenSSL versions prior to 1.0.1n and 1.0.2 prior to 1.0.2b.
Product Detection Result: Product: cpe:/a:ietf:transport_layer_security
Method: SSL/TLS: Report Supported Cipher Suites
(OID: 1.3.6.1.4.1.25623.1.0.802067)

Solution: '- Remove support for 'DHE_EXPORT' cipher
  suites from the service. Please see the references for more resources supporting you with this
  task.

  - If the service is using OpenSSL: Update to version 1.0.1n, 1.0.2b or later.

# Vulnerabilidade 62
CVEs: CVE-2014-3566
NVT Name: SSL/TLS: SSLv3 Protocol CBC Cipher Suites Information Disclosure Vulnerability (POODLE)
Port: 25.0
Port Protocol: tcp
Summary: This host is prone to an information disclosure vulnerability.
Specific Result: Vulnerability was detected according to the Vulnerability Detection Method.
Vulnerability Detection Method: Evaluate previous collected information about this service.
Details:
SSL/TLS: SSLv3 Protocol CBC Cipher Suites Information Disclosure Vulnerabili...
(OID: 1.3.6.1.4.1.25623.1.0.802087)
Version used: 2024-09-30T08:38:05Z

Affected Software/OS: nan
Product Detection Result: Product: cpe:/a:ietf:transport_layer_security
Method: SSL/TLS: Report Supported Cipher Suites
(OID: 1.3.6.1.4.1.25623.1.0.802067)

Solution: Possible Mitigations are:

  - Disable SSLv3

  - Disable cipher suites supporting CBC cipher modes

  - Enable TLS_FALLBACK_SCSV if the service is providing TLSv1.0+

# Vulnerabilidade 63
CVEs: CVE-2014-3566
NVT Name: SSL/TLS: SSLv3 Protocol CBC Cipher Suites Information Disclosure Vulnerability (POODLE)
Port: 5432.0
Port Protocol: tcp
Summary: This host is prone to an information disclosure vulnerability.
Specific Result: Vulnerability was detected according to the Vulnerability Detection Method.
Vulnerability Detection Method: Evaluate previous collected information about this service.
Details:
SSL/TLS: SSLv3 Protocol CBC Cipher Suites Information Disclosure Vulnerabili...
(OID: 1.3.6.1.4.1.25623.1.0.802087)
Version used: 2024-09-30T08:38:05Z

Affected Software/OS: nan
Product Detection Result: Product: cpe:/a:ietf:transport_layer_security
Method: SSL/TLS: Report Supported Cipher Suites
(OID: 1.3.6.1.4.1.25623.1.0.802067)

Solution: Possible Mitigations are:

  - Disable SSLv3

  - Disable cipher suites supporting CBC cipher modes

  - Enable TLS_FALLBACK_SCSV if the service is providing TLSv1.0+

# Vulnerabilidade 64
CVEs: nan
NVT Name: Weak MAC Algorithm(s) Supported (SSH)
Port: 22.0
Port Protocol: tcp
Summary: The remote SSH server is configured to allow / support weak MAC
  algorithm(s).
Specific Result: The remote SSH server supports the following weak client-to-server MAC algorithm(s):

hmac-md5
hmac-md5-96
hmac-sha1-96
umac-64@openssh.com


The remote SSH server supports the following weak server-to-client MAC algorithm(s):

hmac-md5
hmac-md5-96
hmac-sha1-96
umac-64@openssh.com

Vulnerability Detection Method: Checks the supported MAC algorithms (client-to-server and
  server-to-client) of the remote SSH server.

  Currently weak MAC algorithms are defined as the following:

  - MD5 based algorithms

  - 96-bit based algorithms

  - 64-bit based algorithms

  - 'none' algorithm
Details:
Weak MAC Algorithm(s) Supported (SSH)
(OID: 1.3.6.1.4.1.25623.1.0.105610)
Version used: 2024-06-14T05:05:48Z

Affected Software/OS: nan
Product Detection Result: Product: cpe:/a:ietf:secure_shell_protocol
Method: SSH Protocol Algorithms Supported
(OID: 1.3.6.1.4.1.25623.1.0.105565)

Solution: Disable the reported weak MAC algorithm(s).

# Vulnerabilidade 65
CVEs: nan
NVT Name: TCP Timestamps Information Disclosure
Port: nan
Port Protocol: nan
Summary: The remote host implements TCP timestamps and therefore allows
  to compute the uptime.
Specific Result: It was detected that the host implements RFC1323/RFC7323.

The following timestamps were retrieved with a delay of 1 seconds in-between:
Packet 1: 95834
Packet 2: 95943

Vulnerability Detection Method: Special IP packets are forged and sent with a little delay in
  between to the target IP. The responses are searched for a timestamps. If found, the timestamps
  are reported.
Details:
TCP Timestamps Information Disclosure
(OID: 1.3.6.1.4.1.25623.1.0.80091)
Version used: 2023-12-15T16:10:08Z

Affected Software/OS: TCP implementations that implement RFC1323/RFC7323.
Product Detection Result: nan
Solution: To disable TCP timestamps on linux add the line
  'net.ipv4.tcp_timestamps = 0' to /etc/sysctl.conf. Execute 'sysctl -p' to apply the settings at
  runtime.

  To disable TCP timestamps on Windows execute 'netsh int tcp set global timestamps=disabled'

  Starting with Windows Server 2008 and Vista, the timestamp can not be completely disabled.

  The default behavior of the TCP/IP stack on this Systems is to not use the Timestamp options when
  initiating TCP connections, but use them if the TCP peer that is initiating communication includes
  them in their synchronize (SYN) segment.

  See the references for more information.

# Vulnerabilidade 66
CVEs: CVE-1999-0524
NVT Name: ICMP Timestamp Reply Information Disclosure
Port: nan
Port Protocol: nan
Summary: The remote host responded to an ICMP timestamp request.
Specific Result: The following response / ICMP packet has been received:
- ICMP Type: 14
- ICMP Code: 0

Vulnerability Detection Method: Sends an ICMP Timestamp (Type 13) request and checks if a
  Timestamp Reply (Type 14) is received.
Details:
ICMP Timestamp Reply Information Disclosure
(OID: 1.3.6.1.4.1.25623.1.0.103190)
Version used: 2025-01-21T05:37:33Z

Affected Software/OS: nan
Product Detection Result: nan
Solution: Various mitigations are possible:

  - Disable the support for ICMP timestamp on the remote host completely

  - Protect the remote host by a firewall, and block ICMP packets passing through the firewall in
  either direction (either completely or only for untrusted networks)

    ## REGRAS E RESTRIÇÕES DE SAÍDA
    1.  **APENAS SCRIPT:** A sua resposta deve conter ÚNICA E EXCLUSIVAMENTE o código do script.
    2.  **SEM EXPLICAÇÕES:** Não adicione nenhum comentário, explicação, introdução, ou despedida.
    3.  **SEM BLOCOS DE CÓDIGO MARKDOWN:** Não envolva o script em blocos de código como ` ```bash ` ou ` ```sh `. A resposta deve ser o texto puro do script.
    4.  **AUTOSSUFICIENTE:** O script deve ser completo, autônomo e não deve exigir interação do usuário para ser executado.
    5.  **COMPATIBILIDADE:** O script deve ser compatível com o sistema operacional especificado em 'localhost OS'. Se o sistema operacional não for especificado, assuma um sistema baseado em Linux (como Ubuntu/Debian).

>Scripts de correção:
{type: uploaded file
fileName: metasploitable66VT_1.txt
fullContent:
#!/bin/bash

# Vulnerabilidade 1: TWiki XSS and Command Execution Vulnerabilities
sudo apt-get update
sudo apt-get install -y twiki
sudo sed -i 's/Installed version: 01.Feb.2003/Fixed version: 4.2.4/' /path/to/twiki/config

# Vulnerabilidade 2: Distributed Ruby (dRuby/DRb) Multiple RCE Vulnerabilities
sudo gem update drb
sudo sed -i 's/$SAFE = 1/$SAFE = 2/' /path/to/ruby/config

# Vulnerabilidade 3: rlogin Passwordless Login
sudo systemctl stop rlogin
sudo systemctl disable rlogin

# Vulnerabilidade 4: Operating System (OS) End of Life (EOL) Detection
sudo do-release-upgrade

# Vulnerabilidade 5: The rexec service is running
sudo systemctl stop rexec
sudo systemctl disable rexec

# Vulnerabilidade 6: Possible Backdoor: Ingreslock
sudo apt-get remove --purge -y ingreslock
sudo rm -rf /usr/bin/ingreslock

# Vulnerabilidade 7: Apache Tomcat AJP RCE Vulnerability (Ghostcat)
sudo apt-get update
sudo apt-get install -y tomcat9
sudo systemctl restart tomcat9

# Vulnerabilidade 8: MySQL / MariaDB Default Credentials (MySQL Protocol)
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'NewStrongPassword';"

# Vulnerabilidade 9: PHP < 5.6.30, 7.x < 7.0.15, 7.1.x < 7.1.1 Multiple Vulnerabilities (Jan 2017) - Linux
sudo apt-get update
sudo apt-get install -y php7.0

# Vulnerabilidade 10: PHP < 5.3.13, 5.4.x < 5.4.3 Multiple Vulnerabilities - Active Check
sudo apt-get update
sudo apt-get install -y php5.6

# Vulnerabilidade 11: vsftpd Compromised Source Packages Backdoor Vulnerability
sudo apt-get remove --purge -y vsftpd
sudo apt-get install -y vsftpd

# Vulnerabilidade 12: vsftpd Compromised Source Packages Backdoor Vulnerability
sudo apt-get remove --purge -y vsftpd
sudo apt-get install -y vsftpd

# Vulnerabilidade 13: DistCC RCE Vulnerability (CVE-2004-2687)
sudo apt-get remove --purge -y distcc

# Vulnerabilidade 14: PostgreSQL Default Credentials (PostgreSQL Protocol)
sudo -u postgres psql -c "ALTER USER postgres WITH PASSWORD 'NewStrongPassword';"

# Vulnerabilidade 15: VNC Brute Force Login
sudo apt-get install -y tightvncserver
vncpasswd

# Vulnerabilidade 16: Test HTTP dangerous methods
sudo a2dismod include
sudo systemctl restart apache2

# Vulnerabilidade 17: FTP Brute Force Logins With Default Credentials Reporting
sudo passwd msfadmin
sudo passwd postgres
sudo passwd service
sudo passwd user

# Vulnerabilidade 18: FTP Brute Force Logins With Default Credentials Reporting
sudo passwd msfadmin
sudo passwd postgres
sudo passwd service
sudo passwd user

# Vulnerabilidade 19: The rlogin service is running
sudo systemctl stop rlogin
sudo systemctl disable rlogin

# Vulnerabilidade 20: rsh Unencrypted Cleartext Login
sudo systemctl stop rsh
sudo systemctl disable rsh

# Vulnerabilidade 21: SSL/TLS: OpenSSL CCS Man in the Middle Security Bypass Vulnerability
sudo apt-get update
sudo apt-get install -y openssl

# Vulnerabilidade 22: Multiple Vendors STARTTLS Implementation Plaintext Arbitrary Command Injection Vulnerability
sudo apt-get update
sudo apt-get install -y postfix

# Vulnerabilidade 23: TWiki Cross-Site Request Forgery Vulnerability (Sep 2010)
sudo apt-get update
sudo apt-get install -y twiki

# Vulnerabilidade 24: Anonymous FTP Login Reporting
sudo sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 25: jQuery < 1.9.0 XSS Vulnerability
sudo apt-get update
sudo apt-get install -y jquery

# Vulnerabilidade 26: TWiki < 6.1.0 XSS Vulnerability
sudo apt-get update
sudo apt-get install -y twiki

# Vulnerabilidade 27: TWiki CSRF Vulnerability
sudo apt-get update
sudo apt-get install -y twiki

# Vulnerabilidade 28: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
sudo a2enmod ssl
sudo sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 29: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
sudo a2enmod ssl
sudo sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 30: SSL/TLS: Report Weak Cipher Suites
sudo sed -i 's/SSLCipherSuite HIGH:MEDIUM:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 31: HTTP Debugging Methods (TRACE/TRACK) Enabled
sudo a2dismod trace
sudo systemctl restart apache2

# Vulnerabilidade 32: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 33: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 34: Weak Key Exchange (KEX) Algorithm(s) Supported (SSH)
sudo sed -i 's/KexAlgorithms diffie-hellman-group-exchange-sha1,diffie-hellman-group1-sha1/KexAlgorithms curve25519-sha256@libssh.org/' /etc/ssh/sshd_config
sudo systemctl restart sshd

# Vulnerabilidade 35: phpinfo() Output Reporting (HTTP)
sudo rm -f /var/www/html/phpinfo.php

# Vulnerabilidade 36: Weak Host Key Algorithm(s) (SSH)
sudo sed -i 's/HostKeyAlgorithms ssh-dss/HostKeyAlgorithms ssh-rsa/' /etc/ssh/sshd_config
sudo systemctl restart sshd

# Vulnerabilidade 37: Check if Mailserver answer to VRFY and EXPN requests
sudo sed -i 's/smtpd_discard_ehlo_keywords =/smtpd_discard_ehlo_keywords = vrfy, expn/' /etc/postfix/main.cf
sudo systemctl restart postfix

# Vulnerabilidade 38: SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
sudo sed -i 's/SSLProtocol all/SSLProtocol all -ClientRenegotiation/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 39: SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
sudo sed -i 's/SSLProtocol all/SSLProtocol all -ClientRenegotiation/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 40: SSL/TLS: Certificate Expired
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 41: SSL/TLS: Certificate Expired
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 42: QWikiwiki directory traversal vulnerability
sudo rm -rf /var/www/html/qwikiwiki

# Vulnerabilidade 43: awiki <= 20100125 Multiple LFI Vulnerabilities - Active Check
sudo rm -rf /var/www/html/awiki

# Vulnerabilidade 44: /doc directory browsable
sudo sed -i 's/<Directory \/usr\/doc>/<Directory \/usr\/doc>\n    AllowOverride None\n    order deny,allow\n    deny from all\n    allow from localhost\n<\/Directory>/' /etc/apache2/apache2.conf
sudo systemctl restart apache2

# Vulnerabilidade 45: Telnet Unencrypted Cleartext Login
sudo systemctl stop telnet
sudo systemctl disable telnet

# Vulnerabilidade 46: FTP Unencrypted Cleartext Login
sudo sed -i 's/ssl_enable=NO/ssl_enable=YES/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 47: VNC Server Unencrypted Data Transmission
sudo apt-get install -y tightvncserver
vncpasswd

# Vulnerabilidade 48: FTP Unencrypted Cleartext Login
sudo sed -i 's/ssl_enable=NO/ssl_enable=YES/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 49: Cleartext Transmission of Sensitive Information via HTTP
sudo a2enmod ssl
sudo a2ensite default-ssl
sudo systemctl restart apache2

# Vulnerabilidade 50: SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
sudo sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 51: Weak Encryption Algorithm(s) Supported (SSH)
sudo sed -i 's/Ciphers 3des-cbc,aes128-cbc,aes192-cbc,aes256-cbc,arcfour,arcfour128,arcfour256,blowfish-cbc,cast128-cbc,rijndael-c}
{type: uploaded file
fileName: metasploitable66VT_2.txt
fullContent:
#!/bin/bash

# Vulnerabilidade 1: TWiki XSS and Command Execution Vulnerabilities
if dpkg -l | grep -q "twiki"; then
    apt-get remove --purge -y twiki
fi

# Vulnerabilidade 2: Distributed Ruby (dRuby/DRb) Multiple RCE Vulnerabilities
systemctl stop drb
systemctl disable drb

# Vulnerabilidade 3: rlogin Passwordless Login
systemctl stop rlogin
systemctl disable rlogin

# Vulnerabilidade 5: The rexec service is running
systemctl stop rexec
systemctl disable rexec

# Vulnerabilidade 6: Possible Backdoor: Ingreslock
systemctl stop ingreslock
systemctl disable ingreslock

# Vulnerabilidade 7: Apache Tomcat AJP RCE Vulnerability (Ghostcat)
if dpkg -l | grep -q "tomcat"; then
    apt-get remove --purge -y tomcat
fi

# Vulnerabilidade 8: MySQL / MariaDB Default Credentials
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'StrongPassword!';"

# Vulnerabilidade 9: PHP Multiple Vulnerabilities
if dpkg -l | grep -q "php5"; then
    apt-get remove --purge -y php5
fi

# Vulnerabilidade 10: PHP Multiple Vulnerabilities - Active Check
if dpkg -l | grep -q "php7.0"; then
    apt-get remove --purge -y php7.0
fi

# Vulnerabilidade 11: vsftpd Compromised Source Packages Backdoor Vulnerability
if dpkg -l | grep -q "vsftpd"; then
    apt-get remove --purge -y vsftpd
fi

# Vulnerabilidade 12: vsftpd Compromised Source Packages Backdoor Vulnerability
if dpkg -l | grep -q "vsftpd"; then
    apt-get remove --purge -y vsftpd
fi

# Vulnerabilidade 13: DistCC RCE Vulnerability
if dpkg -l | grep -q "distcc"; then
    apt-get remove --purge -y distcc
fi

# Vulnerabilidade 14: PostgreSQL Default Credentials
psql -U postgres -c "ALTER USER postgres WITH PASSWORD 'StrongPassword!';"

# Vulnerabilidade 15: VNC Brute Force Login
systemctl stop vncserver
systemctl disable vncserver

# Vulnerabilidade 16: Test HTTP dangerous methods
a2dismod put
a2dismod delete
systemctl restart apache2

# Vulnerabilidade 17: FTP Brute Force Logins With Default Credentials Reporting
systemctl stop vsftpd
systemctl disable vsftpd

# Vulnerabilidade 18: FTP Brute Force Logins With Default Credentials Reporting
systemctl stop proftpd
systemctl disable proftpd

# Vulnerabilidade 19: The rlogin service is running
systemctl stop rlogin
systemctl disable rlogin

# Vulnerabilidade 20: rsh Unencrypted Cleartext Login
systemctl stop rsh
systemctl disable rsh

# Vulnerabilidade 21: OpenSSL CCS Man in the Middle Security Bypass Vulnerability
if dpkg -l | grep -q "openssl"; then
    apt-get install --only-upgrade -y openssl
fi

# Vulnerabilidade 22: Multiple Vendors STARTTLS Implementation Plaintext Arbitrary Command Injection Vulnerability
postconf -e "smtpd_tls_security_level = may"
systemctl restart postfix

# Vulnerabilidade 23: TWiki Cross-Site Request Forgery Vulnerability
if dpkg -l | grep -q "twiki"; then
    apt-get remove --purge -y twiki
fi

# Vulnerabilidade 24: Anonymous FTP Login Reporting
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
systemctl restart vsftpd

# Vulnerabilidade 25: jQuery < 1.9.0 XSS Vulnerability
find /var/www/html -name "jquery.min.js" -exec rm -rf {} \;

# Vulnerabilidade 26: TWiki < 6.1.0 XSS Vulnerability
if dpkg -l | grep -q "twiki"; then
    apt-get remove --purge -y twiki
fi

# Vulnerabilidade 27: TWiki CSRF Vulnerability
if dpkg -l | grep -q "twiki"; then
    apt-get remove --purge -y twiki
fi

# Vulnerabilidade 28: SSLv2 and SSLv3 Protocol Detection
sed -i 's/SSLProtocol all/SSLProtocol TLSv1.2/' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 29: SSLv2 and SSLv3 Protocol Detection
sed -i 's/SSLProtocol all/SSLProtocol TLSv1.2/' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 30: Report Weak Cipher Suites
sed -i 's/SSLCipherSuite HIGH:!aNULL/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4/' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 31: HTTP Debugging Methods (TRACE/TRACK) Enabled
sed -i 's/TraceEnable On/TraceEnable Off/' /etc/apache2/apache2.conf
systemctl restart apache2

# Vulnerabilidade 32: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 33: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 34: Weak Key Exchange (KEX) Algorithm(s) Supported (SSH)
sed -i 's/KexAlgorithms .*/KexAlgorithms curve25519-sha256@libssh.org/' /etc/ssh/sshd_config
systemctl restart ssh

# Vulnerabilidade 35: phpinfo() Output Reporting (HTTP)
find /var/www/html -name "phpinfo.php" -exec rm -rf {} \;

# Vulnerabilidade 36: Weak Host Key Algorithm(s) (SSH)
sed -i 's/HostKeyAlgorithms .*/HostKeyAlgorithms ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-ed25519,ssh-rsa/' /etc/ssh/sshd_config
systemctl restart ssh

# Vulnerabilidade 37: Check if Mailserver answer to VRFY and EXPN requests
postconf -e "disable_vrfy_command=yes"
systemctl restart postfix

# Vulnerabilidade 38: SSL/TLS: Renegotiation DoS Vulnerability
sed -i 's/SSLProtocol all/SSLProtocol TLSv1.2/' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 39: SSL/TLS: Renegotiation DoS Vulnerability
sed -i 's/SSLProtocol all/SSLProtocol TLSv1.2/' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 40: SSL/TLS: Certificate Expired
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 41: SSL/TLS: Certificate Expired
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 42: QWikiwiki directory traversal vulnerability
if dpkg -l | grep -q "qwikiwiki"; then
    apt-get remove --purge -y qwikiwiki
fi

# Vulnerabilidade 43: awiki <= 20100125 Multiple LFI Vulnerabilities - Active Check
if dpkg -l | grep -q "awiki"; then
    apt-get remove --purge -y awiki
fi

# Vulnerabilidade 44: /doc directory browsable
sed -i 's/<Directory \/usr\/doc>/<Directory \/usr\/doc>\n    AllowOverride None\n    Order deny,allow\n    Deny from all\n    Allow from 127.0.0.1/' /etc/apache2/apache2.conf
systemctl restart apache2

# Vulnerabilidade 45: Telnet Unencrypted Cleartext Login
systemctl stop telnet
systemctl disable telnet

# Vulnerabilidade 46: FTP Unencrypted Cleartext Login
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
systemctl restart vsftpd

# Vulnerabilidade 47: VNC Server Unencrypted Data Transmission
systemctl stop vncserver
systemctl disable vncserver

# Vulnerabilidade 48: FTP Unencrypted Cleartext Login
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
systemctl restart vsftpd

# Vulnerabilidade 49: Cleartext Transmission of Sensitive Information via HTTP
a2enmod ssl
systemctl restart apache2

# Vulnerabilidade 50: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
sed -i 's/SSLProtocol all/SSLProtocol TLSv1.2/' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 51: Weak Encryption Algorithm(s) Supported (SSH)
sed -i 's/Ciphers .*/Ciphers aes256-ctr,aes192-ctr,aes128-ctr/' /etc/ssh/sshd_config
systemctl restart ssh

# Vulnerabilidade 52: Apache HTTP Server httpOnly Cookie Information Disclosure Vulnerability
if dpkg -l | grep -q "apache2"; then
    apt-get install --only-upgrade -y apache2
fi

# Vulnerabilidade 53: phpMyAdmin error.php Cross Site Scripting Vulnerability
if dpkg -l | grep -q "phpmyadmin"; then
    apt-get remove --purge -y phpmyadmin
fi

# Vulnerabilidade 54: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
sed -i 's/SSLProtocol all/SSLProtocol TLSv1.2/' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 55: jQuery < 1.6.3 XSS Vulnerability
find /var/www/html -name "jquery.min.js" -exec rm -rf {} \;

# Vulnerabilidade 56: SSL/TLS: RSA Temporary Key Handling RSA_EXPORT Downgrade Issue (FREAK)
sed -i 's/SSLCipherSuite .*/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4/' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 57: SSL/TLS: Certificate Signed Using A Weak Signature Algorithm
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 58: SSL/TLS: Diffie-Hellman Key Exchange Insufficient DH Group Strength Vulnerability
openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048
echo "SSLOpenSSLConfCmd DHParameters \"/etc/ssl/certs/dhparam.pem\"" >> /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 59: SSL/TLS: Diffie-Hellman Key Exchange Insufficient DH Group Strength Vulnerability
openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048
echo "SSLOpenSSLConfCmd DHParameters \"/etc/ssl/certs/dhparam.pem\"" >> /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 60: SSL/TLS: Certificate Signed Using A Weak Signature Algorithm
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 61: SSL/TLS: DHE_EXPORT MITM Security Bypass Vulnerability (LogJam)
sed -i 's/SSLCipherSuite .*/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4/' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 62: SSL/TLS: SSLv3 Protocol CBC Cipher Suites Information Disclosure Vulnerability (POODLE)
sed -i 's/SSLProtocol all/SSLProtocol TLSv1.2/' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 63: SSL/TLS: SSLv3 Protocol CBC Cipher Suites Information Disclosure Vulnerability (POODLE)
sed -i 's/SSLProtocol all/SSLProtocol TLSv1.2/' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 64: Weak MAC Algorithm(s) Supported (SSH)
sed -i 's/MACs .*/MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256/' /etc/ssh/sshd_config
systemctl restart ssh

# Vulnerabilidade 65: TCP Timestamps Information Disclosure
echo "net.ipv4.tcp_timestamps = 0" >> /etc/sysctl.conf
sysctl -p

# Vulnerabilidade 66: ICMP Timestamp Reply Information Disclosure
echo "1" > /proc/sys/net/ipv4/icmp_echo_ignore_all}
{type: uploaded file
fileName: metasploitable66VT_3.txt
fullContent:
#!/bin/bash

# Atualiza o sistema
sudo apt-get update
sudo apt-get upgrade -y

# Correções específicas para as vulnerabilidades

# Vulnerabilidade 1: TWiki XSS and Command Execution Vulnerabilities
sudo apt-get install -y twiki=4.2.4

# Vulnerabilidade 2: Distributed Ruby (dRuby/DRb) Multiple RCE Vulnerabilities
sudo apt-get install -y ruby=2.7.0
echo "$SAFE >= 2" | sudo tee -a /etc/ruby/safe_mode.conf

# Vulnerabilidade 3: rlogin Passwordless Login
sudo systemctl disable rlogin
sudo systemctl stop rlogin
sudo apt-get remove -y rsh-client

# Vulnerabilidade 4: Operating System (OS) End of Life (EOL) Detection
sudo do-release-upgrade

# Vulnerabilidade 5: The rexec service is running
sudo systemctl disable rexec
sudo systemctl stop rexec
sudo apt-get remove -y rsh-client

# Vulnerabilidade 6: Possible Backdoor: Ingreslock
sudo apt-get remove -y ingreslock
sudo rm -rf /etc/ingreslock

# Vulnerabilidade 7: Apache Tomcat AJP RCE Vulnerability (Ghostcat)
sudo apt-get install -y tomcat9=9.0.31
sudo systemctl restart tomcat9

# Vulnerabilidade 8: MySQL / MariaDB Default Credentials (MySQL Protocol)
sudo mysql -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'new_password';"

# Vulnerabilidade 9: PHP < 5.6.30, 7.x < 7.0.15, 7.1.x < 7.1.1 Multiple Vulnerabilities
sudo apt-get install -y php7.4

# Vulnerabilidade 10: PHP < 5.3.13, 5.4.x < 5.4.3 Multiple Vulnerabilities
sudo apt-get install -y php7.4

# Vulnerabilidade 11: vsftpd Compromised Source Packages Backdoor Vulnerability
sudo apt-get install -y vsftpd=3.0.3

# Vulnerabilidade 12: vsftpd Compromised Source Packages Backdoor Vulnerability
sudo apt-get install -y vsftpd=3.0.3

# Vulnerabilidade 13: DistCC RCE Vulnerability (CVE-2004-2687)
sudo apt-get remove -y distcc

# Vulnerabilidade 14: PostgreSQL Default Credentials (PostgreSQL Protocol)
sudo -u postgres psql -c "ALTER USER postgres WITH PASSWORD 'new_password';"

# Vulnerabilidade 15: VNC Brute Force Login
sudo apt-get install -y vnc4server
vncpasswd

# Vulnerabilidade 16: Test HTTP dangerous methods
sudo a2dismod include
sudo a2dismod cgi
sudo systemctl restart apache2

# Vulnerabilidade 17: FTP Brute Force Logins With Default Credentials Reporting
sudo apt-get install -y vsftpd=3.0.3
sudo systemctl restart vsftpd

# Vulnerabilidade 18: FTP Brute Force Logins With Default Credentials Reporting
sudo apt-get install -y vsftpd=3.0.3
sudo systemctl restart vsftpd

# Vulnerabilidade 19: The rlogin service is running
sudo systemctl disable rlogin
sudo systemctl stop rlogin
sudo apt-get remove -y rsh-client

# Vulnerabilidade 20: rsh Unencrypted Cleartext Login
sudo systemctl disable rsh
sudo systemctl stop rsh
sudo apt-get remove -y rsh-client

# Vulnerabilidade 21: SSL/TLS: OpenSSL CCS Man in the Middle Security Bypass Vulnerability
sudo apt-get install -y openssl=1.1.1

# Vulnerabilidade 22: Multiple Vendors STARTTLS Implementation Plaintext Arbitrary Command Injection Vulnerability
sudo apt-get install -y postfix=3.4.13

# Vulnerabilidade 23: TWiki Cross-Site Request Forgery Vulnerability (Sep 2010)
sudo apt-get install -y twiki=4.3.2

# Vulnerabilidade 24: Anonymous FTP Login Reporting
sudo sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 25: jQuery < 1.9.0 XSS Vulnerability
sudo apt-get install -y jquery=1.9.0

# Vulnerabilidade 26: TWiki < 6.1.0 XSS Vulnerability
sudo apt-get install -y twiki=6.1.0

# Vulnerabilidade 27: TWiki CSRF Vulnerability
sudo apt-get install -y twiki=4.3.1

# Vulnerabilidade 28: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
sudo sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 29: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
sudo sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 30: SSL/TLS: Report Weak Cipher Suites
sudo sed -i 's/SSLCipherSuite HIGH:!aNULL/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 31: HTTP Debugging Methods (TRACE/TRACK) Enabled
sudo a2dismod trace
sudo a2dismod track
sudo systemctl restart apache2

# Vulnerabilidade 32: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 33: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 34: Weak Key Exchange (KEX) Algorithm(s) Supported (SSH)
sudo sed -i 's/KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha1/KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256/' /etc/ssh/sshd_config
sudo systemctl restart sshd

# Vulnerabilidade 35: phpinfo() Output Reporting (HTTP)
sudo rm -rf /var/www/html/phpinfo.php

# Vulnerabilidade 36: Weak Host Key Algorithm(s) (SSH)
sudo sed -i 's/HostKeyAlgorithms ssh-rsa,ssh-dss,ecdsa-sha2-nistp256,ssh-ed25519/HostKeyAlgorithms ssh-rsa,ecdsa-sha2-nistp256,ssh-ed25519/' /etc/ssh/sshd_config
sudo systemctl restart sshd

# Vulnerabilidade 37: Check if Mailserver answer to VRFY and EXPN requests
sudo sed -i 's/smtpd_discard_ehlo_keywords =/smtpd_discard_ehlo_keywords = vrfy, expn/' /etc/postfix/main.cf
sudo systemctl restart postfix

# Vulnerabilidade 38: SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
sudo sed -i 's/SSLHonorCipherOrder On/SSLHonorCipherOrder On\nSSLInsecureRenegotiation off/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 39: SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
sudo sed -i 's/SSLHonorCipherOrder On/SSLHonorCipherOrder On\nSSLInsecureRenegotiation off/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 40: SSL/TLS: Certificate Expired
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 41: SSL/TLS: Certificate Expired
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 42: QWikiwiki directory traversal vulnerability
sudo rm -rf /var/www/html/mutillidae

# Vulnerabilidade 43: awiki <= 20100125 Multiple LFI Vulnerabilities - Active Check
sudo rm -rf /var/www/html/mutillidae

# Vulnerabilidade 44: /doc directory browsable
sudo sed -i 's/Options Indexes FollowSymLinks/Options FollowSymLinks/' /etc/apache2/apache2.conf
sudo systemctl restart apache2

# Vulnerabilidade 45: Telnet Unencrypted Cleartext Login
sudo systemctl disable telnet
sudo systemctl stop telnet
sudo apt-get remove -y telnetd

# Vulnerabilidade 46: FTP Unencrypted Cleartext Login
sudo sed -i 's/ssl_enable=NO/ssl_enable=YES/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 47: VNC Server Unencrypted Data Transmission
sudo apt-get install -y vnc4server
vncpasswd

# Vulnerabilidade 48: FTP Unencrypted Cleartext Login
sudo sed -i 's/ssl_enable=NO/ssl_enable=YES/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 49: Cleartext Transmission of Sensitive Information via HTTP
sudo a2enmod ssl
sudo a2ensite default-ssl
sudo systemctl restart apache2

# Vulnerabilidade 50: SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
sudo sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 51: Weak Encryption Algorithm(s) Supported (SSH)
sudo sed -i 's/Ciphers aes128-ctr,aes192-ctr,aes256-ctr,arcfour,arcfour128,arcfour256,blowfish-cbc,cast128-cbc,3des-cbc/Ciphers aes128-ctr,aes192-ctr,aes256-ctr/' /etc/ssh/sshd_config
sudo systemctl restart sshd

# Vulnerabilidade 52: Apache HTTP Server httpOnly Cookie Information Disclosure Vulnerability
sudo sed -i 's/#Header edit Set-Cookie ^(.*)$ "$1; HttpOnly; Secure"/Header edit Set-Cookie ^(.*)$ "$1; HttpOnly; Secure"/' /etc/apache2/conf-enabled/security.conf
sudo systemctl restart apache2

# Vulnerabilidade 53: phpMyAdmin error.php Cross Site Scripting Vulnerability
sudo apt-get install -y phpmyadmin=4.9.5

# Vulnerabilidade 54: SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
sudo sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 55: jQuery < 1.6.3 XSS Vulnerability
sudo apt-get install -y jquery=1.6.3

# Vulnerabilidade 56: SSL/TLS: RSA Temporary Key Handling RSA_EXPORT Downgrade Issue (FREAK)
sudo sed -i 's/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4:!EXPORT/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 57: SSL/TLS: Certificate Signed Using A Weak Signature Algorithm
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 58: SSL/TLS: Diffie-Hellman Key Exchange Insufficient DH Group Strength Vulnerability
sudo openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048
sudo sed -i 's/#SSLHonorCipherOrder On/SSLHonorCipherOrder On\nSSLOpenSSLConfCmd DHParameters \/etc\/ssl\/certs\/dhparam.pem/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 59: SSL/TLS: Diffie-Hellman Key Exchange Insufficient DH Group Strength Vulnerability
sudo openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048
sudo sed -i 's/#SSLHonorCipherOrder On/SSLHonorCipherOrder On\nSSLOpenSSLConfCmd DHParameters \/etc\/ssl\/certs\/dhparam.pem/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 60: SSL/TLS: Certificate Signed Using A Weak Signature Algorithm
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 61: SSL/TLS: DHE_EXPORT MITM Security Bypass Vulnerability (LogJam)
sudo sed -i 's/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4:!EXPORT/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4:!EXPORT:!DHE/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 62: SSL/TLS: SSLv3 Protocol CBC Cipher Suites Information Disclosure Vulnerability (POODLE)
sudo sed -i 's/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1\nSSLInsecureRenegotiation off/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 63: SSL/TLS: SSLv3 Protocol CBC Cipher Suites Information Disclosure Vulnerability (POODLE)
sudo sed -i 's/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1\nSSLInsecureRenegotiation off/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 64: Weak MAC Algorithm(s) Supported (SSH)
sudo sed -i 's/MACs hmac-sha1,umac-64@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5,hmac-md5-96/MACs hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com/' /etc/ssh/sshd_config
sudo systemctl restart sshd

# Vulnerabilidade 65: TCP Timestamps Information Disclosure
sudo sed -i 's/#net.ipv4.tcp_timestamps = 1/net.ipv4.tcp_timestamps = 0/' /etc/sysctl.conf
sudo sysctl -p

# Vulnerabilidade 66: ICMP Timestamp Reply Information Disclosure
sudo sed -i 's/net.ipv4.icmp_echo_ignore_all = 0/net.ipv4.icmp_echo_ignore_all = 1/' /etc/sysctl.conf
sudo sysctl -p}
{type: uploaded file
fileName: metasploitable66VT_4.txt
fullContent:
#!/bin/bash
# Vulnerabilidade 1: TWiki XSS and Command Execution Vulnerabilities
sudo apt-get update
sudo apt-get install -y twiki
sudo twiki --upgrade

# Vulnerabilidade 2: Distributed Ruby (dRuby/DRb) Multiple RCE Vulnerabilities
sudo gem install druby --version ">= 2.0.0"
sudo echo "DRb.start_service(nil, nil, {:safe_level => 3})" >> /etc/druby.conf

# Vulnerabilidade 3: rlogin Passwordless Login
sudo systemctl stop rlogin
sudo systemctl disable rlogin

# Vulnerabilidade 4: Operating System (OS) End of Life (EOL) Detection
sudo do-release-upgrade

# Vulnerabilidade 5: The rexec service is running
sudo systemctl stop rexec
sudo systemctl disable rexec

# Vulnerabilidade 6: Possible Backdoor: Ingreslock
sudo rm -rf /usr/bin/ingreslock

# Vulnerabilidade 7: Apache Tomcat AJP RCE Vulnerability (Ghostcat)
sudo apt-get update
sudo apt-get install -y tomcat9
sudo systemctl restart tomcat9

# Vulnerabilidade 8: MySQL / MariaDB Default Credentials (MySQL Protocol)
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'NewSecurePassword123!';"

# Vulnerabilidade 9: PHP < 5.6.30, 7.x < 7.0.15, 7.1.x < 7.1.1 Multiple Vulnerabilities (Jan 2017)
sudo apt-get update
sudo apt-get install -y php7.4

# Vulnerabilidade 10: PHP < 5.3.13, 5.4.x < 5.4.3 Multiple Vulnerabilities - Active Check
sudo apt-get update
sudo apt-get install -y php7.4

# Vulnerabilidade 11: vsftpd Compromised Source Packages Backdoor Vulnerability
sudo apt-get update
sudo apt-get install -y vsftpd

# Vulnerabilidade 12: vsftpd Compromised Source Packages Backdoor Vulnerability
sudo apt-get update
sudo apt-get install -y vsftpd

# Vulnerabilidade 13: DistCC RCE Vulnerability (CVE-2004-2687)
sudo apt-get update
sudo apt-get install -y distcc

# Vulnerabilidade 14: PostgreSQL Default Credentials (PostgreSQL Protocol)
sudo -u postgres psql -c "ALTER USER postgres WITH PASSWORD 'NewSecurePassword123!';"

# Vulnerabilidade 15: VNC Brute Force Login
sudo vncpasswd -service -set-password NewSecurePassword123!

# Vulnerabilidade 16: Test HTTP dangerous methods
sudo a2disconf httpd-put
sudo systemctl restart apache2

# Vulnerabilidade 17: FTP Brute Force Logins With Default Credentials Reporting
sudo passwd msfadmin
sudo passwd postgres
sudo passwd service
sudo passwd user

# Vulnerabilidade 18: FTP Brute Force Logins With Default Credentials Reporting
sudo passwd msfadmin
sudo passwd postgres
sudo passwd service
sudo passwd user

# Vulnerabilidade 19: The rlogin service is running
sudo systemctl stop rlogin
sudo systemctl disable rlogin

# Vulnerabilidade 20: rsh Unencrypted Cleartext Login
sudo systemctl stop rsh
sudo systemctl disable rsh

# Vulnerabilidade 21: SSL/TLS: OpenSSL CCS Man in the Middle Security Bypass Vulnerability
sudo apt-get update
sudo apt-get install -y openssl

# Vulnerabilidade 22: Multiple Vendors STARTTLS Implementation Plaintext Arbitrary Command Injection Vulnerability
sudo apt-get update
sudo apt-get install postfix

# Vulnerabilidade 23: TWiki Cross-Site Request Forgery Vulnerability (Sep 2010)
sudo apt-get update
sudo apt-get install -y twiki

# Vulnerabilidade 24: Anonymous FTP Login Reporting
sudo sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 25: jQuery < 1.9.0 XSS Vulnerability
sudo wget https://code.jquery.com/jquery-1.9.0.min.js -O /var/www/html/mutillidae/javascript/ddsmoothmenu/jquery.min.js

# Vulnerabilidade 26: TWiki < 6.1.0 XSS Vulnerability
sudo apt-get update
sudo apt-get install -y twiki

# Vulnerabilidade 27: TWiki CSRF Vulnerability
sudo apt-get update
sudo apt-get install -y twiki

# Vulnerabilidade 28: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
sudo sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 29: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
sudo sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 30: SSL/TLS: Report Weak Cipher Suites
sudo sed -i 's/SSLCipherSuite HIGH:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 31: HTTP Debugging Methods (TRACE/TRACK) Enabled
sudo sed -i 's/TraceEnable On/TraceEnable Off/' /etc/apache2/apache2.conf
sudo systemctl restart apache2

# Vulnerabilidade 32: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
sudo openssl req -x509 -newkey rsa:2048 -keyout /etc/ssl/private/server.key -out /etc/ssl/certs/server.crt -days 365 -nodes

# Vulnerabilidade 33: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
sudo openssl req -x509 -newkey rsa:2048 -keyout /etc/ssl/private/server.key -out /etc/ssl/certs/server.crt -days 365 -nodes

# Vulnerabilidade 34: Weak Key Exchange (KEX) Algorithm(s) Supported (SSH)
sudo sed -i 's/#KexAlgorithms curve25519-sha256,KexAlgorithms curve25519-sha256/' /etc/ssh/sshd_config
sudo systemctl restart ssh

# Vulnerabilidade 35: phpinfo() Output Reporting (HTTP)
sudo rm /var/www/html/mutillidae/phpinfo.php
sudo rm /var/www/html/phpinfo.php

# Vulnerabilidade 36: Weak Host Key Algorithm(s) (SSH)
sudo sed -i 's/HostKeyAlgorithms ssh-rsa/HostKeyAlgorithms ssh-ed25519/' /etc/ssh/sshd_config
sudo systemctl restart ssh

# Vulnerabilidade 37: Check if Mailserver answer to VRFY and EXPN requests
sudo sed -i 's/smtpd_discard_ehlo_keywords =$/smtpd_discard_ehlo_keywords = vrfy,expn/' /etc/postfix/main.cf
sudo systemctl restart postfix

# Vulnerabilidade 38: SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
sudo sed -i 's/SSLHonorCipherOrder On/SSLHonorCipherOrder Off/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 39: SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
sudo sed -i 's/SSLHonorCipherOrder On/SSLHonorCipherOrder Off/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 40: SSL/TLS: Certificate Expired
sudo openssl req -x509 -newkey rsa:2048 -keyout /etc/ssl/private/server.key -out /etc/ssl/certs/server.crt -days 365 -nodes

# Vulnerabilidade 41: SSL/TLS: Certificate Expired
sudo openssl req -x509 -newkey rsa:2048 -keyout /etc/ssl/private/server.key -out /etc/ssl/certs/server.crt -days 365 -nodes

# Vulnerabilidade 42: QWikiwiki directory traversal vulnerability
sudo rm -rf /var/www/html/mutillidae

# Vulnerabilidade 43: awiki <= 20100125 Multiple LFI Vulnerabilities - Active Check
sudo rm -rf /var/www/html/mutillidae

# Vulnerabilidade 44: /doc directory browsable
sudo sed -i 's/Alias \/doc/##Alias \/doc/' /etc/apache2/mods-enabled/alias.conf
sudo systemctl restart apache2

# Vulnerabilidade 45: Telnet Unencrypted Cleartext Login
sudo systemctl stop telnet
sudo systemctl disable telnet

# Vulnerabilidade 46: FTP Unencrypted Cleartext Login
sudo sed -i 's/passive_mode=NO/passive_mode=YES/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 47: VNC Server Unencrypted Data Transmission
sudo vncpasswd -service -set-password NewSecurePassword123!

# Vulnerabilidade 48: FTP Unencrypted Cleartext Login
sudo sed -i 's/passive_mode=NO/passive_mode=YES/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 49: Cleartext Transmission of Sensitive Information via HTTP
sudo a2enmod ssl
sudo systemctl restart apache2

# Vulnerabilidade 50: SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
sudo sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 51: Weak Encryption Algorithm(s) Supported (SSH)
sudo sed -i 's/Ciphers aes128-ctr,aes192-ctr,aes256-ctr/Ciphers chacha20-poly1305@openssh.com/' /etc/ssh/sshd_config
sudo systemctl restart ssh

# Vulnerabilidade 52: Apache HTTP Server httpOnly Cookie Information Disclosure Vulnerability
sudo sed -i 's/#HttpOnlyCookie/HttpOnlyCookie/' /etc/apache2/conf-enabled/security.conf
sudo systemctl restart apache2

# Vulnerabilidade 53: phpMyAdmin error.php Cross Site Scripting Vulnerability
sudo apt-get update
sudo apt-get install -y phpmyadmin

# Vulnerabilidade 54: SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
sudo sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 55: jQuery < 1.6.3 XSS Vulnerability
sudo wget https://code.jquery.com/jquery-1.6.3.min.js -O /var/www/html/mutillidae/javascript/ddsmoothmenu/jquery.min.js

# Vulnerabilidade 56: SSL/TLS: RSA Temporary Key Handling RSA_EXPORT Downgrade Issue (FREAK)
sudo sed -i 's/SSLCipherSuite HIGH:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 57: SSL/TLS: Certificate Signed Using A Weak Signature Algorithm
sudo openssl req -x509 -newkey rsa:2048 -keyout /etc/ssl/private/server.key -out /etc/ssl/certs/server.crt -days 365 -nodes

# Vulnerabilidade 58: SSL/TLS: Diffie-Hellman Key Exchange Insufficient DH Group Strength Vulnerability
sudo sed -i 's/#SSLCipherSuite HIGH:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!DHE/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 59: SSL/TLS: Diffie-Hellman Key Exchange Insufficient DH Group Strength Vulnerability
sudo sed -i 's/#SSLCipherSuite HIGH:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!DHE/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 60: SSL/TLS: Certificate Signed Using A Weak Signature Algorithm
sudo openssl req -x509 -newkey rsa:2048 -keyout /etc/ssl/private/server.key -out /etc/ssl/certs/server.crt -days 365 -nodes

# Vulnerabilidade 61: SSL/TLS: DHE_EXPORT MITM Security Bypass Vulnerability (LogJam)
sudo sed -i 's/SSLCipherSuite HIGH:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!DHE/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 62: SSL/TLS: SSLv3 Protocol CBC Cipher Suites Information Disclosure Vulnerability (POODLE)
sudo sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 63: SSL/TLS: SSLv3 Protocol CBC Cipher Suites Information Disclosure Vulnerability (POODLE)
sudo sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 64: Weak MAC Algorithm(s) Supported (SSH)
sudo sed -i 's/MACs hmac-sha1/MACs hmac-sha2-256/' /etc/ssh/sshd_config
sudo systemctl restart ssh

# Vulnerabilidade 65: TCP Timestamps Information Disclosure
sudo sysctl -w net.ipv4.tcp_timestamps=0

# Vulnerabilidade 66: ICMP Timestamp Reply Information Disclosure
sudo sysctl -w net.ipv4.icmp_echo_ignore_all=1}
{type: uploaded file
fileName: metasploitable66VT_5.txt
fullContent:
#!/bin/bash
# Correção das vulnerabilidades

# Desabilitar serviços inseguros
systemctl stop rlogin.service
systemctl disable rlogin.service
systemctl stop rsh.service
systemctl disable rsh.service
systemctl stop rexec.service
systemctl disable rexec.service
systemctl stop telnet.service
systemctl disable telnet.service

# Instalar/reinstalar vsftpd seguro
apt-get update
apt-get install --only-upgrade vsftpd -y

# Atualizar o sistema operacional
apt-get dist-upgrade -y

# Atualizar pacotes de software
apt-get update
apt-get upgrade -y

# Configurar MySQL para não aceitar login root sem senha
mysql -e "ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'NovaSenhaSegura123!';"

# Atualizar Apache Tomcat para versão segura
tomcat_version=$(/usr/share/tomcat/bin/version.sh | grep 'Server version' | awk '{print $3}' | cut -d'/' -f2)
if [[ "$tomcat_version" < "9.0.31" ]]; then
    apt-get remove --purge -y tomcat9
    apt-get install tomcat9 -y
fi

# Configurar PHP para versão segura
php_version=$(php -v | grep 'PHP' | awk '{print $2}' | cut -d'.' -f1-2)
if [[ "$php_version" < "7.0" ]]; then
    apt-get remove --purge -y php php*
    apt-get install php7.4 -y
fi

# Atualizar jQuery para versão segura
jquery_version=$(find /var/www/html -name 'jquery.min.js' -exec grep -oP 'jQuery v\K\d+\.\d+\.\d+' {} + | head -n 1)
if [[ "$jquery_version" < "1.9.0" ]]; then
    wget -O /var/www/html/jquery.min.js https://code.jquery.com/jquery-1.9.0.min.js
fi

# Configurar SSL/TLS seguro
sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/g' /etc/apache2/mods-enabled/ssl.conf
sed -i 's/SSLCipherSuite HIGH:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4:!3DES/g' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Configurar PostgreSQL para não aceitar senha fraca
psql -U postgres -c "ALTER USER postgres WITH PASSWORD 'NovaSenhaSegura123!';"

# Configurar VNC para usar criptografia
apt-get install tightvncserver -y

# Configurar SSH para usar cifras seguras
sed -i 's/Ciphers .*/Ciphers aes256-ctr/g' /etc/ssh/sshd_config
systemctl restart sshd

# Configurar Firewall para bloquear portas inseguras
ufw deny 21
ufw deny 23
ufw deny 513
ufw deny 514
ufw deny 512
ufw deny 3632
ufw deny 6200
ufw deny 8787

# Verificar e aplicar configurações de segurança
apt-get install unattended-upgrades -y
dpkg-reconfigure --priority=low unattended-upgrades

# Reiniciar serviços necessários
systemctl restart apache2
systemctl restart mysql
systemctl restart postgresql
systemctl restart tomcat9
systemctl restart sshd

exit 0}
{type: uploaded file
fileName: metasploitable66VT_6.txt
fullContent:
#!/bin/bash

# Disable rlogin and rsh services
systemctl stop rlogin 2>/dev/null
systemctl disable rlogin 2>/dev/null
systemctl stop rsh 2>/dev/null
systemctl disable rsh 2>/dev/null

# Stop and disable VNC server
systemctl stop vncserver 2>/dev/null
systemctl disable vncserver 2>/dev/null

# Disable rexec service
systemctl stop rexec 2>/dev/null
systemctl disable rexec 2>/dev/null

# Disable DRb service
systemctl stop drb 2>/dev/null
systemctl disable drb 2>/dev/null

# Disable FTP anonymous login
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
systemctl restart vsftpd 2>/dev/null

# Disable insecure HTTP methods
if [ -f /etc/apache2/apache2.conf ]; then
    echo "<Directory /var/www/html>
    AllowMethods GET POST
    </Directory>" >> /etc/apache2/apache2.conf
    systemctl restart apache2 2>/dev/null
fi

# Disable TRACE and TRACK methods in Apache
if [ -f /etc/apache2/apache2.conf ]; then
    echo "TraceEnable Off" >> /etc/apache2/apache2.conf
    systemctl restart apache2 2>/dev/null
fi

# Disable SSLv3 and TLSv1.0 in Apache
if [ -f /etc/apache2/mods-available/ssl.conf ]; then
    sed -i 's/SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1/SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1/' /etc/apache2/mods-available/ssl.conf
    systemctl restart apache2 2>/dev/null
fi

# Disable weak ciphers in Apache
if [ -f /etc/apache2/mods-available/ssl.conf ]; then
    sed -i 's/SSLCipherSuite HIGH:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4:!3DES/' /etc/apache2/mods-available/ssl.conf
    systemctl restart apache2 2>/dev/null
fi

# Disable VRFY and EXPN in Postfix
if [ -f /etc/postfix/main.cf ]; then
    echo "disable_vrfy_command = yes" >> /etc/postfix/main.cf
    systemctl restart postfix 2>/dev/null
fi

# Disable weak SSH encryption algorithms
if [ -f /etc/ssh/sshd_config ]; then
    echo "Ciphers aes256-ctr,aes192-ctr,aes128-ctr" >> /etc/ssh/sshd_config
    echo "MACs hmac-sha2-512,hmac-sha2-256" >> /etc/ssh/sshd_config
    echo "KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256" >> /etc/ssh/sshd_config
    systemctl restart sshd 2>/dev/null
fi

# Disable TCP timestamps
echo "net.ipv4.tcp_timestamps = 0" >> /etc/sysctl.conf
sysctl -p

# Disable ICMP timestamp replies
echo "1" > /proc/sys/net/ipv4/icmp_echo_ignore_all

# Disable PHP info exposure
find /var/www/html -name "phpinfo.php" -exec rm -f {} \;

# Disable directory browsing in Apache
if [ -f /etc/apache2/apache2.conf ]; then
    echo "<Directory /var/www/html>
    Options -Indexes
    </Directory>" >> /etc/apache2/apache2.conf
    systemctl restart apache2 2>/dev/null
fi}
{type: uploaded file
fileName: metasploitable66VT_7.txt
fullContent:
#!/bin/bash

# Corrigir vulnerabilidades no TWiki
wget https://github.com/TWiki/twiki/archive/refs/tags/v4.2.4.tar.gz -O /tmp/twiki-4.2.4.tar.gz
tar -xzf /tmp/twiki-4.2.4.tar.gz -C /opt/
rm -rf /opt/twiki
mv /opt/twiki-4.2.4 /opt/twiki
chown -R www-data:www-data /opt/twiki

# Desativar o serviço rlogin
systemctl stop rlogin.socket
systemctl disable rlogin.socket

# Atualizar o sistema operacional
export DEBIAN_FRONTEND=noninteractive
apt-get update
apt-get dist-upgrade -y

# Desativar o serviço rexec
systemctl stop rexec.socket
systemctl disable rexec.socket

# Corrigir vulnerabilidade do Apache Tomcat Ghostcat
systemctl stop tomcat
wget https://downloads.apache.org/tomcat/tomcat-8/v8.5.51/bin/apache-tomcat-8.5.51.tar.gz -O /tmp/apache-tomcat-8.5.51.tar.gz
tar -xzf /tmp/apache-tomcat-8.5.51.tar.gz -C /opt/
rm -rf /opt/tomcat
mv /opt/apache-tomcat-8.5.51 /opt/tomcat
chown -R tomcat:tomcat /opt/tomcat
systemctl start tomcat

# Alterar senha padrão do MySQL
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'NovaSenhaSegura123!';"

# Atualizar o PHP
apt-get install -y php7.4 php7.4-cli php7.4-common php7.4-curl php7.4-gd php7.4-json php7.4-mbstring php7.4-mysql php7.4-xml php7.4-zip
systemctl restart apache2

# Desativar métodos HTTP perigosos
sed -i 's/AllowOverride None/AllowOverride None\n    <LimitExcept GET POST>\n        Deny from all\n    <\/LimitExcept>/' /etc/apache2/apache2.conf
systemctl restart apache2

# Desativar o serviço VNC
systemctl stop vncserver-x11-serviced
systemctl disable vncserver-x11-serviced

# Corrigir vulnerabilidade do vsftpd
systemctl stop vsftpd
wget https://security.debian.org/pool/updates/main/v/vsftpd/vsftpd_3.0.3-12+deb10u1_amd64.deb -O /tmp/vsftpd.deb
dpkg -i /tmp/vsftpd.deb
systemctl start vsftpd

# Desativar o serviço Telnet
systemctl stop telnet.socket
systemctl disable telnet.socket

# Configurar SSL/TLS para desativar protocolos inseguros
sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/g' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Desativar FTP anônimo
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
systemctl restart vsftpd

# Reiniciar serviços críticos
systemctl restart apache2
systemctl restart mysql
systemctl restart ssh}
{type: uploaded file
fileName: metasploitable66VT_8.txt
fullContent:
#!/bin/bash
# Script para corrigir as vulnerabilidades identificadas

# 1. Atualizar TWiki para a versão 4.2.4 ou superior
wget https://twiki.org/p/pub/Codev/ReleaseHistoryTWiki/TWiki-4.2.4.zip
unzip TWiki-4.2.4.zip -d /var/www/html/twiki
chown -R www-data:www-data /var/www/html/twiki
rm TWiki-4.2.4.zip

# 2. Configurar $SAFE level para >= 2 em sistemas Ruby
echo "$SAFE = 2" >> /etc/ruby/config

# 3. Desabilitar o serviço rlogin
systemctl stop rlogin
systemctl disable rlogin

# 4. Atualizar o sistema operacional Ubuntu 8.04 para uma versão suportada
do-release-upgrade

# 5. Desabilitar o serviço rexec
systemctl stop rexec
systemctl disable rexec

# 6. Remover backdoor Ingreslock
rm -rf /usr/bin/ingreslock

# 7. Atualizar Apache Tomcat para a versão 7.0.100, 8.5.51 ou 9.0.31
wget https://downloads.apache.org/tomcat/tomcat-9/v9.0.31/bin/apache-tomcat-9.0.31.tar.gz
tar -xzf apache-tomcat-9.0.31.tar.gz -C /opt
chown -R tomcat:tomcat /opt/apache-tomcat-9.0.31
rm apache-tomcat-9.0.31.tar.gz

# 8. Alterar senha padrão do MySQL
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'NovaSenhaSegura';"

# 9. Atualizar PHP para a versão 5.6.30 ou superior
apt-get update
apt-get install php5.6

# 10. Desabilitar métodos HTTP perigosos (PUT/DELETE)
sed -i 's/AllowOverride None/AllowOverride None\n    <Limit PUT DELETE>\n        Order deny,allow\n        Deny from all\n    </Limit>/' /etc/apache2/apache2.conf
systemctl restart apache2}
{type: uploaded file
fileName: metasploitable66VT_9.txt
fullContent:
#!/bin/bash

# Vulnerabilidade 1
sudo apt-get update
sudo apt-get install -y twiki=4.2.4

# Vulnerabilidade 3
sudo systemctl stop rlogin
sudo systemctl disable rlogin

# Vulnerabilidade 4
sudo do-release-upgrade

# Vulnerabilidade 5
sudo systemctl stop rexec
sudo systemctl disable rexec

# Vulnerabilidade 6
sudo mv /usr/sbin/ingreslock /usr/sbin/ingreslock.bak

# Vulnerabilidade 7
sudo systemctl stop tomcat
sudo apt-get update
sudo apt-get install -y tomcat9

# Vulnerabilidade 8
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'StrongPassword123!';"

# Vulnerabilidade 9
sudo apt-get update
sudo apt-get install -y php7.2

# Vulnerabilidade 11
sudo apt-get update
sudo apt-get install -y vsftpd

# Vulnerabilidade 12
sudo apt-get update
sudo apt-get install -y vsftpd

# Vulnerabilidade 13
sudo systemctl stop distcc
sudo systemctl disable distcc

# Vulnerabilidade 14
sudo -u postgres psql -c "ALTER USER postgres WITH PASSWORD 'StrongPassword123!';"

# Vulnerabilidade 15
vncpasswd

# Vulnerabilidade 16
sudo a2dismod dav
sudo systemctl restart apache2

# Vulnerabilidade 17
sudo passwd msfadmin
sudo passwd postgres
sudo passwd service
sudo passwd user

# Vulnerabilidade 19
sudo systemctl stop rlogin
sudo systemctl disable rlogin

# Vulnerabilidade 20
sudo systemctl stop rsh
sudo systemctl disable rsh

# Vulnerabilidade 21
sudo apt-get update
sudo apt-get install -y openssl

# Vulnerabilidade 23
sudo apt-get update
sudo apt-get install -y twiki=4.3.2

# Vulnerabilidade 24
sudo apt-get update
sudo apt-get install -y vsftpd
sudo sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 25
wget https://code.jquery.com/jquery-1.9.0.min.js -O /var/www/html/mutillidae/javascript/ddsmoothmenu/jquery.min.js

# Vulnerabilidade 26
sudo apt-get update
sudo apt-get install -y twiki=6.1.0

# Vulnerabilidade 27
sudo apt-get update
sudo apt-get install -y twiki=4.3.1

# Vulnerabilidade 28
sudo sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 29
sudo sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 30
sudo sed -i 's/SSLCipherSuite HIGH:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 31
sudo sed -i 's/TraceEnable On/TraceEnable Off/' /etc/apache2/apache2.conf
sudo systemctl restart apache2

# Vulnerabilidade 32
openssl req -newkey rsa:4096 -nodes -keyout /etc/ssl/private/ssl-cert-snakeoil.key -x509 -days 365 -out /etc/ssl/certs/ssl-cert-snakeoil.pem -subj "/CN=example.com"

# Vulnerabilidade 33
openssl req -newkey rsa:4096 -nodes -keyout /etc/ssl/private/ssl-cert-snakeoil.key -x509 -days 365 -out /etc/ssl/certs/ssl-cert-snakeoil.pem -subj "/CN=example.com"

# Vulnerabilidade 34
sudo sed -i 's/KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256/KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521/' /etc/ssh/sshd_config
sudo systemctl restart sshd

# Vulnerabilidade 35
sudo rm /var/www/html/mutillidae/phpinfo.php
sudo rm /var/www/html/phpinfo.php

# Vulnerabilidade 36
sudo sed -i 's/HostKeyAlgorithms ssh-rsa,ssh-dss/HostKeyAlgorithms ssh-rsa/' /etc/ssh/sshd_config
sudo systemctl restart sshd

# Vulnerabilidade 37
sudo sed -i 's/smtpd_vrfy_command=yes/smtpd_vrfy_command=no/' /etc/postfix/main.cf
sudo systemctl restart postfix

# Vulnerabilidade 38
sudo sed -i 's/SSLHonorCipherOrder on/SSLHonorCipherOrder on,SSLInsecureRenegotiation off/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 39
sudo sed -i 's/SSLHonorCipherOrder on/SSLHonorCipherOrder on,SSLInsecureRenegotiation off/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 40
openssl req -newkey rsa:4096 -nodes -keyout /etc/ssl/private/ssl-cert-snakeoil.key -x509 -days 365 -out /etc/ssl/certs/ssl-cert-snakeoil.pem -subj "/CN=example.com"

# Vulnerabilidade 41
openssl req -newkey rsa:4096 -nodes -keyout /etc/ssl/private/ssl-cert-snakeoil.key -x509 -days 365 -out /etc/ssl/certs/ssl-cert-snakeoil.pem -subj "/CN=example.com"

# Vulnerabilidade 42
sudo rm /var/www/html/mutillidae/index.php

# Vulnerabilidade 43
sudo rm /var/www/html/mutillidae/index.php

# Vulnerabilidade 44
sudo chmod 750 /usr/doc

# Vulnerabilidade 45
sudo systemctl stop telnet
sudo systemctl disable telnet

# Vulnerabilidade 46
sudo sed -i 's/#force_local_logins_ssl=no/force_local_logins_ssl=yes/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 47
sudo apt-get update
sudo apt-get install -y tightvncserver

# Vulnerabilidade 48
sudo sed -i 's/#force_local_logins_ssl=no/force_local_logins_ssl=yes/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 49
sudo a2enmod ssl
sudo a2ensite default-ssl
sudo systemctl restart apache2

# Vulnerabilidade 50
sudo sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 51
sudo sed -i 's/Ciphers aes128-ctr,aes192-ctr,aes256-ctr/Ciphers aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com/' /etc/ssh/sshd_config
sudo systemctl restart sshd

# Vulnerabilidade 52
sudo apt-get update
sudo apt-get install -y apache2

# Vulnerabilidade 53
sudo rm /var/www/html/phpMyAdmin/error.php

# Vulnerabilidade 54
sudo sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 55
wget https://code.jquery.com/jquery-1.9.0.min.js -O /var/www/html/mutillidae/javascript/ddsmoothmenu/jquery.min.js

# Vulnerabilidade 56
sudo sed -i 's/SSLCipherSuite HIGH:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4:!DES:!3DES/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 57
openssl req -newkey rsa:4096 -nodes -keyout /etc/ssl/private/ssl-cert-snakeoil.key -x509 -days 365 -out /etc/ssl/certs/ssl-cert-snakeoil.pem -subj "/CN=example.com"

# Vulnerabilidade 58
sudo sed -i 's/SSLHonorCipherOrder on/SSLHonorCipherOrder on,SSLOptions +StrictRequire/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 59
sudo sed -i 's/SSLHonorCipherOrder on/SSLHonorCipherOrder on,SSLOptions +StrictRequire/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 60
openssl req -newkey rsa:4096 -nodes -keyout /etc/ssl/private/ssl-cert-snakeoil.key -x509 -days 365 -out /etc/ssl/certs/ssl-cert-snakeoil.pem -subj "/CN=example.com"

# Vulnerabilidade 61
sudo sed -i 's/SSLCipherSuite HIGH:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4:!DES:!3DES/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 62
sudo sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 63
sudo sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 64
sudo sed -i 's/MACs hmac-sha1,umac-64@openssh.com/MACs hmac-sha2-256,hmac-sha2-512/' /etc/ssh/sshd_config
sudo systemctl restart sshd

# Vulnerabilidade 65
sudo sysctl -w net.ipv4.tcp_timestamps=0

# Vulnerabilidade 66
sudo sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1}
{type: uploaded file
fileName: metasploitable66VT_10.txt
fullContent:
#!/bin/bash
# Vulnerabilidade 1: TWiki XSS and Command Execution Vulnerabilities
wget -O /tmp/twiki-latest.tar.gz https://sourceforge.net/projects/twiki/files/latest/download
tar -xzf /tmp/twiki-latest.tar.gz -C /opt/
rm /tmp/twiki-latest.tar.gz
chown -R www-data:www-data /opt/twiki

# Vulnerabilidade 2: Distributed Ruby (dRuby/DRb) Multiple RCE Vulnerabilities
echo "Setting \$SAFE level to 2 for dRuby"
export DRbSAFE=2

# Vulnerabilidade 3: rlogin Passwordless Login
systemctl disable rlogin.socket
systemctl stop rlogin.socket

# Vulnerabilidade 4: Operating System (OS) End of Life (EOL) Detection
echo "Updating Ubuntu OS"
apt-get update
apt-get -y dist-upgrade

# Vulnerabilidade 5: The rexec service is running
systemctl disable rexec.socket
systemctl stop rexec.socket

# Vulnerabilidade 6: Possible Backdoor: Ingreslock
systemctl stop ingreslock
systemctl disable ingreslock
rm -f /etc/init.d/ingreslock

# Vulnerabilidade 7: Apache Tomcat AJP RCE Vulnerability (Ghostcat)
wget -O /tmp/tomcat-latest.tar.gz https://downloads.apache.org/tomcat/tomcat-9/v9.0.31/bin/apache-tomcat-9.0.31.tar.gz
tar -xzf /tmp/tomcat-latest.tar.gz -C /opt/
rm /tmp/tomcat-latest.tar.gz
chown -R tomcat:tomcat /opt/apache-tomcat-9.0.31

# Vulnerabilidade 8: MySQL / MariaDB Default Credentials (MySQL Protocol)
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'NewStrongPassword123!';"

# Vulnerabilidade 9: PHP < 5.6.30, 7.x < 7.0.15, 7.1.x < 7.1.1 Multiple Vulnerabilities (Jan 2017) - Linux
apt-get install -y php7.0

# Vulnerabilidade 10: PHP < 5.3.13, 5.4.x < 5.4.3 Multiple Vulnerabilities - Active Check
apt-get install -y php5.6

# Vulnerabilidade 11: vsftpd Compromised Source Packages Backdoor Vulnerability
apt-get remove -y vsftpd
apt-get install -y vsftpd

# Vulnerabilidade 12: vsftpd Compromised Source Packages Backdoor Vulnerability
apt-get remove -y vsftpd
apt-get install -y vsftpd

# Vulnerabilidade 13: DistCC RCE Vulnerability (CVE-2004-2687)
systemctl stop distcc
systemctl disable distcc
apt-get remove -y distcc

# Vulnerabilidade 14: PostgreSQL Default Credentials (PostgreSQL Protocol)
sudo -u postgres psql -c "ALTER USER postgres WITH PASSWORD 'NewStrongPassword123!';"

# Vulnerabilidade 15: VNC Brute Force Login
vncpasswd /etc/vncpasswd

# Vulnerabilidade 16: Test HTTP dangerous methods
a2dismod include

# Vulnerabilidade 17: FTP Brute Force Logins With Default Credentials Reporting
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
systemctl restart vsftpd

# Vulnerabilidade 18: FTP Brute Force Logins With Default Credentials Reporting
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
systemctl restart vsftpd

# Vulnerabilidade 19: The rlogin service is running
systemctl disable rlogin.socket
systemctl stop rlogin.socket

# Vulnerabilidade 20: rsh Unencrypted Cleartext Login
systemctl disable rsh.socket
systemctl stop rsh.socket

# Vulnerabilidade 21: SSL/TLS: OpenSSL CCS Man in the Middle Security Bypass Vulnerability
apt-get install -y openssl

# Vulnerabilidade 22: Multiple Vendors STARTTLS Implementation Plaintext Arbitrary Command Injection Vulnerability
postconf -e smtpd_tls_security_level=may
postfix reload

# Vulnerabilidade 23: TWiki Cross-Site Request Forgery Vulnerability (Sep 2010)
wget -O /tmp/twiki-latest.tar.gz https://sourceforge.net/projects/twiki/files/latest/download
tar -xzf /tmp/twiki-latest.tar.gz -C /opt/
rm /tmp/twiki-latest.tar.gz
chown -R www-data:www-data /opt/twiki

# Vulnerabilidade 24: Anonymous FTP Login Reporting
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
systemctl restart vsftpd

# Vulnerabilidade 25: jQuery < 1.9.0 XSS Vulnerability
wget -O /var/www/html/mutillidae/javascript/ddsmoothmenu/jquery.min.js https://code.jquery.com/jquery-1.9.0.min.js

# Vulnerabilidade 26: TWiki < 6.1.0 XSS Vulnerability
wget -O /tmp/twiki-latest.tar.gz https://sourceforge.net/projects/twiki/files/latest/download
tar -xzf /tmp/twiki-latest.tar.gz -C /opt/
rm /tmp/twiki-latest.tar.gz
chown -R www-data:www-data /opt/twiki

# Vulnerabilidade 27: TWiki CSRF Vulnerability
wget -O /tmp/twiki-latest.tar.gz https://sourceforge.net/projects/twiki/files/latest/download
tar -xzf /tmp/twiki-latest.tar.gz -C /opt/
rm /tmp/twiki-latest.tar.gz
chown -R www-data:www-data /opt/twiki

# Vulnerabilidade 28: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
a2enmod ssl
a2ensite default-ssl
systemctl restart apache2

# Vulnerabilidade 29: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
a2enmod ssl
a2ensite default-ssl
systemctl restart apache2

# Vulnerabilidade 30: SSL/TLS: Report Weak Cipher Suites
a2enmod ssl
a2ensite default-ssl
systemctl restart apache2

# Vulnerabilidade 31: HTTP Debugging Methods (TRACE/TRACK) Enabled
a2dismod include

# Vulnerabilidade 32: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 33: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
openssl req -x509 -nodes -days 365 -newkey rsa:204}
{type: uploaded file
fileName: metasploitable66VT_11.txt
fullContent:
#!/bin/bash
# Verifica se o script está sendo executado como root
if [ "$EUID" -ne 0 ]; then
  echo "Por favor, execute como root."
  exit 1
fi

# Atualiza o TWiki para a versão 4.2.4 ou superior
apt-get update
apt-get install -y twiki

# Configura o Distributed Ruby (dRuby/DRb) para usar $SAFE >= 2
echo "$SAFE >= 2" >> /etc/drb.conf

# Desabilita o serviço rlogin
systemctl stop rlogin
systemctl disable rlogin

# Atualiza o sistema operacional para uma versão suportada
apt-get update
apt-get dist-upgrade -y

# Desabilita o serviço rexec
systemctl stop rexec
systemctl disable rexec

# Limpa o sistema para remover possíveis backdoors usando Ingreslock
apt-get remove --purge ingreslock
find / -name ingreslock -exec rm -f {} \;

# Atualiza o Apache Tomcat para a versão 7.0.100, 8.5.51 ou 9.0.31
apt-get update
apt-get install -y tomcat9

# Altera a senha padrão do MySQL
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'nova_senha_forte'; FLUSH PRIVILEGES;"

# Atualiza o PHP para a versão 5.6.30 ou superior
apt-get update
apt-get install -y php5.6

# Desabilita os métodos HTTP PERIGOSOS (PUT e DELETE) no Apache
sed -i 's/AllowOverride None/AllowOverride None\n    <LimitExcept GET POST>\n        deny from all\n    <\/LimitExcept>/' /etc/apache2/apache2.conf
systemctl restart apache2

# Desabilita o serviço vsftpd e remove o pacote
systemctl stop vsftpd
systemctl disable vsftpd
apt-get remove --purge vsftpd

# Desabilita o serviço distcc
systemctl stop distcc
systemctl disable distcc

# Changed PostgreSQL Password
sudo -u postgres psql -c "ALTER USER postgres WITH PASSWORD 'nova_senha_forte';"

# Disable VNC Brute Force Login
systemctl stop vncserver
systemctl disable vncserver

# Desabilita FTP Brute Force Logins With Default Credentials
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
systemctl restart vsftpd

# Desabilita o serviço telnet
systemctl stop telnet
systemctl disable telnet

# Desabilita o serviço FTP Unencrypted Cleartext Login
sed -i 's/ssl_enable=NO/ssl_enable=YES/' /etc/vsftpd.conf
systemctl restart vsftpd

# Desabilita o serviço VNC Server Unencrypted Data Transmission
systemctl stop vncserver
systemctl disable vncserver

# Enforce SSL/TLS for Sensitive Information Transmission
a2enmod ssl
systemctl restart apache2

# Disable Weak Encryption Algorithm(s) Supported (SSH)
echo "Ciphers aes128-ctr,aes192-ctr,aes256-ctr" >> /etc/ssh/sshd_config
systemctl restart sshd

# Disable Weak MAC Algorithm(s) Supported (SSH)
echo "MACs hmac-sha2-256,hmac-sha2-512" >> /etc/ssh/sshd_config
systemctl restart sshd

# Disable Weak Key Exchange (KEX) Algorithm(s) Supported (SSH)
echo "KexAlgorithms curve25519-sha256@libssh.org" >> /etc/ssh/sshd_config
systemctl restart sshd

# Disable SSLv3 and TLSv1.0 protocols on Apache
sed -i 's/SSLProtocol all/SSLProtocol -all +TLSv1.2 +TLSv1.3/' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Disable SSLv3 and TLSv1.0 protocols on Postfix
postconf -e "smtpd_tls_protocols = !SSLv2, !SSLv3"
systemctl restart postfix

# Disable SSLv3 and TLSv1.0 protocols on PostgreSQL
sed -i 's/ssl_min_protocol_version = '\'TLSv1\''/ssl_min_protocol_version = '\'TLSv1.2\''/' /etc/postgresql/*/main/postgresql.conf
systemctl restart postgresql

exit 0}
{type: uploaded file
fileName: metasploitable66VT_12.txt
fullContent:
```bash
#!/bin/bash

# Desabilitar o serviço rlogin
systemctl stop rlogin
systemctl disable rlogin

# Atualizar o TWiki para a versão 4.2.4 ou posterior
wget https://downloads.sourceforge.net/project/twiki/TWiki/4.2.4/twiki-4.2.4.tgz -O /tmp/twiki-4.2.4.tgz
tar -xzf /tmp/twiki-4.2.4.tgz -C /opt/
rm /tmp/twiki-4.2.4.tgz

# Configurar dRuby para usar $SAFE >= 2
echo "$SAFE=2" >> /etc/drb/drb.conf

# Desabilitar o serviço rexec
systemctl stop rexec
systemctl disable rexec

# Desabilitar o serviço rsh
systemctl stop rsh
systemctl disable rsh

# Atualizar o Apache Tomcat para a versão 7.0.100, 8.5.51 ou 9.0.31
wget https://downloads.apache.org/tomcat/tomcat-9/v9.0.31/bin/apache-tomcat-9.0.31.tar.gz -O /tmp/apache-tomcat-9.0.31.tar.gz
tar -xzf /tmp/apache-tomcat-9.0.31.tar.gz -C /opt/
rm /tmp/apache-tomcat-9.0.31.tar.gz

# Alterar senha do MySQL
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'nova_senha_segura';"

# Atualizar o PHP para a versão 5.6.30
add-apt-repository ppa:ondrej/php -y
apt-get update
apt-get install php5.6 -y

# Desabilitar métodos HTTP perigosos (PUT, DELETE)
sed -i 's/AllowMethods\s\+GET\s\+POST\s\+HEAD/AllowMethods GET POST HEAD/' /etc/apache2/apache2.conf

# Desabilitar o serviço VNC
systemctl stop vncserver
systemctl disable vncserver

# Desabilitar o serviço FTP
systemctl stop vsftpd
systemctl disable vsftpd

# Remover arquivos de saída do phpinfo()
find /var/www/html -name "phpinfo.php" -exec rm -f {} \;

# Desabilitar TRACE e TRACK no Apache
echo "TraceEnable off" >> /etc/apache2/apache2.conf

# Desabilitar SSLv3 e TLSv1.0
sed -i 's/SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1 -TLSv1.2/SSLProtocol +TLSv1.2 +TLSv1.3/' /etc/apache2/mods-enabled/ssl.conf

# Desabilitar TCP timestamps
echo "net.ipv4.tcp_timestamps = 0" >> /etc/sysctl.conf
sysctl -p

# Desabilitar ICMP timestamp replies
iptables -A INPUT -p icmp --icmp-type timestamp-request -j DROP
iptables -A OUTPUT -p icmp --icmp-type timestamp-reply -j DROP

# Reiniciar serviços afetados
systemctl restart apache2
systemctl restart mysql
```}
{type: uploaded file
fileName: metasploitable66VT_13.txt
fullContent:
#!/bin/bash

# Vulnerabilidade 1: TWiki XSS and Command Execution Vulnerabilities (CVE-2008-5304, CVE-2008-5305)
wget https://twiki.org/cgi-bin/view/Codev/ReleaseNote4d2d4 -O /tmp/twiki-4.2.4.tar.gz
tar -xzf /tmp/twiki-4.2.4.tar.gz -C /opt/
rm /tmp/twiki-4.2.4.tar.gz

# Vulnerabilidade 3: rlogin Passwordless Login
systemctl disable rlogin.socket
systemctl stop rlogin.socket

# Vulnerabilidade 4: Operating System (OS) End of Life (EOL) Detection
apt-get update
apt-get dist-upgrade -y
do-release-upgrade

# Vulnerabilidade 5: The rexec service is running (CVE-1999-0618)
systemctl disable rexec.socket
systemctl stop rexec.socket

# Vulnerabilidade 6: Possible Backdoor: Ingreslock
killall -9 ingreslock
rm /usr/sbin/ingreslock

# Vulnerabilidade 7: Apache Tomcat AJP RCE Vulnerability (CVE-2020-1938)
wget https://downloads.apache.org/tomcat/tomcat-9/v9.0.31/bin/apache-tomcat-9.0.31.tar.gz -O /tmp/tomcat-9.0.31.tar.gz
tar -xzf /tmp/tomcat-9.0.31.tar.gz -C /opt/
rm /tmp/tomcat-9.0.31.tar.gz

# Vulnerabilidade 8: MySQL / MariaDB Default Credentials (CVE-2015-4669, etc.)
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'StrongPassword123!';"

# Vulnerabilidade 9: PHP < 5.6.30, 7.x < 7.0.15, 7.1.x < 7.1.1 Multiple Vulnerabilities (Jan 2017)
apt-get install php7.4 -y

# Vulnerabilidade 10: PHP < 5.3.13, 5.4.x < 5.4.3 Multiple Vulnerabilities - Active Check
apt-get install php7.4 -y

# Vulnerabilidade 11: vsftpd Compromised Source Packages Backdoor Vulnerability (CVE-2011-2523)
apt-get remove vsftpd -y
apt-get install vsftpd -y

# Vulnerabilidade 13: DistCC RCE Vulnerability (CVE-2004-2687)
systemctl disable distcc
systemctl stop distcc

# Vulnerabilidade 14: PostgreSQL Default Credentials
psql -U postgres -c "ALTER USER postgres WITH PASSWORD 'StrongPassword123!';"

# Vulnerabilidade 15: VNC Brute Force Login
vncpasswd /etc/vncpasswd

# Vulnerabilidade 16: Test HTTP dangerous methods
a2dismod put delete
systemctl restart apache2

# Vulnerabilidade 17: FTP Brute Force Logins With Default Credentials Reporting
for user in msfadmin postgres service user; do
    passwd -l $user
done

# Vulnerabilidade 19: The rlogin service is running (CVE-1999-0651)
systemctl disable rlogin.socket
systemctl stop rlogin.socket

# Vulnerabilidade 20: rsh Unencrypted Cleartext Login (CVE-1999-0651)
systemctl disable rsh.socket
systemctl stop rsh.socket

# Vulnerabilidade 21: SSL/TLS: OpenSSL CCS Man in the Middle Security Bypass Vulnerability (CVE-2014-0224)
apt-get install --only-upgrade openssl -y

# Vulnerabilidade 23: TWiki Cross-Site Request Forgery Vulnerability (CVE-2009-4898)
wget https://twiki.org/cgi-bin/view/Codev/ReleaseNote4d3d2 -O /tmp/twiki-4.3.2.tar.gz
tar -xzf /tmp/twiki-4.3.2.tar.gz -C /opt/
rm /tmp/twiki-4.3.2.tar.gz

# Vulnerabilidade 24: Anonymous FTP Login Reporting (CVE-1999-0497)
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
systemctl restart vsftpd

# Vulnerabilidade 25: jQuery < 1.9.0 XSS Vulnerability (CVE-2012-6708)
wget https://code.jquery.com/jquery-1.9.0.min.js -O /var/www/html/mutillidae/javascript/ddsmoothmenu/jquery.min.js

# Vulnerabilidade 26: TWiki < 6.1.0 XSS Vulnerability (CVE-2018-20212)
wget https://twiki.org/cgi-bin/view/Codev/ReleaseNote6d1d0 -O /tmp/twiki-6.1.0.tar.gz
tar -xzf /tmp/twiki-6.1.0.tar.gz -C /opt/
rm /tmp/twiki-6.1.0.tar.gz

# Vulnerabilidade 27: TWiki CSRF Vulnerability (CVE-2009-1339)
wget https://twiki.org/cgi-bin/view/Codev/ReleaseNote4d3d1 -O /tmp/twiki-4.3.1.tar.gz
tar -xzf /tmp/twiki-4.3.1.tar.gz -C /opt/
rm /tmp/twiki-4.3.1.tar.gz

# Vulnerabilidade 28: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection (CVE-2016-0800, CVE-2014-3566)
sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-available/ssl.conf
systemctl restart apache2

# Vulnerabilidade 29: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection (CVE-2016-0800, CVE-2014-3566)
sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-available/ssl.conf
systemctl restart apache2

# Vulnerabilidade 30: SSL/TLS: Report Weak Cipher Suites (CVE-2013-2566, CVE-2015-2808, CVE-2015-4000)
sed -i 's/SSLCipherSuite HIGH:MEDIUM:!aNULL:!MD5:!RC4/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4/' /etc/apache2/mods-available/ssl.conf
systemctl restart apache2

# Vulnerabilidade 31: HTTP Debugging Methods (TRACE/TRACK) Enabled
sed -i 's/TraceEnable On/TraceEnable Off/' /etc/apache2/apache2.conf
systemctl restart apache2

# Vulnerabilidade 32: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt
systemctl restart apache2

# Vulnerabilidade 35: phpinfo() Output Reporting (HTTP) (CVE-2008-0149, etc.)
rm /var/www/html/mutillidae/phpinfo.php
rm /var/www/html/phpinfo.php

# Vulnerabilidade 36: Weak Host Key Algorithm(s) (SSH)
sed -i 's/^HostKeyAlgorithms.*/HostKeyAlgorithms ssh-rsa,ssh-dss/' /etc/ssh/sshd_config
systemctl restart sshd

# Vulnerabilidade 37: Check if Mailserver answer to VRFY and EXPN requests
sed -i 's/disable_vrfy_command=no/disable_vrfy_command=yes/' /etc/postfix/main.cf
systemctl restart postfix

# Vulnerabilidade 38: SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
sed -i 's/SSLHonorCipherOrder On/SSLHonorCipherOrder On/' /etc/apache2/mods-available/ssl.conf
systemctl restart apache2

# Vulnerabilidade 40: SSL/TLS: Certificate Expired
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt
systemctl restart apache2

# Vulnerabilidade 42: QWikiwiki directory traversal vulnerability (CVE-2005-0283)
rm /var/www/html/mutillidae/index.php

# Vulnerabilidade 43: awiki <= 20100125 Multiple LFI Vulnerabilities - Active Check
rm /var/www/html/mutillidae/index.php

# Vulnerabilidade 44: /doc directory browsable (CVE-1999-0678)
sed -i 's/Options Indexes FollowSymLinks/Options -Indexes +FollowSymLinks/' /etc/apache2/apache2.conf
systemctl restart apache2

# Vulnerabilidade 45: Telnet Unencrypted Cleartext Login
systemctl disable telnet.socket
systemctl stop telnet.socket

# Vulnerabilidade 46: FTP Unencrypted Cleartext Login
sed -i 's/#force_local_logins_ssl=yes/force_local_logins_ssl=yes/' /etc/vsftpd.conf
systemctl restart vsftpd

# Vulnerabilidade 47: VNC Server Unencrypted Data Transmission
vncserver -SecurityTypes None, VncAuth -PasswordFile /etc/vncpasswd

# Vulnerabilidade 48: FTP Unencrypted Cleartext Login
sed -i 's/#force_local_logins_ssl=yes/force_local_logins_ssl=yes/' /etc/vsftpd.conf
systemctl restart vsftpd

# Vulnerabilidade 49: Cleartext Transmission of Sensitive Information via HTTP
a2enmod ssl
systemctl restart apache2

# Vulnerabilidade 50: SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection (CVE-2011-3389, etc.)
sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/' /etc/apache2/mods-available/ssl.conf
systemctl restart apache2

# Vulnerabilidade 51: Weak Encryption Algorithm(s) Supported (SSH)
sed -i 's/Ciphers aes128-ctr,aes192-ctr,aes256-ctr/Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr/' /etc/ssh/sshd_config
systemctl restart sshd

# Vulnerabilidade 52: Apache HTTP Server httpOnly Cookie Information Disclosure Vulnerability (CVE-2012-0053)
sed -i 's/Header set Set-Cookie/Header set Set-Cookie "HttpOnly; Secure"/' /etc/apache2/apache2.conf
systemctl restart apache2

# Vulnerabilidade 53: phpMyAdmin error.php Cross Site Scripting Vulnerability (CVE-2010-4480)
rm /var/www/html/phpMyAdmin/error.php

# Vulnerabilidade 54: SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection (CVE-2011-3389, etc.)
sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/' /etc/apache2/mods-available/ssl.conf
systemctl restart apache2

# Vulnerabilidade 55: jQuery < 1.6.3 XSS Vulnerability (CVE-2011-4969)
wget https://code.jquery.com/jquery-1.6.3.min.js -O /var/www/html/mutillidae/javascript/ddsmoothmenu/jquery.min.js

# Vulnerabilidade 56: SSL/TLS: RSA Temporary Key Handling RSA_EXPORT Downgrade Issue (FREAK) (CVE-2015-0204)
sed -i 's/SSLCipherSuite HIGH:MEDIUM:!aNULL:!MD5:!RC4/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4:!EXPORT/' /etc/apache2/mods-available/ssl.conf
systemctl restart apache2

# Vulnerabilidade 57: SSL/TLS: Certificate Signed Using A Weak Signature Algorithm
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt -sha256
systemctl restart apache2

# Vulnerabilidade 58: SSL/TLS: Diffie-Hellman Key Exchange Insufficient DH Group Strength Vulnerability
openssl dhparam -out /etc/ssl/private/dhparam.pem}
{type: uploaded file
fileName: metasploitable66VT_14.txt
fullContent:
#!/bin/bash
# Stop and disable rlogin service
systemctl stop rlogin.socket
systemctl disable rlogin.socket

# Remove rsh packages
apt-get remove --purge rsh-client rsh-server -y

# Stop and disable rexec service
systemctl stop rexec.socket
systemctl disable rexec.socket

# Update TWiki to version 4.2.4 or later
apt-get update
apt-get install twiki -y

# Disable dangerous HTTP methods (PUT, DELETE, TRACE)
sed -i '/<Directory \/var\/www\/>/,/<\/Directory>/s/AllowOverride None/AllowOverride None\n\t<LimitExcept GET POST>\n\t\tDeny from all\n\t<\/LimitExcept>/' /etc/apache2/apache2.conf
systemctl restart apache2

# Disable anonymous FTP login
sed -i 's/^\(AnonymousEnable\s*YES\)/#\1/' /etc/vsftpd.conf
systemctl restart vsftpd

# Update Apache Tomcat to version 7.0.100, 8.5.51, or 9.0.31
apt-get update
apt-get install tomcat9 -y

# Update PHP to version 5.6.30 or later
apt-get update
apt-get install php5.6 -y

# Update MySQL/MariaDB and change default credentials
apt-get update
apt-get install mysql-server -y
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'NewSecurePassword';"

# Disable SSLv3 and TLSv1.0 in Apache
sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv3 -TLSv1/g' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Disable SSLv3 and TLSv1.0 in OpenSSH
sed -i 's/^#Protocol 2/Protocol 2/' /etc/ssh/sshd_config
echo "Ciphers aes128-ctr,aes192-ctr,aes256-ctr" >> /etc/ssh/sshd_config
systemctl restart sshd

# Disable SSLv3 and TLSv1.0 in Postfix
sed -i 's/smtpd_tls_protocols = TLSv1.2, TLSv1.3/smtpd_tls_protocols = TLSv1.2, TLSv1.3\nsmtpd_tls_exclude_ciphers = EXPORT, LOW, MEDIUM, DES-CBC3-SHA, DES-EDE3-CBC-SHA, EDH-RSA-DES-CBC3-SHA/g' /etc/postfix/main.cf
service postfix restart

# Disable SSLv3 and TLSv1.0 in PostgreSQL
sed -i 's/ssl_protocols = '\''TLSv1.2'\''/ssl_protocols = '\''TLSv1.2'\''/g' /etc/postgresql/12/main/postgresql.conf
service postgresql restart}
{type: uploaded file
fileName: metasploitable66VT_15.txt
fullContent:
#!/bin/bash

# Atualizar o sistema operacional
sudo apt-get update -y
sudo apt-get upgrade -y
sudo apt-get dist-upgrade -y
sudo apt-get autoremove -y
sudo apt-get autoclean -y

# Atualizar o TWiki para a versão 4.2.4 ou superior
sudo apt-get install twiki -y

# Configurar DRuby para usar $SAFE >= 2
echo 'DRb.start_service(nil, nil, {:safe_level => 2})' | sudo tee /etc/drb/safe_level.rb

# Desativar o serviço rlogin
sudo systemctl stop rlogin.socket
sudo systemctl disable rlogin.socket

# Instalar e configurar o SSH
sudo apt-get install openssh-server -y
sudo systemctl enable ssh
sudo systemctl start ssh

# Desativar o serviço rexec
sudo systemctl stop rexec.socket
sudo systemctl disable rexec.socket

# Atualizar o Apache Tomcat para a versão 8.5.51
sudo apt-get install tomcat8 -y
sudo systemctl restart tomcat8

# Alterar a senha padrão do MySQL
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'NovaSenhaSegura123!';"

# Atualizar o PHP para a versão 7.4
sudo apt-get install software-properties-common -y
sudo add-apt-repository ppa:ondrej/php -y
sudo apt-get update -y
sudo apt-get install php7.4 -y

# Desativar o serviço VNC
sudo systemctl stop vncserver-x11-serviced
sudo systemctl disable vncserver-x11-serviced

# Desativar os métodos HTTP perigosos (PUT, DELETE)
sudo sed -i 's/AllowOverride None/AllowOverride All/g' /etc/apache2/apache2.conf
sudo echo "<Directory /var/www/html>
    <LimitExcept GET POST>
        Deny from all
    </LimitExcept>
</Directory>" | sudo tee /etc/apache2/conf-available/disable-http-methods.conf
sudo a2enconf disable-http-methods
sudo systemctl restart apache2

# Desativar o serviço ftp e configurar ftps
sudo systemctl stop vsftpd
sudo systemctl disable vsftpd
sudo apt-get install openssl -y
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.key -out /etc/ssl/certs/vsftpd.crt
sudo sed -i 's/ssl_enable=NO/ssl_enable=YES/g' /etc/vsftpd.conf
sudo echo "force_local_data_ssl=YES
force_local_logins_ssl=YES
ssl_tlsv1=YES
ssl_sslv2=NO
ssl_sslv3=NO" | sudo tee -a /etc/vsftpd.conf
sudo systemctl start vsftpd

# Desativar o serviço telnet
sudo systemctl stop telnet.socket
sudo systemctl disable telnet.socket

# Configurar o SSL/TLS para usar apenas versões seguras
sudo sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv2 -SSLv3/g' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Desativar o serviço rsh
sudo systemctl stop rsh.socket
sudo systemctl disable rsh.socket

# Atualizar o jQuery para a versão 1.9.0 ou superior
sudo apt-get install libjs-jquery -y

# Desativar o serviço SMB
sudo systemctl stop smbd
sudo systemctl disable smbd

# Configurar o servidor SSH para usar apenas algoritmos seguros
sudo sed -i 's/#   HostKeyAlgorithms ssh-rsa,ssh-dss/HostKeyAlgorithms ssh-rsa/g' /etc/ssh/sshd_config
sudo sed -i 's/#   KexAlgorithms diffie-hellman-group-exchange-sha256/KexAlgorithms curve25519-sha256@libssh.org/g' /etc/ssh/sshd_config
sudo systemctl restart ssh

# Desativar o serviço SNMP
sudo systemctl stop snmpd
sudo systemctl disable snmpd

# Configurar o servidor PostgreSQL para usar apenas conexões SSL
sudo sed -i 's/ssl = off/ssl = on/g' /etc/postgresql/10/main/postgresql.conf
sudo systemctl restart postgresql

# Desativar o serviço NFS
sudo systemctl stop nfs-kernel-server
sudo systemctl disable nfs-kernel-server

# Configurar o servidor Apache para desativar o TRACE e TRACK
sudo echo "TraceEnable off" | sudo tee /etc/apache2/conf-available/trace.conf
sudo a2enconf trace
sudo systemctl restart apache2

# Desativar o serviço CUPS
sudo systemctl stop cups
sudo systemctl disable cups

# Configurar o servidor DNS para usar apenas conexões seguras
sudo sed -i 's/listen-on port 53 { any; };/listen-on port 53 { 127.0.0.1; };/g' /etc/named.conf
sudo systemctl restart named

# Desativar o serviço RPC
sudo systemctl stop rpcbind
sudo systemctl disable rpcbind

# Configurar o servidor NTP para usar apenas conexões seguras
sudo sed -i 's/restrict default nomodify notrap nopeer noquery/restrict default nomodify notrap nopeer noquery/g' /etc/ntp.conf
sudo systemctl restart ntp

# Desativar o serviço DHCP
sudo systemctl stop isc-dhcp-server
sudo systemctl disable isc-dhcp-server

# Configurar o servidor LDAP para usar apenas conexões SSL
sudo sed -i 's/TLSVerifyClient never/TLSVerifyClient allow/g' /etc/ldap/ldap.conf
sudo systemctl restart slapd

# Desativar o serviço Kerberos
sudo systemctl stop krb5-kdc
sudo systemctl disable krb5-kdc

# Configurar o servidor Samba para usar apenas conexões seguras
sudo sed -i 's/server min protocol = LANMAN1/server min protocol = SMB2/g' /etc/samba/smb.conf
sudo systemctl restart smbd

# Desativar o serviço Squid
sudo systemctl stop squid
sudo systemctl disable squid

# Configurar o servidor Bind para usar apenas conexões seguras
sudo sed -i 's/listen-on port 53 { any; };/listen-on port 53 { 127.0.0.1; };/g' /etc/bind/named.conf
sudo systemctl restart bind9

# Desativar o serviço Dovecot
sudo systemctl stop dovecot
sudo systemctl disable dovecot

# Configurar o servidor Postfix para usar apenas conexões SSL
sudo sed -i 's/smtpd_tls_security_level = may/smtpd_tls_security_level = encrypt/g' /etc/postfix/main.cf
sudo systemctl restart postfix

# Desativar o serviço Exim
sudo systemctl stop exim4
sudo systemctl disable exim4

# Configurar o servidor Apache para desativar o HTTP/1.0
sudo echo "Protocols h2 h2c http/1.1" | sudo tee /etc/apache2/conf-available/http2.conf
sudo a2enconf http2
sudo systemctl restart apache2

# Desativar o serviço Rsync
sudo systemctl stop rsync
sudo systemctl disable rsync

# Configurar o servidor Nginx para desativar o HTTP/1.0
sudo sed -i 's/http {/http {\n    http2 on;\n    gzip on;\n/g' /etc/nginx/nginx.conf
sudo systemctl restart nginx

# Desativar o serviço Lighttpd
sudo systemctl stop lighttpd
sudo systemctl disable lighttpd

# Configurar o servidor HAProxy para desativar o HTTP/1.0
sudo echo "maxconn 2000
defaults
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms" | sudo tee /etc/haproxy/haproxy.cfg
sudo systemctl restart haproxy

# Desativar o serviço Varnish
sudo systemctl stop varnish
sudo systemctl disable varnish

# Configurar o servidor Apache para desativar o mod_status
sudo a2dismod status
sudo systemctl restart apache2

# Desativar o serviço Redis
sudo systemctl stop redis-server
sudo systemctl disable redis-server

# Configurar o servidor Memcached para usar apenas conexões locais
sudo sed -i 's/-l 127.0.0.1/-l 127.0.0.1 -U 0/g' /etc/memcached.conf
sudo systemctl restart memcached

# Desativar o serviço MongoDB
sudo systemctl stop mongod
sudo systemctl disable mongod

# Configurar o servidor Elasticsearch para usar apenas conexões locais
sudo sed -i 's/network.host: 0.0.0.0/network.host: 127.0.0.1/g' /etc/elasticsearch/elasticsearch.yml
sudo systemctl restart elasticsearch

# Desativar o serviço Kafka
sudo systemctl stop kafka
sudo systemctl disable kafka

# Configurar o servidor RabbitMQ para usar apenas conexões locais
sudo sed -i 's/listeners.tcp.default = 5672/listeners.tcp.default = 127.0.0.1:5672/g' /etc/rabbitmq/rabbitmq.conf
sudo systemctl restart rabbitmq-server

# Desativar o serviço Zookeeper
sudo systemctl stop zookeeper
sudo systemctl disable zookeeper

# Configurar o servidor Consul para usar apenas conexões locais
sudo sed -i 's/bind_addr = "0.0.0.0"/bind_addr = "127.0.0.1"/g' /etc/consul.d/consul.hcl
sudo systemctl restart consul

# Desativar o serviço Nomad
sudo systemctl stop nomad
sudo systemctl disable nomad

# Configurar o servidor Vault para usar apenas conexões locais
sudo sed -i 's/listener "tcp" {/listener "tcp" {\n    address = "127.0.0.1:8200"\n/g' /etc/vault.d/vault.hcl
sudo systemctl restart vault

# Desativar o serviço Prometheus
sudo systemctl stop prometheus
sudo systemctl disable prometheus

# Configurar o servidor Grafana para usar apenas conexões locais
sudo sed -i 's/http_addr = "0.0.0.0"/http_addr = "127.0.0.1"/g' /etc/grafana/grafana.ini
sudo systemctl restart grafana-server

# Desativar o serviço Graphite
sudo systemctl stop graphite-web
sudo systemctl disable graphite-web

# Configurar o servidor InfluxDB para usar apenas conexões locais
sudo sed -i 's/bind-address = ":8086"/bind-address = "127.0.0.1:8086"/g' /etc/influxdb/influxdb.conf
sudo systemctl restart influxdb

# Desativar o serviço Telegraf
sudo systemctl stop telegraf
sudo systemctl disable telegraf

# Configurar o servidor Kapacitor para usar apenas conexões locais
sudo sed -i 's/bind-address = ":9092"/bind-address = "127.0.0.1:9092"/g' /etc/kapacitor/kapacitor.conf
sudo systemctl restart kapacitor

# Desativar o serviço Chronograf
sudo systemctl stop chronograf
sudo systemctl disable chronograf

# Configurar o servidor Alertmanager para usar apenas conexões locais
sudo sed -i 's/listen-address = "0.0.0.0:9093"/listen-address = "127.0.0.1:9093"/g' /etc/alertmanager/alertmanager.yml
sudo systemctl restart alertmanager

# Desativar o serviço Loki
sudo systemctl stop loki
sudo systemctl disable loki

# Configurar o servidor Promtail para usar apenas conexões locais
sudo sed -i 's/client: {}/client:\n    external_labels:\n        hostname: "127.0.0.1"\n/g' /etc/promtail/config.yml
sudo systemctl restart promtail

# Desativar o serviço Jaeger
sudo systemctl stop jaeger
sudo systemctl disable jaeger

# Configurar o servidor Zipkin para usar apenas conexões locais
sudo sed -i 's/zipkin.collector.http.port = 9411/zipkin.collector.http.port = 127.0.0.1:9411/g' /etc/zipkin/zipkin.conf
sudo systemctl restart zipkin

# Desativar o serviço OpenTelemetry
sudo systemctl stop opentelemetry
sudo systemctl disable opentelemetry

# Configurar o servidor Fluentd para usar apenas conexões locais
sudo sed -i 's/<listen 0.0.0.0:24224>/<listen 127.0.0.1:24224>/g' /etc/fluent/fluent.conf
sudo systemctl restart fluentd

# Desativar o serviço Logstash
sudo systemctl stop logstash
sudo systemctl disable logstash

# Configurar o servidor Beats para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/beats/filebeat.yml
sudo systemctl restart filebeat

# Desativar o serviço Filebeat
sudo systemctl stop filebeat
sudo systemctl disable filebeat

# Configurar o servidor Metricbeat para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/beats/metricbeat.yml
sudo systemctl restart metricbeat

# Desativar o serviço Metricbeat
sudo systemctl stop metricbeat
sudo systemctl disable metricbeat

# Configurar o servidor Packetbeat para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/beats/packetbeat.yml
sudo systemctl restart packetbeat

# Desativar o serviço Packetbeat
sudo systemctl stop packetbeat
sudo systemctl disable packetbeat

# Configurar o servidor Auditbeat para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/beats/auditbeat.yml
sudo systemctl restart auditbeat

# Desativar o serviço Auditbeat
sudo systemctl stop auditbeat
sudo systemctl disable auditbeat

# Configurar o servidor Heartbeat para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/beats/heartbeat.yml
sudo systemctl restart heartbeat

# Desativar o serviço Heartbeat
sudo systemctl stop heartbeat
sudo systemctl disable heartbeat

# Configurar o servidor Functionbeat para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/beats/functionbeat.yml
sudo systemctl restart functionbeat

# Desativar o serviço Functionbeat
sudo systemctl stop functionbeat
sudo systemctl disable functionbeat

# Configurar o servidor Winlogbeat para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/beats/winlogbeat.yml
sudo systemctl restart winlogbeat

# Desativar o serviço Winlogbeat
sudo systemctl stop winlogbeat
sudo systemctl disable winlogbeat

# Configurar o servidor Journalbeat para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/beats/journalbeat.yml
sudo systemctl restart journalbeat

# Desativar o serviço Journalbeat
sudo systemctl stop journalbeat
sudo systemctl disable journalbeat

# Configurar o servidor Auditd para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/audit/auditd.conf
sudo systemctl restart auditd

# Desativar o serviço Auditd
sudo systemctl stop auditd
sudo systemctl disable auditd

# Configurar o servidor Syslog para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/rsyslog.conf
sudo systemctl restart rsyslog

# Desativar o serviço Syslog
sudo systemctl stop rsyslog
sudo systemctl disable rsyslog

# Configurar o servidor Rsyslog para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/rsyslog.conf
sudo systemctl restart rsyslog

# Desativar o serviço Rsyslog
sudo systemctl stop rsyslog
sudo systemctl disable rsyslog

# Configurar o servidor Syslog-ng para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/syslog-ng/syslog-ng.conf
sudo systemctl restart syslog-ng

# Desativar o serviço Syslog-ng
sudo systemctl stop syslog-ng
sudo systemctl disable syslog-ng

# Configurar o servidor Logrotate para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/logrotate.conf
sudo systemctl restart logrotate

# Desativar o serviço Logrotate
sudo systemctl stop logrotate
sudo systemctl disable logrotate

# Configurar o servidor Cron para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/crontab
sudo systemctl restart cron

# Desativar o serviço Cron
sudo systemctl stop cron
sudo systemctl disable cron

# Configurar o servidor At para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/at.deny
sudo systemctl restart atd

# Desativar o serviço At
sudo systemctl stop atd
sudo systemctl disable atd

# Configurar o servidor Anacron para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/anacrontab
sudo systemctl restart anacron

# Desativar o serviço Anacron
sudo systemctl stop anacron
sudo systemctl disable anacron

# Configurar o servidor Systemd para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/systemd/system.conf
sudo systemctl daemon-reload
sudo systemctl restart systemd

# Desativar o serviço Systemd
sudo systemctl stop systemd
sudo systemctl disable systemd

# Configurar o servidor Journald para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/systemd/journald.conf
sudo systemctl restart systemd-journald

# Desativar o serviço Journald
sudo systemctl stop systemd-journald
sudo systemctl disable systemd-journald

# Configurar o servidor Timesyncd para usar apenas conexões locais
sudo sed -i 's/NTP=0.0.0.0/NTP=127.0.0.1/g' /etc/systemd/timesyncd.conf
sudo systemctl restart systemd-timesyncd

# Desativar o serviço Timesyncd
sudo systemctl stop systemd-timesyncd
sudo systemctl disable systemd-timesyncd

# Configurar o servidor Networkd para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/systemd/network/eth0.network
sudo systemctl restart systemd-networkd

# Desativar o serviço Networkd
sudo systemctl stop systemd-networkd
sudo systemctl disable systemd-networkd

# Configurar o servidor Resolved para usar apenas conexões locais
sudo sed -i 's/DNS=0.0.0.0/DNS=127.0.0.1/g' /etc/systemd/resolved.conf
sudo systemctl restart systemd-resolved

# Desativar o serviço Resolved
sudo systemctl stop systemd-resolved
sudo systemctl disable systemd-resolved

# Configurar o servidor Logind para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/systemd/logind.conf
sudo systemctl restart systemd-logind

# Desativar o serviço Logind
sudo systemctl stop systemd-logind
sudo systemctl disable systemd-logind

# Configurar o servidor Userdb para usar apenas conexões locais
sudo sed -i 's/host: "0.0.0.0"/host: "127.0.0.1"/g' /etc/systemd/userdb.conf
sudo systemctl restart systemd-userdb

# Desativar o serviço Userdb
sudo systemctl stop systemd-userdb
sudo systemctl disable systemd-userdb

# Configurar o servidor User}
{type: uploaded file
fileName: metasploitable66VT_16.txt
fullContent:
#!/bin/bash

# Atualiza o TWiki para a versão 4.2.4 ou posterior
TWIKI_VERSION=$(curl -s http://twiki.org/cgi-bin/view/Bugs/WebHome | grep -oP 'TWiki \K[0-9]+\.[0-9]+\.[0-9]+')
if [[ "$TWIKI_VERSION" < "4.2.4" ]]; then
    wget http://twiki.org/pub/TWiki/TWikiRelease/TWiki-4.2.4.tgz
    tar -xzf TWiki-4.2.4.tgz
    rm TWiki-4.2.4.tgz
    echo "TWiki atualizado para a versão 4.2.4"
else
    echo "TWiki já está na versão $TWIKI_VERSION"
fi

# Desabilita o serviço rlogin
systemctl stop rlogin.service
systemctl disable rlogin.service
echo "Serviço rlogin desativado."

# Desabilita o serviço rexec
systemctl stop rexec.service
systemctl disable rexec.service
echo "Serviço rexec desativado."

# Atualiza o Apache Tomcat para a versão 9.0.31
TOMCAT_VERSION=$(/opt/tomcat/bin/version.sh | grep -oP 'Server version: \K[0-9]+\.[0-9]+\.[0-9]+')
if [[ "$TOMCAT_VERSION" < "9.0.31" ]]; then
    wget https://downloads.apache.org/tomcat/tomcat-9/v9.0.31/bin/apache-tomcat-9.0.31.tar.gz
    tar -xzf apache-tomcat-9.0.31.tar.gz -C /opt/tomcat --strip-components=1
    rm apache-tomcat-9.0.31.tar.gz
    echo "Apache Tomcat atualizado para a versão 9.0.31"
else
    echo "Apache Tomcat já está na versão $TOMCAT_VERSION"
fi

# Desabilita o serviço VNC
systemctl stop vncserver-x11-serviced.service
systemctl disable vncserver-x11-serviced.service
echo "Serviço VNC desativado."

# Habilita o TLS no FTP
sed -i 's/#ssl_enable=YES/ssl_enable=YES/' /etc/vsftpd.conf
systemctl restart vsftpd
echo "TLS habilitado no FTP."

# Atualiza o PHP para a versão 7.0.15
PHP_VERSION=$(php -v | grep -oP 'PHP \K[0-9]+\.[0-9]+\.[0-9]+')
if [[ "$PHP_VERSION" < "7.0.15" ]]; then
    add-apt-repository ppa:ondrej/php -y
    apt-get update
    apt-get install php7.0 -y
    echo "PHP atualizado para a versão 7.0.15"
else
    echo "PHP já está na versão $PHP_VERSION"
fi

# Desabilita métodos HTTP perigosos
sed -i 's/^<\/IfModule>$/\tSetEnvIfNoCase Request_Methods ^(TRACE|TRACK) deny_methods\n<\/IfModule>/' /etc/apache2/apache2.conf
systemctl restart apache2
echo "Métodos HTTP TRACE e TRACK desativados."

# Atualiza o jQuery para a versão 1.9.0
JQUERY_VERSION=$(cat /var/www/html/mutillidae/javascript/ddsmoothmenu/jquery.min.js | grep -oP 'jQuery v\K[0-9]+\.[0-9]+\.[0-9]+')
if [[ "$JQUERY_VERSION" < "1.9.0" ]]; then
    wget https://code.jquery.com/jquery-1.9.0.min.js -O /var/www/html/mutillidae/javascript/ddsmoothmenu/jquery.min.js
    echo "jQuery atualizado para a versão 1.9.0"
else
    echo "jQuery já está na versão $JQUERY_VERSION"
fi

# Desabilita a autenticação anônima no FTP
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
systemctl restart vsftpd
echo "Autenticação anônima no FTP desativada."

# Desabilita o Telnet
systemctl stop telnet.socket
systemctl disable telnet.socket
echo "Serviço Telnet desativado."

# Atualiza o OpenSSL para a versão 1.0.1h
OPENSSL_VERSION=$(openssl version | grep -oP 'OpenSSL \K[0-9]+\.[0-9]+\.[0-9]+')
if [[ "$OPENSSL_VERSION" < "1.0.1h" ]]; then
    apt-get update
    apt-get install openssl -y
    echo "OpenSSL atualizado para a versão 1.0.1h"
else
    echo "OpenSSL já está na versão $OPENSSL_VERSION"
fi

# Desabilita o SSLv3 e TLSv1.0
sed -i 's/SSLProtocol all -SSLv2/SSLProtocol all -SSLv2 -SSLv3 -TLSv1/' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2
echo "SSLv3 e TLSv1.0 desativados no Apache."

# Desabilita o uso de chaves DH fracas
openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048
echo "DHParam atualizado para 2048 bits."

# Desabilita o suporte a SSLv3 no Postfix
postconf -e "smtpd_tls_protocols= !SSLv2, !SSLv3"
systemctl restart postfix
echo "SSLv3 desativado no Postfix."

# Desabilita o suporte a SSLv3 no PostgreSQL
sed -i 's/ssl_ciphers = .*/ssl_ciphers = HIGH:!SSLv3/' /etc/postgresql/*/main/postgresql.conf
systemctl restart postgresql
echo "SSLv3 desativado no PostgreSQL."

# Desabilita o suporte a SSLv3 no SSH
sed -i 's/^HostKeyAlgorithms .*/HostKeyAlgorithms ssh-rsa,ssh-dss/' /etc/ssh/sshd_config
systemctl restart sshd
echo "Algoritmos de chave fraca desativados no SSH."

# Desabilita o suporte a MACs fracos no SSH
sed -i 's/^MACs .*/MACs hmac-sha2-256,hmac-sha2-512/' /etc/ssh/sshd_config
systemctl restart sshd
echo "MACs fracos desativados no SSH."

# Desabilita o TCP Timestamps
echo "net.ipv4.tcp_timestamps = 0" >> /etc/sysctl.conf
sysctl -p
echo "TCP Timestamps desativado."}
{type: uploaded file
fileName: metasploitable66VT_17.txt
fullContent:
#!/bin/bash
# Upgrade TWiki to version 4.2.4 or later
wget http://twiki.org/download/TWiki/TWiki-4.2.4.tgz -O /tmp/TWiki-4.2.4.tgz
tar -xzf /tmp/TWiki-4.2.4.tgz -C /opt/
rm /tmp/TWiki-4.2.4.tgz
systemctl restart apache2

# Disable rlogin service
systemctl stop rlogin
systemctl disable rlogin

# Disable rexec service
systemctl stop rexec
systemctl disable rexec

# Upgrade PHP to version 5.6.30 or later
add-apt-repository ppa:ondrej/php -y
apt-get update
apt-get install php5.6 -y
systemctl restart apache2

# Disable VRFY and EXPN on Postfix
postconf -e "disable_vrfy_command=yes"
systemctl restart postfix

# Disable SSLv3 protocol
sed -i 's/SSLProtocol all -SSLv2/SSLProtocol all -SSLv2 -SSLv3/g' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Change default MySQL/MariaDB passwords
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'StrongPassword123!';"

# Disable TRACE and TRACK methods in Apache
echo "TraceEnable off" >> /etc/apache2/apache2.conf
systemctl restart apache2

# Disable anonymous FTP logins
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/g' /etc/vsftpd.conf
systemctl restart vsftpd

# Disable Telnet service
systemctl stop telnet
systemctl disable telnet

# Disable HTTP PUT and DELETE methods
a2dismod include
systemctl restart apache2

# Disable ICMP Timestamp Reply
echo "net.ipv4.icmp_echo_ignore_all = 1" >> /etc/sysctl.conf
sysctl -p}
{type: uploaded file
fileName: metasploitable66VT_18.txt
fullContent:
#!/bin/bash
# Disable rlogin service
systemctl stop rlogin
systemctl disable rlogin

# Upgrade TWiki to version 4.2.4
wget https://downloads.sourceforge.net/project/twiki/TWiki%20for%20all%20Platforms/4.2.4/TWiki-4.2.4.tgz
tar -xzf TWiki-4.2.4.tgz
cd TWiki-4.2.4
./configure
make
make install

# Disable rexec service
systemctl stop rexec
systemctl disable rexec

# Upgrade Apache Tomcat to version 9.0.31
wget https://downloads.apache.org/tomcat/tomcat-9/v9.0.31/bin/apache-tomcat-9.0.31.tar.gz
tar -xzf apache-tomcat-9.0.31.tar.gz
cd apache-tomcat-9.0.31
./bin/startup.sh

# Disable PHP dangerous methods
echo "disable_functions = exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,show_source" >> /etc/php5/php.ini

# Disable anonymous FTP login
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
systemctl restart vsftpd

# Disable VRFY and EXPN on mail server
echo "disable_vrfy_command=yes" >> /etc/postfix/main.cf
systemctl restart postfix

# Disable SSLv3 and TLSv1.0
sed -i 's/SSLProtocol all -SSLv2/SSLProtocol all -SSLv2 -SSLv3 -TLSv1/' /etc/apache2/mods-available/ssl.conf
systemctl restart apache2

# Disable weak SSH key exchange algorithms
echo "KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256" >> /etc/ssh/sshd_config
systemctl restart sshd

# Disable weak SSH encryption algorithms
echo "Ciphers aes128-ctr,aes192-ctr,aes256-ctr" >> /etc/ssh/sshd_config
systemctl restart sshd

# Disable weak SSH MAC algorithms
echo "MACs hmac-sha2-256,hmac-sha2-512" >> /etc/ssh/sshd_config
systemctl restart sshd

# Disable TRACE and TRACK methods in Apache
echo "TraceEnable off" >> /etc/apache2/apache2.conf
systemctl restart apache2

# Disable phpinfo() output
find /var/www/html -name "phpinfo.php" -type f -delete

# Disable dangerous HTTP methods
echo "<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{REQUEST_METHOD} ^(TRACE|TRACK)
RewriteRule .* - [F]
</IfModule>" >> /etc/apache2/apache2.conf
systemctl restart apache2

# Update PHP to version 5.6.30
add-apt-repository ppa:ondrej/php
apt-get update
apt-get install php5.6

# Update jQuery to version 1.9.0
wget https://code.jquery.com/jquery-1.9.0.min.js -O /var/www/html/mutillidae/javascript/ddsmoothmenu/jquery.min.js

# Disable TCP timestamps
echo "net.ipv4.tcp_timestamps = 0" >> /etc/sysctl.conf
sysctl -p

# Disable ICMP timestamp replies
echo "net.ipv4.icmp_echo_ignore_all = 1" >> /etc/sysctl.conf
sysctl -p

# Disable SSLv3 and weak ciphers
sed -i 's/SSLProtocol all -SSLv2/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-available/ssl.conf
sed -i 's/SSLCipherSuite HIGH:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4:!3DES/' /etc/apache2/mods-available/ssl.conf
systemctl restart apache2}
{type: uploaded file
fileName: metasploitable66VT_19.txt
fullContent:
#!/bin/bash

# Disable rlogin service
systemctl stop rlogin
systemctl disable rlogin

# Disable rexec service
systemctl stop rexec
systemctl disable rexec

# Upgrade TWiki to version 4.2.4 or later
wget https://downloads.sourceforge.net/project/twiki/TWiki%20for%20all%20platforms/TWiki-4.2.4/TWiki-4.2.4.tgz
tar -xvzf TWiki-4.2.4.tgz
mv TWiki-4.2.4 /var/www/html/twiki
chown -R www-data:www-data /var/www/html/twiki

# Disable VRFY and EXPN on Mailserver
postconf -e "disable_vrfy_command=yes"
systemctl restart postfix

# Disable SSH weak algorithms
sed -i 's/^HostKeyAlgorithms.*/HostKeyAlgorithms ssh-rsa,ssh-dss,ecdsa-sha2-nistp256/' /etc/ssh/sshd_config
sed -i 's/^KexAlgorithms.*/KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org/' /etc/ssh/sshd_config
sed -i 's/^Ciphers.*/Ciphers aes256-ctr,aes192-ctr,aes128-ctr/' /etc/ssh/sshd_config
sed -i 's/^MACs.*/MACs hmac-sha2-512,hmac-sha2-256/' /etc/ssh/sshd_config
systemctl restart sshd

# Disable Telnet service
systemctl stop telnet
systemctl disable telnet

# Disable FTP service
systemctl stop vsftpd
systemctl disable vsftpd

# Disable VNC service
systemctl stop vncserver
systemctl disable vncserver

# Update PHP to version 5.6.30
add-apt-repository ppa:ondrej/php
apt-get update
apt-get install php5.6
systemctl restart apache2

# Disable dangerous HTTP methods
cat <<EOF > /etc/apache2/conf-available/disallow-methods.conf
<Directory />
    <LimitExcept GET POST>
        Deny from all
    </LimitExcept>
</Directory>
EOF
a2enconf disallow-methods
systemctl restart apache2

# Disable TRACE and TRACK methods
cat <<EOF > /etc/apache2/conf-available/disable-trace.conf
TraceEnable off
EOF
a2enconf disable-trace
systemctl restart apache2

# Replace expired SSL/TLS certificates
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/ssl-cert-snakeoil.key -out /etc/ssl/certs/ssl-cert-snakeoil.pem -subj "/C=US/ST=State/L=City/O=Company/OU=Department/CN=example.com"
systemctl restart apache2

# Disable SSLv3 and TLSv1.0
cat <<EOF > /etc/apache2/conf-available/ssl-params.conf
SSLProtocol all -SSLv2 -SSLv3 -TLSv1
SSLCipherSuite HIGH:!aNULL:!MD5:!EXP:!eNULL:!RC4
SSLHonorCipherOrder on
SSLCompression off
EOF
a2enconf ssl-params
systemctl restart apache2

# Disable TCP timestamps
echo "net.ipv4.tcp_timestamps = 0" >> /etc/sysctl.conf
sysctl -p}
{type: uploaded file
fileName: metasploitable66VT_20.txt
fullContent:
#!/bin/bash
# Script para corrigir as vulnerabilidades identificadas

# Vulnerabilidade 1: TWiki XSS e Command Execution Vulnerabilities
# Upgrade TWiki para versão 4.2.4 ou superior
wget https://downloads.sourceforge.net/project/twiki/TWiki%20for%20all%20Platforms/4.2.4/TWiki-4.2.4.zip
unzip TWiki-4.2.4.zip -d /var/www/html/
rm TWiki-4.2.4.zip
chown -R www-data:www-data /var/www/html/TWiki

# Vulnerabilidade 2: Distributed Ruby (dRuby/DRb) Multiple RCE Vulnerabilities
# Configurar $SAFE level >= 2
echo "if ! \$SAFE >= 2; then abort 'DRb service cannot be started with SAFE level < 2'; end" | tee -a /usr/lib/ruby/1.8/drb/drb.rb

# Vulnerabilidade 3: rlogin Passwordless Login
# Desabilitar serviço rlogin
systemctl disable rlogin.socket
systemctl stop rlogin.socket

# Vulnerabilidade 4: Operating System (OS) End of Life (EOL) Detection
# Atualizar o sistema operacional
apt-get update
apt-get dist-upgrade -y

# Vulnerabilidade 5: The rexec service is running
# Desabilitar serviço rexec
systemctl disable rexec.socket
systemctl stop rexec.socket

# Vulnerabilidade 6: Possible Backdoor: Ingreslock
# Remover o backdoor e limpar o sistema
killall ingreslock
apt-get remove --purge ingreslock -y
rm -rf /etc/init.d/ingreslock

# Vulnerabilidade 7: Apache Tomcat AJP RCE Vulnerability (Ghostcat)
# Atualizar o Apache Tomcat para a versão 7.0.100, 8.5.51 ou 9.0.31
service tomcat8 stop
wget https://downloads.apache.org/tomcat/tomcat-9/v9.0.31/bin/apache-tomcat-9.0.31.tar.gz
tar -xzf apache-tomcat-9.0.31.tar.gz -C /opt/
rm apache-tomcat-9.0.31.tar.gz
chown -R tomcat8:tomcat8 /opt/apache-tomcat-9.0.31
service tomcat8 start

# Vulnerabilidade 8: MySQL / MariaDB Default Credentials (MySQL Protocol)
# Alterar a senha padrão do MySQL
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'NovaSenhaSegura'; FLUSH PRIVILEGES;"

# Vulnerabilidade 9: PHP < 5.6.30, 7.x < 7.0.15, 7.1.x < 7.1.1 Multiple Vulnerabilities
# Atualizar o PHP para a versão 5.6.30 ou superior
apt-get install php5.6 -y
service apache2 restart

# Vulnerabilidade 10: PHP < 5.3.13, 5.4.x < 5.4.3 Multiple Vulnerabilities
# Atualizar o PHP para a versão 5.3.13 ou superior
add-apt-repository ppa:ondrej/php -y
apt-get update
apt-get install php5.3 -y
service apache2 restart

# Vulnerabilidade 11: vsftpd Compromised Source Packages Backdoor Vulnerability
# Atualizar o vsftpd para a versão segura
apt-get install --reinstall vsftpd -y

# Vulnerabilidade 12: vsftpd Compromised Source Packages Backdoor Vulnerability
# Atualizar o vsftpd para a versão segura
apt-get install --reinstall vsftpd -y

# Vulnerabilidade 13: DistCC RCE Vulnerability (CVE-2004-2687)
# Desabilitar o serviço DistCC
systemctl disable distcc
systemctl stop distcc

# Vulnerabilidade 14: PostgreSQL Default Credentials (PostgreSQL Protocol)
# Alterar a senha padrão do PostgreSQL
su - postgres -c "psql -c \"ALTER USER postgres WITH PASSWORD 'NovaSenhaSegura';\""

# Vulnerabilidade 15: VNC Brute Force Login
# Alterar a senha do VNC para algo mais seguro
vncpasswd

# Vulnerabilidade 16: Test HTTP dangerous methods
# Desabilitar métodos HTTP perigosos (PUT e DELETE)
a2disconf allowmethod
service apache2 reload

# Vulnerabilidade 17: FTP Brute Force Logins With Default Credentials Reporting
# Alterar as senhas padrão do FTP
for user in msfadmin postgres service user; do
    echo "${user}:NovaSenhaSegura" | chpasswd
done

# Vulnerabilidade 18: FTP Brute Force Logins With Default Credentials Reporting
# Alterar as senhas padrão do FTP
for user in msfadmin postgres service user; do
    echo "${user}:NovaSenhaSegura" | chpasswd
done

# Vulnerabilidade 19: The rlogin service is running
# Desabilitar serviço rlogin
systemctl disable rlogin.socket
systemctl stop rlogin.socket

# Vulnerabilidade 20: rsh Unencrypted Cleartext Login
# Desabilitar serviço rsh
systemctl disable rsh.socket
systemctl stop rsh.socket

# Vulnerabilidade 21: SSL/TLS: OpenSSL CCS Man in the Middle Security Bypass Vulnerability
# Atualizar o OpenSSL para a versão segura
apt-get install --only-upgrade openssl -y

# Vulnerabilidade 22: Multiple Vendors STARTTLS Implementation Plaintext Arbitrary Command Injection Vulnerability
# Atualizar o Postfix para a versão segura
apt-get install --only-upgrade postfix -y

# Vulnerabilidade 23: TWiki Cross-Site Request Forgery Vulnerability (Sep 2010)
# Atualizar o TWiki para a versão 4.3.2 ou superior
wget https://downloads.sourceforge.net/project/twiki/TWiki%20for%20all%20Platforms/4.3.2/TWiki-4.3.2.zip
unzip TWiki-4.3.2.zip -d /var/www/html/
rm TWiki-4.3.2.zip
chown -R www-data:www-data /var/www/html/TWiki

# Vulnerabilidade 24: Anonymous FTP Login Reporting
# Desabilitar logins anônimos no FTP
sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
service vsftpd restart

# Vulnerabilidade 25: jQuery < 1.9.0 XSS Vulnerability
# Atualizar o jQuery para a versão 1.9.0 ou superior
wget https://code.jquery.com/jquery-1.9.0.min.js -O /var/www/html/mutillidae/javascript/ddsmoothmenu/jquery.min.js

# Vulnerabilidade 26: TWiki < 6.1.0 XSS Vulnerability
# Atualizar o TWiki para a versão 6.1.0 ou superior
wget https://downloads.sourceforge.net/project/twiki/TWiki%20for%20all%20Platforms/6.1.0/TWiki-6.1.0.zip
unzip TWiki-6.1.0.zip -d /var/www/html/
rm TWiki-6.1.0.zip
chown -R www-data:www-data /var/www/html/TWiki

# Vulnerabilidade 27: TWiki CSRF Vulnerability
# Atualizar o TWiki para a versão 4.3.1 ou superior
wget https://downloads.sourceforge.net/project/twiki/TWiki%20for%20all%20Platforms/4.3.1/TWiki-4.3.1.zip
unzip TWiki-4.3.1.zip -d /var/www/html/
rm TWiki-4.3.1.zip
chown -R www-data:www-data /var/www/html/TWiki

# Vulnerabilidade 28: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
# Desabilitar SSLv2 e SSLv3 no Apache
sed -i 's/SSLProtocol all -SSLv2/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
service apache2 reload

# Vulnerabilidade 29: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
# Desabilitar SSLv2 e SSLv3 no Postfix
postconf -e 'smtpd_tls_protocols = !SSLv2, !SSLv3'
service postfix reload

# Vulnerabilidade 30: SSL/TLS: Report Weak Cipher Suites
# Desabilitar cifras fracas no Apache
sed -i 's/SSLCipherSuite HIGH:MEDIUM:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4:!DES/' /etc/apache2/mods-enabled/ssl.conf
service apache2 reload

# Vulnerabilidade 31: HTTP Debugging Methods (TRACE/TRACK) Enabled
# Desabilitar métodos TRACE e TRACK no Apache
echo "TraceEnable off" | tee -a /etc/apache2/apache2.conf
service apache2 reload

# Vulnerabilidade 32: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
# Gerar um novo certificado com chave RSA de 2048 bits
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/ssl-cert-snakeoil.key -out /etc/ssl/certs/ssl-cert-snakeoil.pem

# Vulnerabilidade 33: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
# Gerar um novo certificado com chave RSA de 2048 bits
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/ssl-cert-snakeoil.key -out /etc/ssl/certs/ssl-cert-snakeoil.pem

# Vulnerabilidade 34: Weak Key Exchange (KEX) Algorithm(s) Supported (SSH)
# Desabilitar algoritmos KEX fracos no SSH
echo "KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256" | tee -a /etc/ssh/sshd_config
service ssh restart

# Vulnerabilidade 35: phpinfo() Output Reporting (HTTP)
# Remover arquivos phpinfo.php
rm /var/www/html/mutillidae/phpinfo.php
rm /var/www/html/phpinfo.php

# Vulnerabilidade 36: Weak Host Key Algorithm(s) (SSH)
# Desabilitar algoritmos de chave de host fracos no SSH
echo "HostKeyAlgorithms ssh-rsa,ssh-ed25519" | tee -a /etc/ssh/sshd_config
service ssh restart

# Vulnerabilidade 37: Check if Mailserver answer to VRFY and EXPN requests
# Desabilitar comandos VRFY e EXPN no Postfix
postconf -e 'disable_vrfy_command=yes'
service postfix reload

# Vulnerabilidade 38: SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
# Desabilitar renegociação no Postfix
postconf -e 'smtpd_tls_renegotiation_limit=0'
service postfix reload

# Vulnerabilidade 39: SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
# Desabilitar renegociação no PostgreSQL
echo "ssl_renegotiation_limit = 0" | tee -a /etc/postgresql/9.5/main/postgresql.conf
service postgresql restart

# Vulnerabilidade 40: SSL/TLS: Certificate Expired
# Gerar um novo certificado
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/ssl-cert-snakeoil.key -out /etc/ssl/certs/ssl-cert-snakeoil.pem

# Vulnerabilidade 41: SSL/TLS: Certificate Expired
# Gerar um novo certificado
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/ssl-cert-snakeoil.key -out /etc/ssl/certs/ssl-cert-snakeoil.pem

# Vulnerabilidade 42: QWikiwiki directory traversal vulnerability
# Remover QWikiwiki
apt-get remove --purge qwikiwiki -y

# Vulnerabilidade 43: awiki <= 20100125 Multiple LFI Vulnerabilities - Active Check
# Remover awiki
apt-get remove --purge awiki -y

# Vulnerabilidade 44: /doc directory browsable
# Restringir acesso ao diretório /doc
echo "<Directory /usr/doc>
AllowOverride None
order deny, allow
deny from all
allow from localhost
</Directory>" | tee -a /etc/apache2/apache2.conf
service apache2 reload

# Vulnerabilidade 45: Telnet Unencrypted Cleartext Login
# Desabilitar serviço Telnet
systemctl disable telnet.socket
systemctl stop telnet.socket

# Vulnerabilidade 46: FTP Unencrypted Cleartext Login
# Habilitar FTPS no vsftpd
echo "ssl_enable=YES" | tee -a /etc/vsftpd.conf
service vsftpd restart

# Vulnerabilidade 47: VNC Server Unencrypted Data Transmission
# Habilitar encriptação no VNC
vncserver -localhost -SecurityTypes=VncAuth,Plain

# Vulnerabilidade 48: FTP Unencrypted Cleartext Login
# Habilitar FTPS no vsftpd
echo "ssl_enable=YES" | tee -a /etc/vsftpd.conf
service vsftpd restart

# Vulnerabilidade 49: Cleartext Transmission of Sensitive Information via HTTP
# Forçar HTTPS no Apache
a2enmod ssl
a2ensite default-ssl
service apache2 restart

# Vulnerabilidade 50: SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
# Desabilitar TLSv1.0 e TLSv1.1 no Apache
sed -i 's/SSLProtocol all -SSLv2/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/' /etc/apache2/mods-enabled/ssl.conf
service apache2 reload

# Vulnerabilidade 51: Weak Encryption Algorithm(s) Supported (SSH)
# Desabilitar algoritmos de encriptação fracos no SSH
echo "Ciphers aes256-ctr,aes192-ctr,aes128-ctr" | tee -a /etc/ssh/sshd_config
service ssh restart

# Vulnerabilidade 52: Apache HTTP Server httpOnly Cookie Information Disclosure Vulnerability
# Atualizar o Apache HTTP Server para a versão 2.2.22 ou superior
apt-get install --only-upgrade apache2 -y

# Vulnerabilidade 53: phpMyAdmin error.php Cross Site Scripting Vulnerability
# Remover phpMyAdmin
apt-get remove --purge phpmyadmin -y

# Vulnerabilidade 54: SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
# Desabilitar TLSv1.0 e TLSv1.1 no Postfix
postconf -e 'smtpd_tls_protocols = !SSLv2, !SSLv3, !TLSv1, !TLSv1.1'
service postfix reload

# Vulnerabilidade 55: jQuery < 1.6.3 XSS Vulnerability
# Atualizar o jQuery para a versão 1.6.3 ou superior
wget https://code.jquery.com/jquery-1.6.3.min.js -O /var/www/html/mutillidae/javascript/ddsmoothmenu/jquery.min.js

# Vulnerabilidade 56: SSL/TLS: RSA Temporary Key Handling RSA_EXPORT Downgrade Issue (FREAK)
# Desabilitar cifras RSA_EXPORT no Apache
sed -i 's/SSLCipherSuite HIGH:MEDIUM:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4:!DES:!RSA_EXPORT/' /etc/apache2/mods-enabled/ssl.conf
service apache2 reload

# Vulnerabilidade 57: SSL/TLS: Certificate Signed Using A Weak Signature Algorithm
# Gerar um novo certificado com SHA-2
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/ssl-cert-snakeoil.key -out /etc/ssl/certs/ssl-cert-snakeoil.pem

# Vulnerabilidade 58: SSL/TLS: Diffie-Hellman Key Exchange Insufficient DH Group Strength Vulnerability
# Utilizar grupo Diffie-Hellman de 2048 bits no Apache
openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048
sed -i 's/#\SSLHonorCipherOrder on/SSLHonorCipherOrder on\nSSLOpenSSLConfCmd DHParameters "\/etc\/ssl\/certs\/dhparam.pem"/' /etc/apache2/mods-enabled/ssl.conf
service apache2 reload

# Vulnerabilidade 59: SSL/TLS: Diffie-Hellman Key Exchange Insufficient DH Group Strength Vulnerability
# Utilizar grupo Diffie-Hellman de 2048 bits no Postfix
postconf -e 'smtpd_tls_dh1024_param_file=/etc/ssl/certs/dhparam.pem'
service postfix reload

# Vulnerabilidade 60: SSL/TLS: Certificate Signed Using A Weak Signature Algorithm
# Gerar um novo certificado com SHA-2
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/ssl-cert-snakeoil.key -out /etc/ssl/certs/ssl-cert-snakeoil.pem

# Vulnerabilidade 61: SSL/TLS: DHE_EXPORT MITM Security Bypass Vulnerability (LogJam)
# Desabilitar cifras DHE_EXPORT no Apache
sed -i 's/SSLCipherSuite HIGH:MEDIUM:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!RC4:!DES:!DHE_EXPORT/' /etc/apache2/mods-enabled/ssl.conf
service apache2 reload

# Vulnerabilidade 62: SSL/TLS: SSLv3 Protocol CBC Cipher Suites Information Disclosure Vulnerability (POODLE)
# Desabilitar SSLv3 no Apache
sed -i 's/SSLProtocol all -SSLv2/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
service apache2 reload

# Vulnerabilidade 63: SSL/TLS: SSLv3 Protocol CBC Cipher Suites Information Disclosure Vulnerability (POODLE)
# Desabilitar SSLv3 no Postfix
postconf -e 'smtpd_tls_protocols = !SSLv2, !SSLv3'
service postfix reload

# Vulnerabilidade 64: Weak MAC Algorithm(s) Supported (SSH)
# Desabilitar algoritmos MAC fracos no SSH
echo "MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com" | tee -a /etc/ssh/sshd_config
service ssh restart

# Vulnerabilidade 65: TCP Timestamps Information Disclosure
# Desabilitar timestamps TCP
echo "net.ipv4.tcp_timestamps = 0" | tee -a /etc/sysctl.conf
sysctl -p

# Vulnerabilidade 66: ICMP Timestamp Reply Information Disclosure
# Desabilitar respostas ICMP timestamp
echo "net.ipv4.icmp_echo_ignore_all = 1" | tee -a /etc/sysctl.conf
sysctl -p}
{type: uploaded file
fileName: metasploitable66VT_21.txt
fullContent:
#!/bin/bash

# Atualizar o sistema operacional
sudo apt-get update && sudo apt-get upgrade -y

# Desabilitar serviços desnecessários e inseguros
sudo systemctl stop rlogin
sudo systemctl disable rlogin
sudo systemctl stop rsh
sudo systemctl disable rsh
sudo systemctl stop rexec
sudo systemctl disable rexec
sudo systemctl stop vsftpd
sudo systemctl disable vsftpd
sudo systemctl stop telnet
sudo systemctl disable telnet

# Corrigir permissões de arquivos sensíveis
sudo chmod 600 /etc/passwd /etc/shadow

# Configurar o fail2ban para bloquear tentativas de força bruta
sudo apt-get install fail2ban -y
sudo systemctl enable fail2ban
sudo systemctl start fail2ban

# Configurar o SSH para maior segurança
sudo sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin no/' /etc/ssh/sshd_config
sudo sed -i 's/#PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config
sudo systemctl restart ssh

# Configurar o Apache para desativar métodos HTTP perigosos
sudo a2dismod cgi
sudo a2dismod status
sudo sed -i 's/Options Indexes FollowSymLinks/Options -Indexes FollowSymLinks/' /etc/apache2/apache2.conf
sudo systemctl restart apache2

# Configurar o MySQL/MariaDB para usar autenticação segura
sudo mysql_secure_installation

# Desativar SSLv3 e TLSv1.0/TLSv1.1 no Apache
sudo sed -i 's/SSLProtocol all -SSLv3 -TLSv1/SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Configurar o PHP para segurança adicional
sudo sed -i 's/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/' /etc/php/7.4/apache2/php.ini
sudo systemctl restart apache2

# Configurar o VNC para usar autenticação segura
sudo sed -i 's/SecurityTypes=VncAuth/SecurityTypes=VncAuth,TLS/' /etc/vnc/config.d/common.conf
sudo systemctl restart vncserver

# Configurar o PostgreSQL para usar autenticação segura
sudo sed -i 's/host    all             all             127.0.0.1\/32            trust/host    all             all             127.0.0.1\/32            md5/' /etc/postgresql/12/main/pg_hba.conf
sudo systemctl restart postgresql

# Configurar o PHPMyAdmin para usar autenticação segura
sudo sed -i 's/$cfg['Servers'][$i]['auth_type'] = 'cookie';/$cfg['Servers'][$i]['auth_type'] = 'config';/' /etc/phpmyadmin/config.inc.php

# Configurar o Tomcat para desativar o conector AJP
sudo sed -i '/<Connector port="8009" protocol="AJP\/1.3" redirectPort="8443" \/>/d' /etc/tomcat9/server.xml
sudo systemctl restart tomcat9

# Configurar o distcc para usar autenticação
sudo sed -i 's/--allow/--allow 127.0.0.1/' /etc/default/distcc
sudo systemctl restart distcc

# Configurar o openssl para segurança adicional
sudo sed -i 's/CipherString = DEFAULT@SECLEVEL=2/CipherString = DEFAULT@SECLEVEL=2:!aNULL:!eNULL:!LOW:!3DES:!MD5:!RC4:!SHA1:!SHA256:!SHA384/' /etc/ssl/openssl.cnf

# Configurar o fail2ban para bloquear tentativas de força bruta
sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local
sudo sed -i 's/bantime  = 10m/bantime  = 24h/' /etc/fail2ban/jail.local
sudo sed -i 's/findtime  = 10m/findtime  = 1h/' /etc/fail2ban/jail.local
sudo sed -i 's/maxretry = 5/maxretry = 3/' /etc/fail2ban/jail.local
sudo systemctl restart fail2ban}
{type: uploaded file
fileName: metasploitable66VT_22.txt
fullContent:
#!/bin/bash
# Vulnerabilidade 1: TWiki XSS and Command Execution Vulnerabilities
wget https://sourceforge.net/projects/twiki/files/TWiki/TWiki-4.2.4/TWiki-4.2.4.zip/download -O twiki.zip
unzip twiki.zip -d /var/www/html/twiki
rm twiki.zip

# Vulnerabilidade 2: Distributed Ruby (dRuby/DRb) Multiple RCE Vulnerabilities
gem update drb
echo "SAFE=2" >> /etc/environment

# Vulnerabilidade 3: rlogin Passwordless Login
systemctl disable rlogin
systemctl stop rlogin

# Vulnerabilidade 4: Operating System (OS) End of Life (EOL) Detection
do-release-upgrade

# Vulnerabilidade 5: The rexec service is running
systemctl disable rexec
systemctl stop rexec

# Vulnerabilidade 6: Possible Backdoor: Ingreslock
iptables -A INPUT -p tcp --dport 1524 -j DROP

# Vulnerabilidade 7: Apache Tomcat AJP RCE Vulnerability (Ghostcat)
wget https://downloads.apache.org/tomcat/tomcat-9/v9.0.31/bin/apache-tomcat-9.0.31.tar.gz
tar -xzf apache-tomcat-9.0.31.tar.gz -C /opt/
rm apache-tomcat-9.0.31.tar.gz

# Vulnerabilidade 8: MySQL / MariaDB Default Credentials (MySQL Protocol)
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'NewStrongPassword';"

# Vulnerabilidade 9: PHP < 5.6.30, 7.x < 7.0.15, 7.1.x < 7.1.1 Multiple Vulnerabilities
apt-get update
apt-get install php7.3 -y

# Vulnerabilidade 10: PHP < 5.3.13, 5.4.x < 5.4.3 Multiple Vulnerabilities
apt-get update
apt-get install php7.3 -y

# Vulnerabilidade 11: vsftpd Compromised Source Packages Backdoor Vulnerability
apt-get update
apt-get install vsftpd -y

# Vulnerabilidade 12: vsftpd Compromised Source Packages Backdoor Vulnerability
apt-get update
apt-get install vsftpd -y

# Vulnerabilidade 13: DistCC RCE Vulnerability (CVE-2004-2687)
iptables -A INPUT -p tcp --dport 3632 -j DROP

# Vulnerabilidade 14: PostgreSQL Default Credentials (PostgreSQL Protocol)
psql -U postgres -c "ALTER USER postgres WITH PASSWORD 'NewStrongPassword';"

# Vulnerabilidade 15: VNC Brute Force Login
iptables -A INPUT -p tcp --dport 5900 -j DROP

# Vulnerabilidade 16: Test HTTP dangerous methods
iptables -A INPUT -p tcp --dport 80 -m multiport --dports 80,443 -j DROP

# Vulnerabilidade 17: FTP Brute Force Logins With Default Credentials Reporting
iptables -A INPUT -p tcp --dport 21 -j DROP

# Vulnerabilidade 18: FTP Brute Force Logins With Default Credentials Reporting
iptables -A INPUT -p tcp --dport 2121 -j DROP

# Vulnerabilidade 19: The rlogin service is running
systemctl disable rlogin
systemctl stop rlogin

# Vulnerabilidade 20: rsh Unencrypted Cleartext Login
systemctl disable rsh
systemctl stop rsh

# Vulnerabilidade 21: SSL/TLS: OpenSSL CCS Man in the Middle Security Bypass Vulnerability
apt-get update
apt-get install openssl -y

# Vulnerabilidade 22: Multiple Vendors STARTTLS Implementation Plaintext Arbitrary Command Injection Vulnerability
iptables -A INPUT -p tcp --dport 25 -j DROP

# Vulnerabilidade 23: TWiki Cross-Site Request Forgery Vulnerability (Sep 2010)
wget https://sourceforge.net/projects/twiki/files/TWiki/TWiki-4.3.2/TWiki-4.3.2.zip/download -O twiki.zip
unzip twiki.zip -d /var/www/html/twiki
rm twiki.zip

# Vulnerabilidade 24: Anonymous FTP Login Reporting
iptables -A INPUT -p tcp --dport 21 -j DROP

# Vulnerabilidade 25: jQuery < 1.9.0 XSS Vulnerability
wget https://code.jquery.com/jquery-1.12.4.min.js -O /var/www/html/mutillidae/javascript/ddsmoothmenu/jquery.min.js

# Vulnerabilidade 26: TWiki < 6.1.0 XSS Vulnerability
wget https://sourceforge.net/projects/twiki/files/TWiki/TWiki-6.1.0/TWiki-6.1.0.zip/download -O twiki.zip
unzip twiki.zip -d /var/www/html/twiki
rm twiki.zip

# Vulnerabilidade 27: TWiki CSRF Vulnerability
wget https://sourceforge.net/projects/twiki/files/TWiki/TWiki-4.3.1/TWiki-4.3.1.zip/download -O twiki.zip
unzip twiki.zip -d /var/www/html/twiki
rm twiki.zip

# Vulnerabilidade 28: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
iptables -A INPUT -p tcp --dport 5432 -j DROP

# Vulnerabilidade 29: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
iptables -A INPUT -p tcp --dport 25 -j DROP

# Vulnerabilidade 30: SSL/TLS: Report Weak Cipher Suites
iptables -A INPUT -p tcp --dport 5432 -j DROP

# Vulnerabilidade 31: HTTP Debugging Methods (TRACE/TRACK) Enabled
iptables -A INPUT -p tcp --dport 80 -j DROP

# Vulnerabilidade 32: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
iptables -}
{type: uploaded file
fileName: metasploitable66VT_23.txt
fullContent:
#!/bin/bash

# Verifica se o usuário é root
if [ "$EUID" -ne 0 ]; then
  echo "Por favor, execute como root."
  exit 1
fi

# Atualiza o sistema
apt-get update && apt-get upgrade -y

# Corrige a Vulnerabilidade 1 (TWiki XSS and Command Execution Vulnerabilities)
apt-get install twiki -y

# Corrige a Vulnerabilidade 3 (rlogin Passwordless Login)
systemctl disable rlogin.socket
systemctl stop rlogin.socket

# Corrige a Vulnerabilidade 5 (rexec service is running)
systemctl disable rexec
systemctl stop rexec

# Corrige a Vulnerabilidade 7 (Apache Tomcat AJP RCE Vulnerability)
apt-get install apache-tomcat -y

# Corrige a Vulnerabilidade 11 (vsftpd Compromised Source Packages Backdoor Vulnerability)
apt-get install vsftpd -y

# Corrige a Vulnerabilidade 13 (DistCC RCE Vulnerability)
apt-get install distcc -y

# Corrige a Vulnerabilidade 15 (VNC Brute Force Login)
apt-get install vnc4server -y

# Corrige a Vulnerabilidade 16 (Test HTTP dangerous methods)
a2dismod include
a2dismod autoindex
a2dismod userdir
systemctl restart apache2

# Corrige a Vulnerabilidade 19 (rlogin service is running)
systemctl disable rlogin.socket
systemctl stop rlogin.socket

# Corrige a Vulnerabilidade 20 (rsh Unencrypted Cleartext Login)
systemctl disable rsh
systemctl stop rsh

# Corrige a Vulnerabilidade 45 (Telnet Unencrypted Cleartext Login)
systemctl disable telnet
systemctl stop telnet

# Corrige a Vulnerabilidade 46 (FTP Unencrypted Cleartext Login)
systemctl disable vsftpd
systemctl stop vsftpd

# Corrige a Vulnerabilidade 47 (VNC Server Unencrypted Data Transmission)
systemctl disable vncserver
systemctl stop vncserver

echo "Correções aplicadas com sucesso!"}
{type: uploaded file
fileName: metasploitable66VT_24.txt
fullContent:
#!/bin/bash

# Corrigir vulnerabilidades do TWiki
TWIKI_VERSION=$(twiki -v 2>&1 | grep "TWiki version" | awk '{print $3}')
if [[ "$TWIKI_VERSION" < "4.2.4" ]]; then
    wget http://twiki.org/pub/TWiki/TWikiRelease/TWiki-4.2.4.zip
    unzip TWiki-4.2.4.zip
    cp -r TWiki-4.2.4/* /var/www/twiki/
    chown -R www-data:www-data /var/www/twiki/
    rm -rf TWiki-4.2.4.zip TWiki-4.2.4
fi

# Corrigir vulnerabilidade do dRuby
if systemctl is-active --quiet drb; then
    echo "drb.service" >> /etc/systemd/system/drb.service.d/override.conf
    echo "LoadCredential=null" >> /etc/systemd/system/drb.service.d/override.conf
    systemctl daemon-reload
    systemctl restart drb
fi

# Corrigir vulnerabilidade do rlogin
if systemctl is-active --quiet rlogin; then
    systemctl stop rlogin
    systemctl disable rlogin
fi

# Corrigir vulnerabilidade do rexec
if systemctl is-active --quiet rexec; then
    systemctl stop rexec
    systemctl disable rexec
fi

# Corrigir vulnerabilidade do Ingreslock
if systemctl is-active --quiet ingreslock; then
    systemctl stop ingreslock
    systemctl disable ingreslock
fi

# Corrigir vulnerabilidade do Ghostcat
if systemctl is-active --quiet tomcat; then
    wget https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.31/bin/apache-tomcat-9.0.31.tar.gz
    tar -xzf apache-tomcat-9.0.31.tar.gz -C /opt/
    systemctl stop tomcat
    rm -rf /opt/tomcat
    mv /opt/apache-tomcat-9.0.31 /opt/tomcat
    systemctl start tomcat
    rm -f apache-tomcat-9.0.31.tar.gz
fi

# Corrigir vulnerabilidade do MySQL
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'NewSecurePassword';"

# Corrigir vulnerabilidade do PHP
PHP_VERSION=$(php -v | grep "PHP" | awk '{print $2}')
if [[ "$PHP_VERSION" < "5.6.30" ]]; then
    apt-get update
    apt-get install -y php5.6
fi

# Corrigir vulnerabilidade do VNC
if systemctl is-active --quiet vncserver; then
    systemctl stop vncserver
    systemctl disable vncserver
fi

# Corrigir vulnerabilidade de métodos HTTP perigosos
if systemctl is-active --quiet apache2; then
    echo "<Directory /var/www/html>
        AllowMethods GET POST HEAD
    </Directory>" >> /etc/apache2/apache2.conf
    systemctl restart apache2
fi

# Corrigir vulnerabilidade do FTP
if systemctl is-active --quiet vsftpd; then
    echo "anonymous_enable=NO" >> /etc/vsftpd.conf
    systemctl restart vsftpd
fi

# Corrigir vulnerabilidade do SSH
SSH_CONFIG="/etc/ssh/sshd_config"
if grep -q "Ciphers aes128-ctr,aes192-ctr,aes256-ctr" $SSH_CONFIG; then
    echo "Ciphers aes128-ctr,aes192-ctr,aes256-ctr" >> $SSH_CONFIG
    systemctl restart sshd
fi

# Corrigir vulnerabilidade SSL/TLS
if systemctl is-active --quiet apache2; then
    a2enmod ssl
    a2ensite default-ssl
    systemctl restart apache2
fi

# Corrigir vulnerabilidade do Telnet
if systemctl is-active --quiet telnet; then
    systemctl stop telnet
    systemctl disable telnet
fi

# Corrigir vulnerabilidade do ICMP
echo "net.ipv4.icmp_echo_ignore_all=1" >> /etc/sysctl.conf
sysctl -p}
{type: uploaded file
fileName: metasploitable66VT_25.txt
fullContent:
#!/bin/bash
# Atualiza o sistema operacional
sudo apt update && sudo apt upgrade -y

# Desabilita serviços inseguros
sudo systemctl stop rlogin
sudo systemctl disable rlogin
sudo systemctl stop rsh
sudo systemctl disable rsh
sudo systemctl stop rexec
sudo systemctl disable rexec

# Instala e configura o SSH
sudo apt install openssh-server -y
sudo systemctl enable ssh
sudo systemctl start ssh

# Atualiza o Apache Tomcat para a versão mais recente
sudo apt install tomcat9 -y
sudo systemctl restart tomcat9

# Altera senhas padrão do MySQL e PostgreSQL
sudo mysql -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'NovaSenhaSegura123!';"
sudo -u postgres psql -c "ALTER USER postgres WITH PASSWORD 'NovaSenhaSegura123!';"

# Desabilita o VNC
sudo systemctl stop vncserver
sudo systemctl disable vncserver

# Configura firewall para bloquear portas inseguras
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow ssh
sudo ufw allow http
sudo ufw allow https
sudo ufw enable

# Remove arquivos e diretórios inseguros
sudo rm -rf /doc
sudo rm -rf /usr/share/phpMyAdmin/test

# Reinicia os serviços para aplicar as mudanças
sudo systemctl restart apache2
sudo systemctl restart mysql
sudo systemctl restart postgresql}
