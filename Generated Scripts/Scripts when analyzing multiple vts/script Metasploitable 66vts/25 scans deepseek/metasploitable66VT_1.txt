#!/bin/bash

# Vulnerabilidade 1: TWiki XSS and Command Execution Vulnerabilities
sudo apt-get update
sudo apt-get install -y twiki
sudo sed -i 's/Installed version: 01.Feb.2003/Fixed version: 4.2.4/' /path/to/twiki/config

# Vulnerabilidade 2: Distributed Ruby (dRuby/DRb) Multiple RCE Vulnerabilities
sudo gem update drb
sudo sed -i 's/$SAFE = 1/$SAFE = 2/' /path/to/ruby/config

# Vulnerabilidade 3: rlogin Passwordless Login
sudo systemctl stop rlogin
sudo systemctl disable rlogin

# Vulnerabilidade 4: Operating System (OS) End of Life (EOL) Detection
sudo do-release-upgrade

# Vulnerabilidade 5: The rexec service is running
sudo systemctl stop rexec
sudo systemctl disable rexec

# Vulnerabilidade 6: Possible Backdoor: Ingreslock
sudo apt-get remove --purge -y ingreslock
sudo rm -rf /usr/bin/ingreslock

# Vulnerabilidade 7: Apache Tomcat AJP RCE Vulnerability (Ghostcat)
sudo apt-get update
sudo apt-get install -y tomcat9
sudo systemctl restart tomcat9

# Vulnerabilidade 8: MySQL / MariaDB Default Credentials (MySQL Protocol)
mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'NewStrongPassword';"

# Vulnerabilidade 9: PHP < 5.6.30, 7.x < 7.0.15, 7.1.x < 7.1.1 Multiple Vulnerabilities (Jan 2017) - Linux
sudo apt-get update
sudo apt-get install -y php7.0

# Vulnerabilidade 10: PHP < 5.3.13, 5.4.x < 5.4.3 Multiple Vulnerabilities - Active Check
sudo apt-get update
sudo apt-get install -y php5.6

# Vulnerabilidade 11: vsftpd Compromised Source Packages Backdoor Vulnerability
sudo apt-get remove --purge -y vsftpd
sudo apt-get install -y vsftpd

# Vulnerabilidade 12: vsftpd Compromised Source Packages Backdoor Vulnerability
sudo apt-get remove --purge -y vsftpd
sudo apt-get install -y vsftpd

# Vulnerabilidade 13: DistCC RCE Vulnerability (CVE-2004-2687)
sudo apt-get remove --purge -y distcc

# Vulnerabilidade 14: PostgreSQL Default Credentials (PostgreSQL Protocol)
sudo -u postgres psql -c "ALTER USER postgres WITH PASSWORD 'NewStrongPassword';"

# Vulnerabilidade 15: VNC Brute Force Login
sudo apt-get install -y tightvncserver
vncpasswd

# Vulnerabilidade 16: Test HTTP dangerous methods
sudo a2dismod include
sudo systemctl restart apache2

# Vulnerabilidade 17: FTP Brute Force Logins With Default Credentials Reporting
sudo passwd msfadmin
sudo passwd postgres
sudo passwd service
sudo passwd user

# Vulnerabilidade 18: FTP Brute Force Logins With Default Credentials Reporting
sudo passwd msfadmin
sudo passwd postgres
sudo passwd service
sudo passwd user

# Vulnerabilidade 19: The rlogin service is running
sudo systemctl stop rlogin
sudo systemctl disable rlogin

# Vulnerabilidade 20: rsh Unencrypted Cleartext Login
sudo systemctl stop rsh
sudo systemctl disable rsh

# Vulnerabilidade 21: SSL/TLS: OpenSSL CCS Man in the Middle Security Bypass Vulnerability
sudo apt-get update
sudo apt-get install -y openssl

# Vulnerabilidade 22: Multiple Vendors STARTTLS Implementation Plaintext Arbitrary Command Injection Vulnerability
sudo apt-get update
sudo apt-get install -y postfix

# Vulnerabilidade 23: TWiki Cross-Site Request Forgery Vulnerability (Sep 2010)
sudo apt-get update
sudo apt-get install -y twiki

# Vulnerabilidade 24: Anonymous FTP Login Reporting
sudo sed -i 's/anonymous_enable=YES/anonymous_enable=NO/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 25: jQuery < 1.9.0 XSS Vulnerability
sudo apt-get update
sudo apt-get install -y jquery

# Vulnerabilidade 26: TWiki < 6.1.0 XSS Vulnerability
sudo apt-get update
sudo apt-get install -y twiki

# Vulnerabilidade 27: TWiki CSRF Vulnerability
sudo apt-get update
sudo apt-get install -y twiki

# Vulnerabilidade 28: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
sudo a2enmod ssl
sudo sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 29: SSL/TLS: Deprecated SSLv2 and SSLv3 Protocol Detection
sudo a2enmod ssl
sudo sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 30: SSL/TLS: Report Weak Cipher Suites
sudo sed -i 's/SSLCipherSuite HIGH:MEDIUM:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 31: HTTP Debugging Methods (TRACE/TRACK) Enabled
sudo a2dismod trace
sudo systemctl restart apache2

# Vulnerabilidade 32: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 33: SSL/TLS: Server Certificate / Certificate in Chain with RSA keys less than 2048 bits
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 34: Weak Key Exchange (KEX) Algorithm(s) Supported (SSH)
sudo sed -i 's/KexAlgorithms diffie-hellman-group-exchange-sha1,diffie-hellman-group1-sha1/KexAlgorithms curve25519-sha256@libssh.org/' /etc/ssh/sshd_config
sudo systemctl restart sshd

# Vulnerabilidade 35: phpinfo() Output Reporting (HTTP)
sudo rm -f /var/www/html/phpinfo.php

# Vulnerabilidade 36: Weak Host Key Algorithm(s) (SSH)
sudo sed -i 's/HostKeyAlgorithms ssh-dss/HostKeyAlgorithms ssh-rsa/' /etc/ssh/sshd_config
sudo systemctl restart sshd

# Vulnerabilidade 37: Check if Mailserver answer to VRFY and EXPN requests
sudo sed -i 's/smtpd_discard_ehlo_keywords =/smtpd_discard_ehlo_keywords = vrfy, expn/' /etc/postfix/main.cf
sudo systemctl restart postfix

# Vulnerabilidade 38: SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
sudo sed -i 's/SSLProtocol all/SSLProtocol all -ClientRenegotiation/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 39: SSL/TLS: Renegotiation DoS Vulnerability (CVE-2011-1473, CVE-2011-5094)
sudo sed -i 's/SSLProtocol all/SSLProtocol all -ClientRenegotiation/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 40: SSL/TLS: Certificate Expired
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 41: SSL/TLS: Certificate Expired
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt

# Vulnerabilidade 42: QWikiwiki directory traversal vulnerability
sudo rm -rf /var/www/html/qwikiwiki

# Vulnerabilidade 43: awiki <= 20100125 Multiple LFI Vulnerabilities - Active Check
sudo rm -rf /var/www/html/awiki

# Vulnerabilidade 44: /doc directory browsable
sudo sed -i 's/<Directory \/usr\/doc>/<Directory \/usr\/doc>\n    AllowOverride None\n    order deny,allow\n    deny from all\n    allow from localhost\n<\/Directory>/' /etc/apache2/apache2.conf
sudo systemctl restart apache2

# Vulnerabilidade 45: Telnet Unencrypted Cleartext Login
sudo systemctl stop telnet
sudo systemctl disable telnet

# Vulnerabilidade 46: FTP Unencrypted Cleartext Login
sudo sed -i 's/ssl_enable=NO/ssl_enable=YES/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 47: VNC Server Unencrypted Data Transmission
sudo apt-get install -y tightvncserver
vncpasswd

# Vulnerabilidade 48: FTP Unencrypted Cleartext Login
sudo sed -i 's/ssl_enable=NO/ssl_enable=YES/' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Vulnerabilidade 49: Cleartext Transmission of Sensitive Information via HTTP
sudo a2enmod ssl
sudo a2ensite default-ssl
sudo systemctl restart apache2

# Vulnerabilidade 50: SSL/TLS: Deprecated TLSv1.0 and TLSv1.1 Protocol Detection
sudo sed -i 's/SSLProtocol all -SSLv2 -SSLv3/SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1/' /etc/apache2/mods-enabled/ssl.conf
sudo systemctl restart apache2

# Vulnerabilidade 51: Weak Encryption Algorithm(s) Supported (SSH)
sudo sed -i 's/Ciphers 3des-cbc,aes128-cbc,aes192-cbc,aes256-cbc,arcfour,arcfour128,arcfour256,blowfish-cbc,cast128-cbc,rijndael-c