#!/bin/bash
# Vulnerabilidade 1: Enforce SSL/TLS for sensitive data transmission
sed -i 's/Listen 80/Listen 443/g' /etc/apache2/ports.conf
a2enmod ssl
systemctl restart apache2

# Vulnerabilidade 2: Disable DNS recursion
sed -i 's/recursion yes;/recursion no;/g' /etc/named.conf
systemctl restart named

# Vulnerabilidade 3: Disable ICMP timestamp
echo "net.ipv4.icmp_echo_ignore_all = 1" >> /etc/sysctl.conf
sysctl -p

# Vulnerabilidade 4: Disable deprecated TLSv1.0 and TLSv1.1
sed -i 's/SSLProtocol all -SSLv3/SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1/g' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 5: Disable SSL/TLS renegotiation
sed -i 's/SSLInsecureRenegotiation on/SSLInsecureRenegotiation off/g' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 6: Remove weak SSL/TLS cipher suites
sed -i 's/SSLCipherSuite HIGH:!aNULL:!MD5/SSLCipherSuite HIGH:!aNULL:!MD5:!ADH:!RC4:!DES:!3DES:!DSS/g' /etc/apache2/mods-enabled/ssl.conf
systemctl restart apache2

# Vulnerabilidade 7: Disable TCP timestamps
echo "net.ipv4.tcp_timestamps = 0" >> /etc/sysctl.conf
sysctl -p