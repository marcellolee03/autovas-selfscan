#!/bin/bash
# Vulnerabilidade 1: Enforce HTTPS for sensitive data
sed -i 's/^http:/https:/g' /etc/nginx/sites-available/default
systemctl restart nginx

# Vulnerabilidade 2: Disable DNS recursion
sed -i 's/^recursion yes/recursion no/g' /etc/named.conf
systemctl restart named

# Vulnerabilidade 3: Disable ICMP timestamp
echo "net.ipv4.icmp_echo_ignore_all=1" >> /etc/sysctl.conf
sysctl -p

# Vulnerabilidade 4: Disable TLSv1.0 and TLSv1.1
sed -i 's/TLSv1.1//g' /etc/nginx/nginx.conf
sed -i 's/TLSv1.0//g' /etc/nginx/nginx.conf
systemctl restart nginx

# Vulnerabilidade 5: Disable SSL/TLS renegotiation
sed -i 's/ssl_renegotiation on/ssl_renegotiation off/g' /etc/nginx/nginx.conf
systemctl restart nginx

# Vulnerabilidade 6: Disable weak SSL/TLS cipher suites
sed -i 's/ssl_ciphers .*/ssl_ciphers HIGH:!aNULL:!MD5:!EXP:!PSK:!SRP:!DSS;/g' /etc/nginx/nginx.conf
systemctl restart nginx

# Vulnerabilidade 7: Disable TCP timestamps
echo "net.ipv4.tcp_timestamps = 0" >> /etc/sysctl.conf
sysctl -p