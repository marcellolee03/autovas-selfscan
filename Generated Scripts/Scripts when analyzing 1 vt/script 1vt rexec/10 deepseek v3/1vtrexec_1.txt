#!/bin/bash
systemctl stop rexec.socket
systemctl stop rexec.service
systemctl disable rexec.socket
systemctl disable rexec.service
if grep -q "^rexec" /etc/inetd.conf; then
    sed -i '/^rexec/d' /etc/inetd.conf
fi
if [ -f /etc/xinetd.d/rexec ]; then
    rm -f /etc/xinetd.d/rexec
fi
iptables -A INPUT -p tcp --dport 512 -j DROP
iptables -A INPUT -p udp --dport 512 -j DROP
iptables-save > /etc/iptables/rules.v4
iptables-save > /etc/iptables/rules.v6
echo "Disabling rexec service and blocking port 512 completed."