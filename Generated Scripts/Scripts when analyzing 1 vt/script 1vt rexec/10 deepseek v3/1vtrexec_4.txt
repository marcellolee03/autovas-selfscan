#!/bin/bash
if systemctl is-active --quiet rexec; then
    systemctl stop rexec
    systemctl disable rexec
fi
if grep -q "rexecd" /etc/inetd.conf; then
    sed -i '/rexecd/d' /etc/inetd.conf
    pkill -HUP inetd
fi
if grep -q "rexecd" /etc/xinetd.d/*; then
    sed -i '/rexecd/d' /etc/xinetd.d/*
    systemctl restart xinetd
fi
iptables -A INPUT -p tcp --dport 512 -j DROP
iptables -A INPUT -p udp --dport 512 -j DROP
iptables-save > /etc/iptables/rules.v4
ip6tables -A INPUT -p tcp --dport 512 -j DROP
ip6tables -A INPUT -p udp --dport 512 -j DROP
ip6tables-save > /etc/iptables/rules.v6