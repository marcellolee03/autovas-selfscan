#!/bin/bash
SSHD_CONFIG="/etc/ssh/sshd_config"
BACKUP_SSHD_CONFIG="/etc/ssh/sshd_config.bak"

# Backup the current sshd_config
cp "$SSHD_CONFIG" "$BACKUP_SSHD_CONFIG"

# Remove ssh-dss from the supported host key algorithms
sed -i '/^HostKeyAlgorithms/d' "$SSHD_CONFIG"
echo "HostKeyAlgorithms ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa" >> "$SSHD_CONFIG"

# Restart the SSH service to apply changes
systemctl restart sshd