>analise esse prompt contendo as vulnerabilidades encontradas em um csv do openvas e analise se os scripts que irei enviar em seguida sao capazes de corrigir esses problemas ou nao, me informando uma porcentagem de correcao das vulnerabilidades
>Vulnerabilidades:
    # INSTRUÇÕES PARA O MODELO DE IA

    ## PERSONA
    Você é um especialista em cibersegurança e automação de sistemas, focado em criar scripts de correção (patching). Sua única função é gerar um script que resolva a vulnerabilidade descrita abaixo.

    ## TAREFA
    Analise o contexto da vulnerabilidade a seguir e gere um script de shell (compatível com o sistema operacional do localhost) que, ao ser executado, corrija permanentemente a vulnerabilidade descrita.

    ## CONTEXTO DA VULNERABILIDADE

# Vulnerabilidade 1
CVEs: nan
NVT Name: Weak Host Key Algorithm(s) (SSH)
Port: 22
Port Protocol: tcp
Summary: The remote SSH server is configured to allow / support weak host
  key algorithm(s).
Specific Result: The remote SSH server supports the following weak host key algorithm(s):

host key algorithm | Description
-----------------------------------------------------------------------------------------
ssh-dss            | Digital Signature Algorithm (DSA) / Digital Signature Standard (DSS)

Vulnerability Detection Method: Checks the supported host key algorithms of the remote SSH
  server.

  Currently weak host key algorithms are defined as the following:

  - ssh-dss: Digital Signature Algorithm (DSA) / Digital Signature Standard (DSS)
Details:
Weak Host Key Algorithm(s) (SSH)
(OID: 1.3.6.1.4.1.25623.1.0.117687)
Version used: 2024-06-14T05:05:48Z

Affected Software/OS: nan
Product Detection Result: Product: cpe:/a:ietf:secure_shell_protocol
Method: SSH Protocol Algorithms Supported
(OID: 1.3.6.1.4.1.25623.1.0.105565)

Solution: Disable the reported weak host key algorithm(s).

    ## REGRAS E RESTRIÇÕES DE SAÍDA
    1.  **APENAS SCRIPT:** A sua resposta deve conter ÚNICA E EXCLUSIVAMENTE o código do script.
    2.  **SEM EXPLICAÇÕES:** Não adicione nenhum comentário, explicação, introdução, ou despedida.
    3.  **SEM BLOCOS DE CÓDIGO MARKDOWN:** Não envolva o script em blocos de código como ` ```bash ` ou ` ```sh `. A resposta deve ser o texto puro do script.
    4.  **AUTOSSUFICIENTE:** O script deve ser completo, autônomo e não deve exigir interação do usuário para ser executado.
    5.  **COMPATIBILIDADE:** O script deve ser compatível com o sistema operacional especificado em 'localhost OS'. Se o sistema operacional não for especificado, assuma um sistema baseado em Linux (como Ubuntu/Debian).

    # INÍCIO DO SCRIPT DE CORREÇÃO


>Scripts de correção:
{type: uploaded file
fileName: 1vtweakssh_1.txt
fullContent:
#!/bin/bash
sudo sed -i 's/^HostKeyAlgorithms .*/HostKeyAlgorithms ssh-rsa,ssh-ed25519/' /etc/ssh/sshd_config
sudo systemctl restart sshd}
{type: uploaded file
fileName: 1vtweakssh_2.txt
fullContent:
#!/bin/bash
SSHD_CONFIG="/etc/ssh/sshd_config"

# Backup do arquivo de configuração original
cp $SSHD_CONFIG "${SSHD_CONFIG}.bak"

# Desabilitar o algoritmo DSA
if grep -q "HostKeyAlgorithms" $SSHD_CONFIG; then
    sed -i '/HostKeyAlgorithms/s/ssh-dss//g' $SSHD_CONFIG
else
    echo "HostKeyAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-rsa">> $SSHD_CONFIG
fi

# Reiniciar o serviço SSH para aplicar as mudanças
systemctl restart sshd}
{type: uploaded file
fileName: 1vtweakssh_3.txt
fullContent:
#!/bin/bash
sudo sed -i '/^HostKeyAlgorithms/s/,*ssh-dss,*//g' /etc/ssh/sshd_config
sudo systemctl restart sshd}
{type: uploaded file
fileName: 1vtweakssh_4.txt
fullContent:
#!/bin/bash
sshd_config="/etc/ssh/sshd_config"
backup_file="/etc/ssh/sshd_config.bak"

cp "$sshd_config" "$backup_file"

sed -i '/^HostKeyAlgorithms/d' "$sshd_config"
echo "HostKeyAlgorithms ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa" >> "$sshd_config"

systemctl restart sshd}
{type: uploaded file
fileName: 1vtweakssh_5.txt
fullContent:
#!/bin/bash
SSHD_CONFIG="/etc/ssh/sshd_config"
BACKUP_CONFIG="/etc/ssh/sshd_config.backup"

cp $SSHD_CONFIG $BACKUP_CONFIG

if grep -q "HostKeyAlgorithms" $SSHD_CONFIG; then
    sed -i '/HostKeyAlgorithms/s/ssh-dss//g' $SSHD_CONFIG
    sed -i '/HostKeyAlgorithms/s/,,/,/g' $SSHD_CONFIG
    sed -i '/HostKeyAlgorithms/s/^,*//g' $SSHD_CONFIG
    sed -i '/HostKeyAlgorithms/s/,$//g' $SSHD_CONFIG
else
    echo "HostKeyAlgorithms ssh-rsa,ecdsa-sha2-nistp256,ssh-ed25519" >> $SSHD_CONFIG
fi

systemctl restart sshd}
{type: uploaded file
fileName: 1vtweakssh_6.txt
fullContent:
#!/bin/bash
SSH_CONFIG="/etc/ssh/sshd_config"
BACKUP_CONFIG="$SSH_CONFIG.bak"

# Backup the current SSH configuration
cp "$SSH_CONFIG" "$BACKUP_CONFIG"

# Update the SSH configuration to disable ssh-dss
sed -i '/^HostKeyAlgorithms/d' "$SSH_CONFIG"
sed -i '/^HostKey/s/\s*ssh-dss\s*//g' "$SSH_CONFIG"
echo "HostKeyAlgorithms ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa" >> "$SSH_CONFIG"

# Restart the SSH service
systemctl restart sshd}
{type: uploaded file
fileName: 1vtweakssh_7.txt
fullContent:
#!/bin/bash
SSHD_CONFIG="/etc/ssh/sshd_config"
BACKUP_SSHD_CONFIG="/etc/ssh/sshd_config.bak"

# Backup the current sshd_config
cp "$SSHD_CONFIG" "$BACKUP_SSHD_CONFIG"

# Remove ssh-dss from the supported host key algorithms
sed -i '/^HostKeyAlgorithms/d' "$SSHD_CONFIG"
echo "HostKeyAlgorithms ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa" >> "$SSHD_CONFIG"

# Restart the SSH service to apply changes
systemctl restart sshd}
{type: uploaded file
fileName: 1vtweakssh_8.txt
fullContent:
#!/bin/bash
if [ -f /etc/ssh/sshd_config ]; then
    sed -i '/^HostKeyAlgorithms/d' /etc/ssh/sshd_config
    echo 'HostKeyAlgorithms ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa' >> /etc/ssh/sshd_config
    systemctl restart sshd
fi}
{type: uploaded file
fileName: 1vtweakssh_9.txt
fullContent:
sudo sed -i '/^HostKeyAlgorithms/d' /etc/ssh/sshd_config
echo "HostKeyAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-512,rsa-sha2-256" | sudo tee -a /etc/ssh/sshd_config > /dev/null
sudo systemctl restart sshd}
{type: uploaded file
fileName: 1vtweakssh_10.txt
fullContent:
sudo sed -i '/^HostKeyAlgorithms/s/,*ssh-dss\b//g' /etc/ssh/sshd_config
sudo systemctl restart sshd}
