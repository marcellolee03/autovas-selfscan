#!/bin/bash
SSHD_CONFIG="/etc/ssh/sshd_config"

# Backup do arquivo de configuração original
cp $SSHD_CONFIG "${SSHD_CONFIG}.bak"

# Desabilitar o algoritmo DSA
if grep -q "HostKeyAlgorithms" $SSHD_CONFIG; then
    sed -i '/HostKeyAlgorithms/s/ssh-dss//g' $SSHD_CONFIG
else
    echo "HostKeyAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-rsa">> $SSHD_CONFIG
fi

# Reiniciar o serviço SSH para aplicar as mudanças
systemctl restart sshd